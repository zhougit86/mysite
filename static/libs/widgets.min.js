(function(e){"use strict";var t=e._iu_.fastDom;var i=e.util;var s=e.event;var a=e.dom;var n=e.canvas;var r=e.math;var o=e.util.each;var l=e.dom.get;var h=e.dom.gets;if(e.version){e.version.widgets={"No.":"1.10.20",Date:"2015/10/20"}}e.extend(e.Consts,{STRING_FILTER_CONTAINS:"contains",STRING_FILTER_STARTSWITH:"startswith",STRING_FILTER_ENDSWITH:"endswith",KEYBOARD_SELECTABLE_PRESELECT:"preselect",KEYBOARD_SELECTABLE_SELECT:"select",NOTIFICATION_SUCCESS:"success",NOTIFICATION_INFO:"info",NOTIFICATION_WARNING:"warning",NOTIFICATION_ERROR:"error"});e.i18n.register(e.Consts.I18N_EN_US,{name:"en_US",actions:{ok:"OK",cancel:"Cancel",apply:"Apply",close:"Close",restore:"Restore",minimize:"Minimize",maximize:"Maximize",custom:"Custom"},calendar:{am:"AM",pm:"PM",months:{names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr:["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep"," Oct"," Nov"," Dec"]},weeks:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr:["Su","Mo","Tu","We","Th","Fr","Sa"]},firstDay:0},grid:{column_menu:{sort_asc:"Sort (asc)",sort_desc:"Sort (desc)",columns:"Columns",columns_show_all:"Show All",columns_hide_others:"Hide Others",columns_hide_current:"Hide Current",columns_check_column:"Check",lock:"Lock",unlock:"UnLock"}}});var _={getSibling:function(e,t,i){var s=e.get("parent");if(s){return s.getChildren(i)}else{return t.getRootList(i)}},getVisibleSibling:function(t,i){var s=_.getSibling(t,i,false);var a=new e.List;s.each(function(e){if(i.__isVisible_(e)){a.add(e)}});return a},hasLeafChildren:function(e,t){var i=false;e.hEachDataByRoot(t,function(t){if(e.__isVisible_(t)&&e.isLeaf(t)){i=true;return false}});return i},getLeafChildren:function(t,i){var s=new e.List;t.hEachDataByRoot(i,function(e){if(t.__isVisible_(e)&&t.isLeaf(e)){s.add(e)}});return s}};var d={insertFirst:function(e,t){e.insertBefore(t,e.firstChild)},createAction:function(e,i,n){var r=a.create("a","z-action");var o=a.create("span",l);r.appendChild(o);if(arguments.length>=3){var l="z-icon";if(n){l+=" "+n}t.setClass(o,l)}if(e){s.onclick(r,e,i)}g.addHoverListener(r);return r},releaseContent:function(e){var i=e.element;if(e.display==="none"){t.setCSS(i,"display","none")}if(e.visibility==="hidden"){t.setCSS(i,"visibility","hidden")}if(e.parent){e.parent.appendChild(i)}else{t.remove(i)}},getContentInfo:function(e){var i=d.getContentElement(e);if(i){return{element:i,display:t.getCSS(i,"display"),visibility:t.getCSS(i,"visibility"),parent:i.parentNode}}return null},getContentElement:function(e){if(e){var t,s;if(i.isObject(e)){var n=e.type;s=e.content;if(i.isNonBlankString(n)){t=n.trim().toLowerCase()}}else if(i.isString(e)){s=e}if(n==="element"){return l(s)}else if(i.isNonBlankString(s)){if(t==="url"){return d.createFillIFrame(s)}else{var r=a.create("p","z-window-text");r.innerHTML=s;return r}}}return null},getTreeTempItem:function(){if(d._treeTempItem==null){var e=a.create("li","z-item");var i=a.create("div","z-in");var s=a.create("span","z-expand");t.setCSS(e,"visibility","hidden");e.appendChild(i);i.appendChild(s);d._treeTempItem=e}return d._treeTempItem},scrollTo:function(e,t){e=l(e);if(e){i.callLater(function(){if(e.offsetTop<t.scrollTop){e.scrollIntoView()}else if(e.offsetTop+e.offsetHeight>t.scrollTop+t.clientHeight){t.scrollTop=e.offsetTop+e.offsetHeight+2-t.clientHeight}},100)}},getScrollBarWidth:function(){if(d.__scrollBarWidth!=null){return d.__scrollBarWidth}if(document&&document.body){var e=d.__scrollBarInner;var i=d.__scrollBarOuter;if(e==null){d.__scrollBarInner=document.createElement("p");t.setCSS_Obj(d.__scrollBarInner,{width:"100%",height:"200px"});d.__scrollBarOuter=document.createElement("div");t.setCSS_Obj(d.__scrollBarOuter,{position:"fixed",top:"-200px",left:"-200px",visibility:"hidden",width:"200px",height:"150px"});e=d.__scrollBarInner;i=d.__scrollBarOuter;i.appendChild(e)}t.setCSS(i,"overflow","hidden");document.body.appendChild(i);var s=e.offsetWidth;t.setCSS(i,"overflow","scroll");var a=e.offsetWidth;if(s==a)a=i.clientWidth;document.body.removeChild(i);d.__scrollBarWidth=s-a;return d.__scrollBarWidth}return 0},isIFrame:function(e){if(t.isElement(e)){return t.isElementType(e,"IFRAME")}return false},createFillIFrame:function(e){var i=a.create("iframe");d.fill(i);t.setCSS_Obj(i,{width:"100%",height:"100%",border:"none"});i.setAttribute("frameBorder","0");i.src=e;return i},fill:function(e){t.setCSS_Obj(e,{position:"absolute",left:0,right:0,top:0,bottom:0,width:"auto",height:"auto"})},createSelectOption:function(i,s){if(arguments.length==1){s=i}var a=e.dom.create("option");t.setAttr(a,"value",i);a.innerHTML=s;return a}};var c=a.create("input");if(typeof c.selectionStart=="number"){d.isTextSelected=function(e){e=l(e);if(e){return e.selectionEnd>e.selectionStart}return false}}else{d.isTextSelected=function(e){e=l(e);if(e){e.focus();return document.selection.createRange().text!=""}return false}}c=null;if(e.browser.msie&&e.browser.version<9){d.setSelectionRange=function(e,t,i){e=l(e);if(e){e.focus();e=e.createTextRange();e.collapse(true);e.moveEnd("character",i);e.moveStart("character",t);e.select()}}}else{d.setSelectionRange=function(e,t,i){e=l(e);if(e){e.focus();e.setSelectionRange(t,i)}}}var u={isMenuSpan:function(e){return e.dtype==="menu"},isCheckBoxSpan:function(e){return e.dtype==="check"},isExpandSpan:function(e){return e.dtype==="expand"},isRemoveSpan:function(e){return e.dtype==="remove"}};var f={open:function(e,s){if(s){var a=e.getView();t.setCSS(a,"opacity",0);s.appendChild(a);e.validate();i.callLater(function(){t.setCSS(a,"opacity","")},100)}},_viewBeforeOpen:function(e){if(p.callMethod(e,"beforeOpen")===false){return false}e.__beforeOpen();e.__isOpend=true;return true},_viewOnOpen:function(e){e.__onOpen();p.callMethod(e,"onOpen")},_viewBeforeClose:function(e){if(e.__isOpend!==true){return false}if(p.callMethod(e,"beforeClose")===false){return false}e.__beforeClose();e.__isOpend=false;return true},_viewOnClose:function(e){e.__onClose();p.callMethod(e,"onClose")},setPopupPosition:function(i,s,a){var n=e.coord.getPageOffset(i);var r=i.offsetWidth;var o=i.offsetHeight;var l=s.offsetWidth;var h=s.offsetHeight;var _,d;switch(a){case e.Consts.POPUP_DIRECTION_TOP_LEFT:_=n.x+r-l;d=n.y-h+1;break;case e.Consts.POPUP_DIRECTION_TOP_RIGHT:_=n.x;d=n.y-h+1;break;case e.Consts.POPUP_DIRECTION_BOTTOM_LEFT:_=n.x+r-l;d=n.y+o-1;break;case e.Consts.POPUP_DIRECTION_LEFT_TOP:_=n.x-l+1;d=n.y+o-h;break;case e.Consts.POPUP_DIRECTION_LEFT_BOTTOM:_=n.x-l+1;d=n.y;break;case e.Consts.POPUP_DIRECTION_RIGHT_TOP:_=n.x+r-1;d=n.y+o-h;break;case e.Consts.POPUP_DIRECTION_RIGHT_BOTTOM:_=n.x+r-1;d=n.y;break;default:_=n.x;d=n.y+o-1}t.setCSS_Obj(s,{left:_+"px",top:d+"px"})}};var p={callMethod:function(e,t,i){if(e&&e[t]){return e[t].apply(e,i||[])}return undefined}};var v={setZIndex:function(e,i,s){var a=10200;switch(s){case"window":a=10220;break;case"dropdown":a=10216;break;case"menu":a=10216;break}while(i&&i!=document.body){if(t.hasClass(i,"z-window")){a+=10}i=i.parentNode}t.setCSS(e,"z-index",a)}};var g={onEnter:function(e,t,i){s.on(e,"mouseenter",t,i)},onLeave:function(e,t,i){s.on(e,"mouseleave",t,i)},addHoverListener:function(e){g.onEnter(e,g.__handleMouseEnter);g.onLeave(e,g.__handleMouseLeave)},__handleMouseEnter:function(e){g.addHoverState(s.getTarget(e))},__handleMouseLeave:function(e){g.removeHoverState(s.getTarget(e))},addHoverState:function(e){if(e){t.addClass(e,"z-state-hover")}},removeHoverState:function(e){if(e){t.removeClass(e,"z-state-hover")}},addPreSelectState:function(e){if(e){t.addClass(e,"z-state-preselect")}},removePreSelectState:function(e){if(e){t.removeClass(e,"z-state-preselect")}},addFocusedState:function(e){if(e){t.addClass(e,"z-state-focused")}},removeFocusedState:function(e){if(e){t.removeClass(e,"z-state-focused")}},addSelectedState:function(e){if(e){t.addClass(e,"z-state-selected")}},removeSelectedState:function(e){if(e){t.removeClass(e,"z-state-selected")}},addDisabledState:function(e){if(e){t.addClass(e,"z-state-disabled")}},removeDisabledState:function(e){if(e){t.removeClass(e,"z-state-disabled")}},addCheckedState:function(e){if(e){t.addClass(e,"z-state-checked")}},removeCheckedState:function(e){if(e){t.removeClass(e,"z-state-checked")}}};var C={RESIZE_BORDERS:["z-resize-n","z-resize-w","z-resize-e","z-resize-s","z-resize-sw","z-resize-se","z-resize-nw","z-resize-ne"],addResizeBorder:function(e){var t=C.RESIZE_BORDERS.length;var i=[];for(var s=0;s<t;s++){var n=C.RESIZE_BORDERS[s];var r=a.create("div","z-resize "+n);r.direction=n;i.push(r);e.appendChild(r)}return i},isResizeBorder:function(e){return t.hasClass(e,"z-resize")}};var m={addDropHint:function(e,i){if(e){m._addDropHint(e);if(i){t.setCSS_Obj(m.__dropHint,i)}}else{t.remove(m.__dropHint)}},removeDropHint:function(){t.remove(m.__dropHint)},_addDropHint:function(e){var t=m._getDropHint();if(t.parentNode!==e){e.appendChild(t)}},_getDropHint:function(){if(!m.__dropHint){m.__dropHint=a.create("div","z-drop-hint z-widget-sprite z-ws-drop-hint")}return m.__dropHint}};var w={__getDateKey:function(e){return e.getTime()},__isInRange:function(e,t,i){return!(w.__isBefore(e,t)||w.__isAfter(e,i))},__isBefore:function(e,t){return e.getTime()-t.getTime()<0},__isAfter:function(e,t){return e.getTime()-t.getTime()>0},__isSame:function(e,t,i){var s=w.getDecadeStart(e);var a=w.getDecadeStart(t);var n=w.getYear(e);var r=w.getYear(t);var o=w.getMonth(e);var l=w.getMonth(t);var h=w.getDay(e);var _=w.getDay(t);var d=s===a;var c=n===r;var u=o===l;var f=h===_;switch(i){case"century":return d;case"decade":return d&&c;case"year":return d&&c&&u;case"month":return d&&c&&u&&f}return true},getYear:function(e){return e.getFullYear()},getMonth:function(e,t){if(t===true){return e.getMonth()+1}return e.getMonth()},getDay:function(e){return e.getDate()},getWeekDay:function(e){return e.getDay()},getMonthFirstDay:function(e){return new Date(w.getYear(e),w.getMonth(e),1)},getMonthFirstDayWeek:function(e){return w.getWeekDay(w.getMonthFirstDay(e))},getMonthDays:function(e){return new Date(w.getYear(e),w.getMonth(e,true),0).getDate()},getPrevMonthDays:function(e){return new Date(w.getYear(e),w.getMonth(e),0).getDate()},getNextMonthDays:function(e){return new Date(w.getYear(e),w.getMonth(e)+1,0).getDate()},getDecadeStart:function(e){return((w.getYear(e)-1900)/10|0)*10+1900-1},getCenturyStart:function(e){return((w.getYear(e)-1900)/100|0)*100+1900-10},getPrevMonthDay:function(e){var t=w.getPrevMonthDays(e);var i=Math.min(e.getDate(),t);return new Date(w.getYear(e),w.getMonth(e)-1,i)},getNextMonthDay:function(e){var t=w.getNextMonthDays(e);var i=Math.min(e.getDate(),t);return new Date(w.getYear(e),w.getMonth(e)+1,e.getDate())},getPrevYearDay:function(e){var t=w.getYear(e)-1;var i=w.getMonth(e);var s=new Date(t,i,1);var a=Math.min(w.getMonthDays(s),e.getDate());return new Date(t,i,a)},getNextYearDay:function(e){var t=w.getYear(e)+1;var i=w.getMonth(e);var s=new Date(t,i,1);var a=Math.min(w.getMonthDays(s),e.getDate());return new Date(t,i,a)},getPrevDecadeDay:function(e){var t=w.getYear(e)-10;var i=w.getMonth(e);var s=new Date(t,i,1);var a=Math.min(w.getMonthDays(s),e.getDate());return new Date(t,i,a)},getNextDecadeDay:function(e){var t=w.getYear(e)+10;var i=w.getMonth(e);var s=new Date(t,i,1);var a=Math.min(w.getMonthDays(s),e.getDate());return new Date(t,i,a)},getPrevCenturyDay:function(e){var t=w.getYear(e)-100;var i=w.getMonth(e);var s=new Date(t,i,1);var a=Math.min(w.getMonthDays(s),e.getDate());return new Date(t,i,a)},getNextCenturyDay:function(e){var t=w.getYear(e)+100;var i=w.getMonth(e);var s=new Date(t,i,1);var a=Math.min(w.getMonthDays(s),e.getDate());return new Date(t,i,a)}};var S={getDragDiv:function(){if(!S.__dragDiv){S.__dragDiv=a.create("div","z-drag");S.__dragContentDiv=a.create("div","z-drag-follow-content");S.__dropIcon=a.create("span","z-icon");S.__dragDiv.appendChild(S.__dropIcon);S.__dragDiv.appendChild(S.__dragContentDiv)}return S.__dragDiv},setDragContent:function(e){S.getDragDiv();a.empty(S.__dragContentDiv);if(e){S.__dragContentDiv.appendChild(e)}},setDropIconClass:function(e,i){if(!S.__dragDiv){S.getDragDiv()}if(i===true){t.setClass(S.__dropIcon,e)}else{t.setClass(S.__dropIcon,"z-icon "+e)}},removeDragDiv:function(){t.remove(S.__dragDiv)},setFollowPosition:function(e){var i=S.getDragDiv();if(!i.parentNode){document.body.appendChild(i)}t.setCSS_Obj(i,e)}};var D={__dragList:new e.List,__dropList:new e.List,enableDrag:function(e,t,i){e=l(e);if(e){D.__dragList.add({view:e,handler:t,context:i});if(D.__dragList.size()===1){s.on(window,"mousedown",D.handleWindowMouseDown,D)}}},disableDrag:function(e,t,i){e=l(e);if(e){var a=D.__dragList;var n=a.size();for(var r=0;r<n;r++){var o=a.get(r);if(o.view===e&&o.handler===t&&o.context===i){a.removeAt(r);return}}if(a.size()===0){s.off(window,"mousedown",D.handleWindowMouseDown,D)}}},handleWindowMouseDown:function(t){D.__mousePageOffset=e.coord.getPageOffset(t);D.__dragList.each(function(e){var i=e.view;if(s.isTargetOn(i,t)){var a=e.handler.apply(e.context,[t]);if(a){D.setDrag(a.drag,a.drag_content);if(D.__dragStarted!==true){D.__dragStarted=true;s.on(window,"mousemove",D.handleWindowMouseMove);s.on(window,"mouseup",D.handleWindowMouseUp)}}else{D.setDrag(null)}return false}})},handleWindowMouseUp:function(e){if(D.__dragStarted===true){D.__dragStarted=false;s.off(window,"mousemove",D.handleWindowMouseMove);s.off(window,"mouseup",D.handleWindowMouseUp)}S.removeDragDiv();D.drop()},enableDrop:function(e,t,i){e=l(e);if(e){D.__dropList.add({view:e,handler:t,context:i})}},disableDrop:function(e,t,i){e=l(e);if(e){var s=D.__dropList;var a=s.size();for(var n=0;n<a;n++){var r=s.get(n);if(r.view===e&&r.handler===t&&r.context===i){s.removeAt(n);return}}}},handleWindowMouseMove:function(t){var i=false;D.__dropList.each(function(e){var a=e.view;if(s.isTargetOn(a,t)){i=true;var n=e.handler.apply(e.context,[t,D.__drag]);if(n){D.setDrop(n.drop,n.cls)}else{D.setDrop(null)}return false}});if(i===false){D.setDrop(null)}var a=e.coord.getPageOffset(t);if(Math.abs(D.__mousePageOffset.x-a.x)>1||Math.abs(D.__mousePageOffset.y-a.y)>1){S.setFollowPosition({left:a.x+12+"px",top:a.y+12+"px"})}},setDrag:function(e,t){e=e||null;D.__drag=e;if(e){S.setDragContent(t)}},getDrag:function(){return D.__drag},setDrop:function(e,t){D.__drop=e;if(e==null){S.setDropIconClass("z-widget-sprite z-ws-denied")}else{if(t){S.setDropIconClass(t)}}},getDrop:function(){return D.__drop},drop:function(){if(D.__drop&&D.__drag){var e=D.__drop;if(e.onDrop){e.onDrop.apply(e.drop_context,[D.__drag,D.__drop])}var t=D.__drag;if(t.onDragEnd){t.onDragEnd.apply(t.drag_end_context,[D.__drag,D.__drop])}}D.__drop=null;D.__drag=null}};var b={_initCheck:function(){this._checkList=new e.List;this._checkMap={}},isCheckVisible:function(e){return true},isCheckable:function(e){return true},isChecked:function(e){return this._checkMap[e.id()]===true},getCheckedList:function(e){if(e===false){return this._checkList}return this._checkList.toList()},check:function(e){if(!this.isChecked(e)){this.__check(e)}},__check:function(e){this.__justCheck(e)},__justCheck:function(e){this._checkList.add(e);this._checkMap[e.id()]=true;this.__onCheck(e);this.onCheck(e);this._onCheckChange(e,true);this.onCheckChange(e,true)},unCheck:function(e){if(this.isChecked(e)){this.__unCheck(e)}},__unCheck:function(e){this.__justUnCheck(e)},__justUnCheck:function(e){this._checkList.remove(e);this._checkMap[e.id()]=false;this.__onUnCheck(e);this.onUnCheck(e);this._onCheckChange(e,false);this.onCheckChange(e,false)},checkAll:function(){var e=this.getDataList();e.each(function(e){this.check(e)},this)},clearCheck:function(){if(this._checkList.size()>0){var e=this._checkList.toList();e.each(function(e){this.__unCheck(e)},this);this._checkMap={}}},__justClearCheck:function(){this._checkList.clear();this._checkMap={}},__onCheck:function(e){this.__clearSelect();this.invalidateData(e)},onCheck:function(e){},__onUnCheck:function(e){this.__clearSelect();this.invalidateData(e)},__clearSelect:function(){if(this.get("clear_select_on_check")!==false){if(this.__isSelectChange!==true){this.__isCheckChanging=true;this.clearSelect();this.__isCheckChanging=false}}},onUnCheck:function(e){},onCheckChange:function(e,t){},_onCheckChange:function(e,t){}};var y={__initContentInterface:function(){this._contentMap={}},setCurrentDataContent:function(e){this.__currentDataID=null;if(e){var t=e.id();this.__currentDataID=t;var i=this._contentMap[t];if(!i){var s=e.get("content");i=this.__addContent(s,false);if(i){this._contentMap[t]=i}}this.showContent(i,true)}},removeDataContent:function(e){var t=e.id();if(this.__currentDataID===t){this.__currentDataID=null}var i=this._contentMap[t];if(i){d.releaseContent(i);delete this._contentMap[t]}},clearDataContent:function(){this.__currentDataID=null;o(this._contentMap,function(e,t){d.releaseContent(t)});this._contentMap={}},reloadDataContent:function(e){this.removeDataContent(e);this.setCurrentDataContent(e)},showContent:function(e,t){if(t!==false){this.__hideAllContent(e)}this.__showContent(e)},hideAllContent:function(){this.__hideAllContent()},__hideAllContent:function(e){o(this._contentMap,function(i,s){if(s!==e){var a=s.element;if(d.isIFrame(a)){t.setCSS(a,"visibility","hidden")}else{t.setCSS(a,"display","none")}}})},setCurrentContent:function(e,t){if(t===true&&this.__currentContentInfo){d.releaseContent(this.__currentContentInfo);this.__currentContentInfo=null}var i=this.__addContent(e);this.__currentContentInfo=i;this.__showContent(i);return i},__showContent:function(e){if(e){var i=e.element;if(d.isIFrame(i)){t.setCSS(i,"visibility","visible")}else{t.setCSS(i,"display","block")}if(e.display==="none"){t.setCSS(e.element,"display","block")}if(e.visibility==="hidden"){t.setCSS(e.element,"visibility","visible")}}},__addContent:function(e){var t=d.getContentInfo(e);if(t){var i=this.getContentContainer();if(i){i.appendChild(t.element)}}return t}};var k={__isDraggable:function(e){return this.isDraggable(e)&&this.__isEnabled_(e)},isDraggable:function(e){return true},__isDroppable:function(t,i,s,a,n){if(!this.__isEnabled_(i)){return false}if(t===i||e._iu_.isDescendantOf(i,t)){return false}return this.isDroppable(t,i,s,a,n)},isDroppable:function(e,t,i,s,a){return true},getDragData:function(e){return e},onDragStart:function(e){},onDragEnd:function(e,t,i,s,a){},onDragHover:function(e,t,i,s,a){},onDrop:function(e,t,i,s,a){}};var L={__initExpand:function(){this._expandMap={}},isExpanded:function(e){return this._expandMap[e.id()]===true},expand:function(e,t){if(this.isLeaf(e)){return}if(!this.isExpanded(e)){this.__expand(e)}if(t===true){this.hEachDataByRoot(e,function(e){this.expand(e,true)},this)}},_getExpandMap:function(){return this._expandMap},__expand:function(e){this._expandMap[e.id()]=true;this._onExpand(e);this.onExpand(e)},_onExpand:function(e){this.__invalidateDataAndDescendant(e)},onExpand:function(e){},collapse:function(e,t){if(this.isLeaf(e)){return}if(this.isExpanded(e)){this.__collapse(e)}if(t===true){this.hEachDataByRoot(e,function(e){this.collapse(e,true)},this)}},__collapse:function(e){this._expandMap[e.id()]=false;this._onCollapse(e);this.onCollapse(e)},_onCollapse:function(e){this.__invalidateDataAndDescendant(e)},onCollapse:function(e){},expandAll:function(){var e=this.getDataList(false);e.each(function(e){this.expand(e)},this)},collapseAll:function(){var e=this.getDataList(false);e.each(function(e){this.collapse(e)},this)},toggleExpand:function(e,t){if(this.isLeaf(e)){return}if(this.isExpanded(e)){this.collapse(e,t)}else{this.expand(e,t)}}};var T={__updateParentCheck:function(e,t,i){if(this.isChecked(e)){if(i){if(this.isLeaf(i)){this.__justUnCheck(i);this.__unCheckParent(i)}else if(!this.isChecked(i)){this.__invalidateDataAndAscendant(i)}}if(t){if(!this.isChecked(t)){if(this.__isAllChildrenChecked(t)){this.__justCheck(t);this.__checkParent(t)}else{this.__invalidateDataAndAscendant(i)}}}}else{if(i){if(this.__isAllChildrenChecked(i)){this.__justCheck(i);this.__checkParent(i)}}if(t){if(this.isChecked(t)){this.__justUnCheck(t);this.__unCheckParent(t)}}}},__checkChildren:function(e){this.hEachDataByRoot(e,function(e){if(!this.isChecked(e)){this.__justCheck(e)}},this)},__checkParent:function(e){var t=e.get("parent");while(t){if(this.__isAllChildrenChecked(t)){this.__justCheck(t)}else{this.__invalidateDataAndAscendant(t);return}t=t.get("parent")}},__unCheckChildren:function(e){this.hEachDataByRoot(e,function(e){if(this.isChecked(e)){this.__justUnCheck(e)}},this)},__unCheckParent:function(e){var t=e.get("parent");while(t){if(this.isChecked(t)){this.__justUnCheck(t)}else{this.__invalidateDataAndAscendant(t);return}t=t.get("parent")}},__isAllChildrenChecked:function(e){if(this.isLeaf(e)){return false}var t=e.getChildren(false);var i=t.size();for(var s=0;s<i;s++){var a=t.get(s);if(this.containsData(a)){if(!this.isChecked(a)){return false}}}return true},hasChildrenChecked:function(e){if(this.isLeaf(e)){return false}var t=e.getChildren(false);var i=t.size();for(var s=0;s<i;s++){var a=t.get(s);if(this.containsData(a)){if(this.isChecked(a)||this.hasChildrenChecked(a)){return true}}}return false}};var P={__isHVisible_:function(e){var t=this.__getRootData();if(e==t){return true}var i=e.get("parent");if(t){if(!this.isExpanded(t)||!this.__isVisible_(t)){return false}var s=false;while(i){if(i==t){s=true;break}if(!this.isExpanded(i)||!this.__isVisible_(i)){return false}i=i.get("parent")}if(s===false){return false}}else{while(i){if(!this.isExpanded(i)||!this.__isVisible_(i)){return false}i=i.get("parent")}}return true},isExpanded:function(){return true},getLevel:function(e,t){var i=0;if(t){i=1}var s=e.get("parent");while(s&&s!=t){i++;s=s.get("parent")}if(s!=t){return-1}return i},isLeaf:function(e){if(!e.hasChildren()){return true}var t=e.getChildren(false);var i=t.size();for(var s=0;s<i;s++){var a=t.get(s);if(this.__isLeafVisible(a)){return false}}return true},__isLeafVisible:function(e){if(this.containsData(e)==false){return false}return this.isVisible(e)!==false},__getRootData:function(){if(this.hasProperty("root")){return this.get("root")}return null},__initAllRenderer:function(){this.hEachData(function(e){var t=this.createRenderer(e);if(t){this.__rendererMap[e.id()]=t;this.__addRenderByOrder(e,t)}},this)},_onHDataIndexChange:function(e,t){var i=this.getRenderer(e);if(i){this.__addRenderer(e,i);this.__onDataRenderPositionChange(e)}},_onHDataChange:function(e,t){var i=this.getRenderer(e);if(i){this.__addRenderer(e,i);this.__onDataRenderPositionChange(e)}},_onHDataAdd:function(e){if(e.hasChildren()){this.hEachDataByRoot(e,function(e){var t=this.getRenderer(e);if(t==null){t=this.createRenderer(e);if(t){this.__rendererMap[e.id()]=t}}if(t){this.__addRenderer(e,t)}this.invalidateData(e)},this)}},__addRenderByOrder:function(e,t){this.__grc(e).appendChild(t.getRenderElement())},__addRenderer:function(e,i){var s=e.get("parent");var a=i.getRenderElement();if(s){var n=this.__getAppendedRendererElement(s);if(!n){if(a.parentNode){t.remove(a)}return false}}var r=this.__getLastRenderElement(e,s);this.__insertRenderer(e,i,a,r);return true},__insertRenderer:function(e,t,i,s){var a;if(s){var n=s.nextElementSibling;if(n){a=n}if(a){this.__grc(e).insertBefore(i,a)}else{this.__addRenderByOrder(e,t)}}else{a=this.__grc(e).firstChild;if(a){this.__grc(e).insertBefore(i,a)}else{this.__addRenderByOrder(e,t)}}},__getLastRenderElement:function(t,i){var s;if(i==null){s=this.getRootList(false)}else{s=i.getChildren(false)}var a=new e.List;s.each(function(e){if(e===t){return false}a.add(e)});var n=null;a.each(function(e){var t=this.__getAppendedRendererElement(e);if(t){n=t;return false}},this,true);return n},__getAppendedRendererElement:function(e){var t=this.getRenderer(e);if(t){var i=t.getRenderElement();if(i.parentNode){return i}}return null},__invalidateDataAndDescendant:function(e){this.invalidateData(e);if(e.hasChildren()){var t=e.getChildren(false);t.each(function(e){if(this.containsData(e)){if(this.isExpanded(e)){this.__invalidateDataAndDescendant(e)}else{this.invalidateData(e)}}},this)}},__invalidateDataAndAscendant:function(e){this.invalidateData(e);var t=e.get("parent");if(t){var i=this.__getRootData();while(t){this.invalidateData(t);if(t==i){break}t=t.get("parent")}}}};var x={__initHover:function(){this._hoverData=null},__removeHover:function(e,t){if(e===this._hoverData){this.__setHoverData(null,t)}},__clearHover:function(e){this.__setHoverData(null,e)},setHoverData:function(e){this.__setHoverData(e,true)},__setHoverData:function(e,t){if(this._hoverData!==e){var i=t!==false;if(i&&this._hoverData){this.__onHover(this._hoverData,false);this.onHover(this._hoverData,false)}this._hoverData=e;if(i&&this._hoverData){this.__onHover(this._hoverData,true);this.onHover(this._hoverData,true)}}},__onHover:function(e,t){this.invalidateData(e)},onHover:function(e,t){},isHover:function(e){if(e){return this._hoverData===e}return false},getHoverData:function(){return this._hoverData}};var V={__initPopup:function(){this.__open=false;this.__isFirstOpen=true},isOpen:function(){return this.__open===true},__updateOpenConfig:function(e){},__open_:function(e){this.__open=true;this.__isFirstOpen=false},__close_:function(e){this.__open=false},__beforeOpen:function(){},beforeOpen:function(){},__onOpen:function(){},onOpen:function(){},__beforeClose:function(){},beforeClose:function(){},__onClose:function(){},onClose:function(){}};var z={__initPreSelect:function(){this._preSelectData=null},__removePreSelect:function(e,t){if(this._preSelectData===e){this.__setPreSelectData(null,t)}},__clearPreSelect:function(e){this.__setPreSelectData(null,e)},setPreSelectData:function(e){this.__setPreSelectData(e,true)},__setPreSelectData:function(e,t){if(this._preSelectData!==e){var i=t!==false;if(i&&this._preSelectData){this.__onPreSelect(this._preSelectData,false);this.onPreSelect(this._preSelectData,false)}this._preSelectData=e;if(i&&this._preSelectData){this.__onPreSelect(this._preSelectData,true);this.onPreSelect(this._preSelectData,true)}}},__onPreSelect:function(e,t){this.invalidateData(e)},onPreSelect:function(e,t){},isPreSelect:function(e){if(e){return this._preSelectData===e}return false},getPreSelectData:function(){return this._preSelectData}};var O=function(){O.superClass.constructor.apply(this,arguments)};e.extend(O,e.ElementRenderer,{validateDataProperty:function(e,t){this._oldDataSelected=this.dataSelected;this._oldDataHover=this.dataHover;this._oldDataPreSelect=this.dataPreSelect;this._oldDataDisabled=this.dataDisabled;O.superClass.validateDataProperty.apply(this,arguments);this.dataHover=e.isHover(t);this.dataPreSelect=e.isPreSelect(t);this.dataDisabled=e.isDisabled(t)===true},validateRenderer:function(){O.superClass.validateRenderer.apply(this,arguments);this._updateState(this.renderer)},_updateState:function(e){if(this._oldDataDisabled!==this.dataDisabled){if(this.dataDisabled){g.addDisabledState(e)}else{g.removeDisabledState(e)}}if(this._oldDataSelected!==this.dataSelected){if(this.dataSelected){g.addSelectedState(e)}else{g.removeSelectedState(e)}}if(this.dataDisabled){if(this._oldDataHover){g.removeHoverState(e)}if(this._oldDataPreSelect){g.removePreSelectState(e)}return}if(this._oldDataHover!==this.dataHover){if(this.dataHover){g.addHoverState(e)}else{g.removeHoverState(e)}}if(this._oldDataPreSelect!==this.dataPreSelect){if(this.dataPreSelect){g.addPreSelectState(e)}else{g.removePreSelectState(e)}}}});var E=function(){E.superClass.constructor.apply(this,arguments)};e.extend(E,e.IViewInteractor,{update:function(){E.superClass.update.apply(this,arguments);this.__updateHover();this.__updateKeyboardSelect()},__updateHover:function(){var e=this.view.get("hoverable");if(e===true){if(this.__hoverable!==true){this.__hoverable=true;this.addViewListener("mouseover");this.addViewListener("mouseleave")}}else{if(this.__hoverable===true){this.__hoverable=false;this.removeViewListener("mouseover");this.removeViewListener("mouseleave")}}},handle_mouseover:function(e){var t=this.view.getDataAt(e);if(this._isDataEnabled(t)){this.view.setHoverData(t)}else{this.view.setHoverData(null)}},handle_mouseleave:function(){this.view.setHoverData(null)},__updateKeyboardSelect:function(){this.__viewKeyboardSelectable=this.view.get("keyboard_selectable");if(this.__viewKeyboardSelectable===e.Consts.KEYBOARD_SELECTABLE_PRESELECT||this.__viewKeyboardSelectable===e.Consts.KEYBOARD_SELECTABLE_SELECT||this.__viewKeyboardSelectable===true){if(this.__keyboard_selectable!==true){this.__keyboard_selectable=true;this.addViewListener("keydown")}}else{if(this.__keyboard_selectable===true){this.__keyboard_selectable=false;this.removeViewListener("keydown")}}},handle_keydown:function(t){if(this.__keyboard_selectable!==true){return}var i=t.keyCode;if(i!==13&&i!==40&&i!==38){return}var s,a;if(i===13){var n=this.view.getPreSelectData();if(n){this.view.setSelect(n)}return}if(i===40){s=this._getCurrentData();if(s){a=this.getNextSelectableData(s)}else{a=this._getFirstData()}}else if(i===38){s=this._getCurrentData();if(s){a=this.getPrevSelectableData(s)}else{a=this._getFirstData()}}if(a){if(this.__viewKeyboardSelectable===e.Consts.KEYBOARD_SELECTABLE_SELECT){this.view.setSelect(a)}else{this.view.setPreSelectData(a)}var r=this.view.getRenderElement(a);d.scrollTo(r,this.view.getView());t.preventDefault()}},getNextSelectableData:function(e){var t=this.view;var i=t.getRenderElement(e);if(i){var s=i.nextSibling;while(s){var a=t.getDataAt(s);if(a==null){return null}if(t.__isEnabled_(a)&&t.__isSelectable_(a)){return a}s=s.nextSibling}}return null},getPrevSelectableData:function(e){var t=this.view;var i=t.getRenderElement(e);if(i){var s=i.previousSibling;while(s){var a=t.getDataAt(s);if(a==null){return null}if(t.__isEnabled_(a)&&t.__isSelectable_(a)){return a}s=s.previousSibling}}return null},_getCurrentData:function(){return this.view.getPreSelectData()||this.view.getLastSelect()},_getFirstData:function(){var e=l(".z-item:first-child",this.view.viewUL);if(e){return this.view.getDataAt(e)}return null}});var I=function(){I.superClass.constructor.apply(this,arguments)};e.extend(I,E,{getViewEventTypes:function(){return["click","dblclick"]},_toggleCheck:function(e){var t=this.view;if(t.isCheckable(e)){if(t.isChecked(e)){t.unCheck(e)}else{t.check(e)}}},handle_click:function(e){var t=s.getTarget(e);var i=this.view;if(this.__keyboard_selectable===true){this.view.getView().focus()}var a=i.getDataAt(t);if(!this._isDataEnabled(a)){return}if(u.isRemoveSpan(t)){if(i.beforeRemove(a)!==false){i.removeData(a)}}else if(u.isCheckBoxSpan(t)){this._toggleCheck(a)}else{var n=i.__isCheckVisible_(a);if(n&&i.get("change_check_on_click")===true){this._toggleCheck(a)}else{if(i.__isSelectable_(a)){this.__handleSelect(a,e.ctrlKey)}}}i.__onDataClick(a,e)},__handleSelect:function(t,i){var s=this.view;var a=s.get("selectable");var n=s.get("change_select_on_click")===true;var r=s.isSelected(t);if(a===e.Consts.SELECTABLE_SINGLE){if(!r){s.setSelect(t)}else if(i||n){s.removeSelect(t)}}else if(a===e.Consts.SELECTABLE_MULTIPLE){if(i||n){if(r){s.removeSelect(t)}else{s.addSelect(t)}}else{if(!r){s.setSelect(t)}}}},handle_dblclick:function(e){var t=this.view.getDataAt(e);if(!this._isDataEnabled(t)){return}this.view.__onDataDblClick(t,e)}});var M=function(){this._table=a.create("table");this._tableColGroup=a.create("colgroup");M.superClass.constructor.apply(this,arguments);this._table.appendChild(this._tableColGroup);this.addToView(this._table);t.setAttr(this._table,"border","1");this.__addViewClass("z-widget")};e.extend(M,e.ElementRendererView,{});var R=function(){this.renderer=a.create("tr");R.superClass.constructor.apply(this,arguments);this.__addRenderClass("z-item")};e.extend(R,O,{});var B=function(){this.__initHover();this.__initPreSelect();this.viewUL=a.create("ul");B.superClass.constructor.apply(this,arguments);this.addToView(this.viewUL);this.__addViewClass("z-widget");t.setAttr(this.view,"tabindex","0");if(this.get("user_select")!==true){this.__addViewClass("z-user-select-none");

}};e.extend(B,e.ElementRendererView,{___zdefaults_:{selectable:e.Consts.SELECTABLE_SINGLE,user_select:true,hoverable:true},afterSetProperty:function(e,t,i){B.superClass.afterSetProperty.apply(this,arguments);if("user_select"===e){if(t===true){this.__addViewClass("z-user-select-none")}else{this.__removeViewClass("z-user-select-none")}}},getRendererRootContainer:function(){return this.viewUL},getRendererContainer:function(e){return this.viewUL},_onDataRemove:function(e){B.superClass._onDataRemove.apply(this,arguments);this.__removeHover(e,false);this.__removePreSelect(e,false)},_onDataClear:function(){B.superClass._onDataClear.apply(this,arguments);this.__clearHover(false);this.__clearPreSelect(false)},_onSetProvider:function(){B.superClass._onSetProvider.apply(this,arguments);this.__clearHover(false);this.__clearPreSelect(false)},_onBatchSelectChange:function(){var e=B.superClass._onBatchSelectChange;if(e){e.apply(this,arguments)}this.setPreSelectData(null)}});i.extendClassPrototype(B,x);i.extendClassPrototype(B,z);var A=function(){this.renderer=a.create("li");A.superClass.constructor.apply(this,arguments);this.__addRenderClass("z-item")};e.extend(A,O,{});var H=function(){H.superClass.constructor.apply(this,arguments)};e.extend(H,e.IViewInteractor,{getViewEventTypes:function(){return["mousedown","dblclick"]},handle_mousedown:function(e){s.stop(e);var t=this.view;if(t.get("state")!=="maximized"){g.addFocusedState(t.view)}var i=s.getTarget(e);if(C.isResizeBorder(i)){this._startWindowResize(e)}else{this._startWindowDrag(e)}},_startWindowResize:function(i){this.__dragging=false;if(this.__resizing!==true){this.__resizing=true;var a=this.view;var n=s.getTarget(i);this.mousePageOffset=e.coord.getPageOffset(i);this._mouseMovePageOffset=e.coord.getPageOffset(i);this.__viewLeft=parseFloat(a.__getViewCSS("left"))||0;this.__viewTop=parseFloat(a.__getViewCSS("top"))||0;this.__viewWidth=parseFloat(a.__getViewCSS("width"));this.__viewHeight=parseFloat(a.__getViewCSS("height"));this.__viewMinWidth=parseFloat(a.__getViewCSS("min-width"));this.__viewMinHeight=parseFloat(a.__getViewCSS("min-height"));this.__resizeDirection=n.direction;t.setCSS(document.body,"cursor",t.getCSS(n,"cursor"));a.__setViewCSS("pointer-events","none");this.addWindowListener("mousemove");this.addWindowListener("mouseup");a.__addViewClass("z-user-select-none")}},_startWindowDrag:function(t){this.__resizing=false;if(this.__dragging!==true){var i=this.view;if(this.__isOnTitleBarWithoutAction(t)){this.__dragging=true;this.mousePageOffset=e.coord.getPageOffset(t);this._mouseMovePageOffset=e.coord.getPageOffset(t);this.__viewLeft=parseFloat(i.__getViewCSS("left"))||0;this.__viewTop=parseFloat(i.__getViewCSS("top"))||0;this.addWindowListener("mousemove");this.addWindowListener("mouseup");i.__addViewClass("z-user-select-none")}}},handle_window_mousemove:function(e){if(this.__dragging){this._draggingWindow(e)}else{this._resizingWindow(e)}},_draggingWindow:function(t){var i=e.coord.getPageOffset(t);if(Math.abs(this._mouseMovePageOffset.x-i.x)>1||Math.abs(this._mouseMovePageOffset.y-i.y)>1){var s=this.view;var a=s.view;var n=s.get("state");var r;if(n==="maximized"){var o=a.offsetWidth;r=this.mousePageOffset.x-e.coord.getPageOffset(a).x;var l=r/o;s.restore();o=a.offsetWidth;r=o*l;this.__viewLeft=this.mousePageOffset.x-r;s.__setViewCSS_Obj({left:this.__viewLeft+"px",top:this.__viewTop+"px"});return}this._mouseMovePageOffset=i;r=i.x-this.mousePageOffset.x;var h=i.y-this.mousePageOffset.y;var _=Math.max(0,this.__viewLeft+r);var d=Math.max(0,this.__viewTop+h);s.__setViewCSS_Obj({left:_+"px",top:d+"px"})}},_resizingWindow:function(t){var i=e.coord.getPageOffset(t);if(Math.abs(this._mouseMovePageOffset.x-i.x)>1||Math.abs(this._mouseMovePageOffset.y-i.y)>1){var s=this.view;this._mouseMovePageOffset=i;var a=i.x-this.mousePageOffset.x;var n=i.y-this.mousePageOffset.y;var r={};switch(this.__resizeDirection){case"z-resize-n":if(this.__viewHeight-n>this.__viewMinHeight){r.top=this.__viewTop+n;r.height=this.__viewHeight-n}break;case"z-resize-s":r.height=this.__viewHeight+n;break;case"z-resize-e":r.width=this.__viewWidth+a;break;case"z-resize-w":if(this.__viewWidth-a>this.__viewMinWidth){r.left=this.__viewLeft+a;r.width=this.__viewWidth-a}break;case"z-resize-ne":if(this.__viewHeight-n>this.__viewMinHeight){r.top=this.__viewTop+n;r.height=this.__viewHeight-n}r.width=this.__viewWidth+a;break;case"z-resize-se":r.height=this.__viewHeight+n;r.width=this.__viewWidth+a;break;case"z-resize-sw":if(this.__viewWidth-a>this.__viewMinWidth){r.left=this.__viewLeft+a;r.width=this.__viewWidth-a}r.height=this.__viewHeight+n;break;case"z-resize-nw":if(this.__viewHeight-n>this.__viewMinHeight){r.top=this.__viewTop+n;r.height=this.__viewHeight-n}if(this.__viewWidth-a>this.__viewMinWidth){r.left=this.__viewLeft+a;r.width=this.__viewWidth-a}break}var l={};o(r,function(e,t){l[e]=t+"px"});s.__setViewCSS_Obj(l)}},handle_window_mouseup:function(e){if(this.__dragging===true){this.view.__removeViewClass("z-user-select-none");this.removeWindowListener("mouseup");this.removeWindowListener("mousemove")}else if(this.__resizing===true){this.view.__removeViewClass("z-user-select-none");this.view.__setViewCSS("pointer-events","");t.setCSS(document.body,"cursor","");this.removeWindowListener("mouseup");this.removeWindowListener("mousemove")}this.__dragging=false;this.__resizing=false},handle_dblclick:function(e){var t=this.view;if(this.__isOnTitleBarWithoutAction(e)){var i=t.get("state");if(t.get("resizable")!==false){if(i!=="minimized"){if(i==="maximized"){t.restore()}else{t.maximize()}}}else{if(t.__maximizeAction&&t.__maximizeAction.parentNode){t.maximize();return}if(t.__restoreAction&&t.__restoreAction.parentNode&&i==="maximized"){t.restore();return}}}},handle_window_mousedown:function(e){if(this.view.view.parentNode){if(s.getTarget(e)===this.view.__modalDiv){var t=0;i.callInterval(function(){if(t%2==0){g.addFocusedState(this.view.view)}else{g.removeFocusedState(this.view.view)}t++;if(t>=5){return false}},60,this);return}g.removeFocusedState(this.view.view)}},update:function(){H.superClass.update.apply(this,arguments);var e=this.view.get("close_on_click")===true;if(this.__close_on_click!==e){this.__close_on_click=e;if(this.__close_on_click){this.addViewListener("click")}else{this.removeViewListener("click")}}if(this.view.isOpen()){if(this.__hasWindowMouseDownEvent!==true){this.__hasWindowMouseDownEvent=true;i.callLater(function(){this.addWindowListener("mousedown")},100,this)}if(this.__hasToolbarKeyEvent!==true){var n=this.view.getToolBar();if(t.getCSS(n,"display")!=="none"){this.__hasToolbarKeyEvent=true;var r=a.children(n,"a");o(r,function(e){s.on(e,"keydown",this.__handleActionKeyDown,this)},this)}}}else{if(this.__hasWindowMouseDownEvent===true){this.removeWindowListener("mousedown");this.__hasWindowMouseDownEvent=false}if(this.__hasToolbarKeyEvent===true){var n=this.view.getToolBar();if(t.getCSS(n,"display")!=="none"){var r=a.children(n,"a");o(r,function(e){s.off(e,"keydown",this.__handleActionKeyDown,this)},this);this.__hasToolbarKeyEvent=false}}}},__handleActionKeyDown:function(e){var t=e.keyCode;var i=s.getTarget(e);switch(t){case 39:var n=a.next(i,"a",true);if(n){a.focus(n)}break;case 37:var r=a.prev(i,"a",true);if(r){a.focus(r)}break;case 13:this.view.__onEnter(i);break;case 32:this.view.__onEnter(i);break;case 27:this.view._handleCancel();break}},handle_click:function(e){if(this.__close_on_click===true){this.view.close()}},__isOnTitleBarWithoutAction:function(e){var t=s.getTarget(e);return!this.__isAction(t)&&s.isTargetOn(this.view.getTitleBar(),e)},__isAction:function(e){if(e){var i=t.hasClass(e,"z-action");if(i){return i}if(e.parentNode){return t.hasClass(e.parentNode,"z-action")}}return false}});var N=function(){N.superClass.constructor.apply(this,arguments)};e.extend(N,e.IView,{});i.extendClassPrototype(N,y);e.Window=function(){this.__dialogCreateElements_();e.Window.superClass.constructor.apply(this,arguments);this.__addViewClass("z-widget");this.__dialogInit_();this.setInteractors(new H(this))};e.extend(e.Window,N,{___zsg:["content"],___zdefaults_:{titlebar_visible:true,toolbar_visible:false,close_on_click:false,resizable:false},__dialogCreateElements_:function(){this._titleBar=a.create("div","z-titlebar z-user-select-none");this._titleDiv=a.create("div","z-title");a.value(this._titleDiv,"&nbsp;");this._actionsDiv=a.create("span","z-window-actions");this._contentView=a.create("div","z-content");this._toolBar=a.create("div","z-toolbar")},__dialogInit_:function(){this._titleBar.appendChild(this._titleDiv);this._titleBar.appendChild(this._actionsDiv);if(this.get("titlebar_visible")!==false){this.addToView(this._titleBar)}this.addToView(this._contentView);if(this.get("toolbar_visible")===true){this.addToView(this._toolBar)}this.__addViewClasses("z-widget z-window z-size-default");this.updateResizable()},afterSetProperty:function(t,i,s){e.Window.superClass.afterSetProperty.apply(this,arguments);if(t==="state"){this.updateState()}else if(t==="title"){a.value(this._titleDiv,i||"&nbsp;")}else if(t==="content"){if(this.isOpen()){this.setCurrentContent(i,true)}}else if(t==="css"){this.__setViewCSS_Obj(i)}else if(t==="actions"){this.updateActions()}else if(t==="resizable"){this.updateResizable()}else if(t==="size"){this.updateSize()}else if(t==="titlebar_visible"){this._setTitlebarVisible(i)}else if(t==="toolbar_visible"){this._setToolbarVisible(i)}else if(t==="toolbar_actions"){this.updateToolbarActions()}else if(t==="close_on_click"){this.updateInteractors()}},_setTitlebarVisible:function(e){if(e===false){t.remove(this._titleBar);t.setCSS(this.view,"padding-top","0px")}else{if(this.view){this.view.insertBefore(this._titleBar,this._contentView)}i.callLater(function(){var e=this._titleBar.offsetHeight;t.setCSS(this._titleBar,"margin-top",-e-1+"px");t.setCSS(this.view,"padding-top",e+"px")},20,this)}},_setToolbarVisible:function(e){if(e!==true){t.remove(this._toolBar);t.setCSS(this.view,"padding-bottom","0px")}else{if(this.view){this.addToView(this._toolBar)}i.callLater(function(){var e=this._toolBar.offsetHeight;t.setCSS(this.view,"padding-bottom",e-1+"px")},20,this)}},__releaseContentOnClose:function(){if(this.__currentContentInfo&&this.__currentContentInfo.parent){d.releaseContent(this.__currentContentInfo);this.set("content",null)}},getContentContainer:function(){return this._contentView},__removeHoverAction:function(){var e=a.children(this._actionsDiv);o(e,function(e){g.removeHoverState(e)})},updateActions:function(){var e=this.get("actions");this.__removeHoverAction();a.empty(this._actionsDiv);var t=(this.get("state")||"").trim().toLocaleLowerCase();if(e&&e.length>0){o(e,function(e){if(e){var i=e.trim().toLowerCase();switch(i){case"close":this._actionsDiv.appendChild(this._getCloseAction());break;case"maximize":if(t==="maximized"){this._actionsDiv.appendChild(this._getRestoreAction())}else{if(t!=="minimized"){this._actionsDiv.appendChild(this._getMaximizeAction())}}break;case"minimize":if(t==="minimized"){this._actionsDiv.appendChild(this._getRestoreAction())}else{if(t!=="maximized"){this._actionsDiv.appendChild(this._getMinimizeAction())}}break;case"custom":this._actionsDiv.appendChild(this._getCustomAction());break}}},this)}},_getCloseAction:function(){if(!this.__closeAction){this.__closeAction=d.createAction(this._handleClose,this,"z-widget-sprite z-ws-close");var i=e.i18n.getLabel("actions.close");if(i){t.setAttr(this.__closeAction,"title",i)}}return this.__closeAction},_handleClose:function(){this.close()},_getCustomAction:function(){if(!this.__customAction){this.__customAction=d.createAction(this._handleCustom,this,"z-widget-sprite z-ws-custom");var i=e.i18n.getLabel("actions.custom");if(i){t.setAttr(this.__customAction,"title",i)}}return this.__customAction},_handleCustom:function(){p.callMethod(this,"onCustom")},onCustom:function(){},_getMaximizeAction:function(){if(!this.__maximizeAction){this.__maximizeAction=d.createAction(this._handleMaximize,this,"z-widget-sprite z-ws-maximize");var i=e.i18n.getLabel("actions.maximize");if(i){t.setAttr(this.__maximizeAction,"title",i)}}return this.__maximizeAction},_handleMaximize:function(){if(p.callMethod(this,"onMaximize")===false){return}this.maximize()},onMaximize:function(){},_getMinimizeAction:function(){if(!this.__minimizeAction){this.__minimizeAction=d.createAction(this._handleMinimize,this,"z-widget-sprite z-ws-minimize");var i=e.i18n.getLabel("actions.minimize");if(i){t.setAttr(this.__minimizeAction,"title",i)}}return this.__minimizeAction},_handleMinimize:function(){if(p.callMethod(this,"onMinimize")===false){return}this.minimize()},onMinimize:function(){},_getRestoreAction:function(){if(!this.__restoreAction){this.__restoreAction=d.createAction(this._handleRestore,this,"z-widget-sprite z-ws-restore");var i=e.i18n.getLabel("actions.restore");if(i){t.setAttr(this.__restoreAction,"title",i)}}return this.__restoreAction},_handleRestore:function(){if(p.callMethod(this,"onRestore")===false){return}this.restore()},onRestore:function(){},__removeHoverToolbarAction:function(){var e=a.children(this._toolBar);o(e,function(e){g.removeHoverState(e)})},updateToolbarActions:function(){var e=this.get("toolbar_actions");this.__removeHoverToolbarAction();a.empty(this._toolBar);if(e&&e.length>0){o(e,function(e){if(e){if(i.isString(e)){var t=e.trim().toLowerCase();switch(t){case"ok":this._toolBar.appendChild(this.getOKAction());break;case"cancel":this._toolBar.appendChild(this.getCancelAction());break;case"apply":this._toolBar.appendChild(this.getApplyAction());break}}}},this)}},getOKAction:function(){if(!this.__okAction){this.__okAction=d.createAction(this._handleOK,this);this.__setToolbarActionLabel(this.__okAction,"ok")}return this.__okAction},__onEnter:function(e){if(e){switch(e){case this.__okAction:this._handleOK();break;case this.__cancelAction:this._handleCancel();break;case this.__applyAction:this._handleApply();break;default:this.onEnter(e)}}},onEnter:function(e){},_handleOK:function(){if(p.callMethod(this,"onOK")===false){return}this.close()},onOK:function(){},getCancelAction:function(){if(!this.__cancelAction){this.__cancelAction=d.createAction(this._handleCancel,this);this.__setToolbarActionLabel(this.__cancelAction,"cancel")}return this.__cancelAction},_handleCancel:function(){if(p.callMethod(this,"onCancel")===false){return}this.close()},onCancel:function(){},getApplyAction:function(){if(!this.__applyAction){this.__applyAction=d.createAction(this._handleApply,this);this.__setToolbarActionLabel(this.__applyAction,"apply")}return this.__applyAction},_handleApply:function(){p.callMethod(this,"onApply")},onApply:function(){},__setToolbarActionLabel:function(i,s){var a=i.firstChild;t.setAttr(i,"tabindex","0");var n=e.i18n.getLabel("actions."+s);if(n){t.setValue(a,n)}},updateState:function(){var e=(this.get("state")||"").trim().toLocaleLowerCase();var i=this.view.style;if(e==="maximized"){this.__addViewClass("z-window-maximized");t.setCSS(this._contentView,"display","");if(this.__isFirst===false){this.___restoreStatus={left:i["left"],top:i["top"],width:i["width"],height:i["height"]}}this.hideResizeBorders();d.fill(this.view);g.removeFocusedState(this.view)}else if(e==="minimized"){t.setCSS(this._contentView,"display","none");if(this.__isFirst===false){this.___restoreStatus={height:i["height"],"min-height":t.getCSS(this.view,"min-height")}}this.__setViewCSS("height","0");this.__setViewCSS("min-height","0");this.hideResizeBorders();t.removeClass(this.view,"z-window-maximized")}else{if(this.___restoreStatus){this.__setViewCSS_Obj(this.___restoreStatus);this.___restoreStatus=null}else{this.__setViewCSS_Obj({width:"",height:""});this.center()}t.removeClass(this.view,"z-window-maximized");t.setCSS(this._contentView,"display","");this.showResizeBorders();g.addFocusedState(this.view)}this.updateActions()},hideResizeBorders:function(){if(this.__resizeBorders){o(this.__resizeBorders,function(e){t.setCSS(e,"display","none")})}},showResizeBorders:function(){if(this.__resizeBorders){o(this.__resizeBorders,function(e){t.setCSS(e,"display","")})}},updateResizable:function(){var e=this.get("resizable")!==false;if(e){if(!this.__resizeBorders){this.__resizeBorders=C.addResizeBorder(this.view)}}else{if(this.__resizeBorders){o(this.__resizeBorders,function(e){if(e.parentNode){e.parentNode.removeChild(e)}})}this.__resizeBorders=null}},updateSize:function(){var e=(this.get("size")||"").trim().toLocaleLowerCase();this.__removeViewClasses("z-size-default z-size-large z-size-small");this.__resetWH();if(e==="large"){this.__addViewClass("z-size-large")}else if(e==="small"){this.__addViewClass("z-size-small")}else{this.__addViewClass("z-size-default")}},__resetWH:function(){this.__setViewCSS_Obj({width:"",height:""})},getModalDiv:function(){if(!this.__modalDiv){this.__modalDiv=a.create("div","z-window-modal")}t.setCSS(this.__modalDiv,"position","");return this.__modalDiv},isOpen:function(){return this.__isOpend===true},__updateOpenedConfig:function(e){if(e==null){return}var i=e||{};var s=false;var a=false;if(i.hasOwnProperty("modal")){s=i.modal===true;a=true}if(i.hasOwnProperty("appendTo")){var n=l(i.appendTo||document.body);if(this.view.parentNode!==n){n.appendChild(this.view)}if(!s){if(this.__modalDiv&&this.__modalDiv.parentNode){this.view.parentNode.insertBefore(this.__modalDiv,this.view)}}}if(a){if(s){this.view.parentNode.insertBefore(this.getModalDiv(),this.view)}else{t.remove(this.__modalDiv)}}if(i.hasOwnProperty("zIndexElement")){var r=l(i.zIndexElement||document.body);v.setZIndex(this.view,r,"window")}if(i.hasOwnProperty("center")){var o=i.center!==false;if(o&&!this.isMaximized()){this.center()}}this.validate();this.__focusToolbarButton()},isMaximized:function(){return this.get("state")==="maximized"},__focusToolbarButton:function(){var e=this.get("toolbar_visible")===true;if(e&&this._toolBar.firstChild){a.focus(this._toolBar.firstChild)}},open:function(e){if(this.isOpen()){this.__updateOpenedConfig(e);return}var s=e||{};var a=l(s.appendTo)||document.body;if(a==null){return}if(f._viewBeforeOpen(this)===false){return}var n=this.__isFirst!==false;this.__isFirst=false;v.setZIndex(this.view,l(s.zIndexElement)||document.body,"window");if(!n){this.__removeHoverAction();this.__removeHoverToolbarAction()}t.setCSS(this.view,"opacity",0);var r;if(this.isMaximized()){r=false}else{if(n){r=s.center!==false}else{r=s.center===true}g.addFocusedState(this.view)}var o=s.modal===true;if(o){a.appendChild(this.getModalDiv());if(a===document.body){t.setCSS(this.getModalDiv(),"position","fixed")}}a.appendChild(this.view);this.validate();this.setCurrentContent(this.get("content"),true);var h=this.get("toolbar_visible")===true;i.callLater(function(){if(r){this.center()}if(n){if(this.get("titlebar_visible")!==false){var e=this._titleBar.offsetHeight;t.setCSS(this._titleBar,"margin-top",-e-1+"px");t.setCSS(this.view,"padding-top",e+"px")}if(h){t.setCSS(this._toolBar,"display","");var i=this._toolBar.offsetHeight;t.setCSS(this.view,"padding-bottom",i-1+"px")}}this.__setViewCSS("opacity","");f._viewOnOpen(this);this.updateInteractors();this.__focusToolbarButton()},60,this)},close:function(){if(f._viewBeforeClose(this)===false){return}t.remove(this.view);t.remove(this.__modalDiv);this.__releaseContentOnClose();f._viewOnClose(this);this.updateInteractors()},__beforeOpen:function(){},__onOpen:function(){},__beforeClose:function(){},__onClose:function(){this.__onCloseUtil_()},__onCloseUtil_:function(){},center:function(){var e=this.view.parentNode;if(e){var t=e.clientWidth;var i=e.clientHeight;var s=this.view.offsetWidth;var a=this.view.offsetHeight;this.__setViewCSS_Obj({left:Math.max((t-s)/2,0)+"px",top:Math.max((i-a)/2,0)+"px",right:"",bottom:""})}},minimize:function(){this.set("state","minimized")},maximize:function(){this.set("state","maximized")},restore:function(){this.set("state","")},getActionToolBar:function(){return this._actionsDiv},getTitleBar:function(){return this._titleBar},getToolBar:function(){return this._toolBar}});e.LoadingWindow=function(){e.LoadingWindow.superClass.constructor.apply(this,arguments);this.__addViewClass("z-loading-window")};e.extend(e.LoadingWindow,e.Window,{___zdefaults_:{titlebar_visible:false},__dialogCreateElements_:function(){var i=a.create("div");var s=a.create("div");t.setCSS_Obj(i,{overflow:"hidden",display:"table","margin-left":"auto","margin-right":"auto",padding:"0px",height:"100%"});t.setCSS_Obj(s,{display:"table-cell","vertical-align":"middle",background:"transparent"});var n=a.create("div");t.setCSS_Obj(n,{padding:"6px"});var r=a.create("div","z-loading");this.loadingLabelDiv=a.create("div","z-loading-label");i.appendChild(s);s.appendChild(n);n.appendChild(r);n.appendChild(this.loadingLabelDiv);e.LoadingWindow.superClass.__dialogCreateElements_.apply(this,arguments);this._contentView.appendChild(i)},setLoadingLabel:function(e){a.value(this.loadingLabelDiv,e||"");if(this.isOpen()){this.center()}},setCurrentContent:function(){}});var W=function(){W.superClass.constructor.apply(this,arguments);this.__addViewClass("z-popupbox")};e.extend(W,e.Window,{___zdefaults_:{resizable:false}});var F=function(){F.superClass.constructor.apply(this,arguments);this.__addViewClass("z-notification");this.__updateNotificationType()};e.extend(F,e.Window,{___zdefaults_:{close_on_click:true,titlebar_visible:false,toolbar_visible:false,close_after:5100,type:e.Consts.NOTIFICATION_INFO},afterSetProperty:function(e,t,i){F.superClass.afterSetProperty.apply(this,arguments);if(e==="type"){this.__updateNotificationType()}},__updateNotificationType:function(){if(this.__typeCls){this.__removeViewClass(this.__typeCls);this.__typeCls=null}var e=this.get("type");if(e){var t="z-"+e;this.__addViewClass(t);this.__typeCls=t}},__onOpen:function(){F.superClass.__onOpen.apply(this,arguments);this.__setViewCSS("opacity","0");if(this.view.parentNode===document.body){this.__setViewCSS("position","fixed")}else{this.__setViewCSS("position","")}var e=this.get("_notification_position");if(e){var t=this.getView();var s=t.offsetWidth;var a=t.offsetHeight;var n=this.__calcPosition(e.top,e.top_offset,s,a);var r=this.__calcPosition(e.bottom,e.bottom_offset,s,a);var o=this.__calcPosition(e.left,e.left_offset,s,a);var l=this.__calcPosition(e.right,e.right_offset,s,a);this.__setViewCSS_Obj({top:n!==""?n+"px":n,bottom:r!==""?r+"px":r,left:o!==""?o+"px":o,right:l!==""?l+"px":l})}this.__setViewCSS("opacity","");var h=parseInt(this.get("close_after"));if(h>0){i.callLater(function(){this.close()},h,this)}},__calcPosition:function(e,t,i,s){if(e==null){return""}if(e!==""){if(t!==""){switch(t){case"-height":return e-s;case"-width":return e-i;case"height":return e+s;case"width":return e+i}}}return e}});var U={_notificationPool:new e.List,_openedNotificationList:new e.List,_notificationLast:function(i,s,a){var n=10;var r=i.offsetHeight;var o=i.offsetWidth;var l=parseFloat(t.getCSS(i,"top"));var h=parseFloat(t.getCSS(i,"bottom"));var _=parseFloat(t.getCSS(i,"left"));var d=parseFloat(t.getCSS(i,"right"));var c="";var u="",f="",p="",v="";var g="",C="",m="",w="";var S;if(s){S=a.direction||e.Consts.POPUP_DIRECTION_BOTTOM;switch(S){case e.Consts.POPUP_DIRECTION_TOP:u=_;f=l-n;g="-height";break;case e.Consts.POPUP_DIRECTION_BOTTOM:u=_;f=l+r+n;break;case e.Consts.POPUP_DIRECTION_RIGHT:f=l;u=_+o+n;break;case e.Consts.POPUP_DIRECTION_LEFT:f=l;u=_-n;m="-width";break}}else{c=t.getAttr(i,"z-notification-position");if(c=="left.top"){S=a.direction||e.Consts.POPUP_DIRECTION_BOTTOM;switch(S){case e.Consts.POPUP_DIRECTION_TOP:u=_;f=l-n;g="-height";break;case e.Consts.POPUP_DIRECTION_BOTTOM:u=_;f=l+r+n;break;case e.Consts.POPUP_DIRECTION_RIGHT:f=l;u=_+o+n;break;case e.Consts.POPUP_DIRECTION_LEFT:f=l;u=_-n;m="-width";break}}else if(c=="left.bottom"){S=a.direction||e.Consts.POPUP_DIRECTION_TOP;switch(S){case e.Consts.POPUP_DIRECTION_TOP:u=_;p=h+r+n;break;case e.Consts.POPUP_DIRECTION_BOTTOM:u=_;p=h-n;C="-height";break;case e.Consts.POPUP_DIRECTION_RIGHT:p=h;u=_+o+n;break;case e.Consts.POPUP_DIRECTION_LEFT:p=h;u=_-n;m="-width";break}}else if(c=="right.top"){S=a.direction||e.Consts.POPUP_DIRECTION_BOTTOM;switch(S){case e.Consts.POPUP_DIRECTION_TOP:v=d;f=l-n;g="-height";break;case e.Consts.POPUP_DIRECTION_BOTTOM:v=d;f=l+r+n;break;case e.Consts.POPUP_DIRECTION_RIGHT:f=l;v=d-n;w="-width";break;case e.Consts.POPUP_DIRECTION_LEFT:f=l;v=d+o+n;break}}else if(c=="right.bottom"){S=a.direction||e.Consts.POPUP_DIRECTION_TOP;switch(S){case e.Consts.POPUP_DIRECTION_TOP:v=d;p=h+r+n;break;case e.Consts.POPUP_DIRECTION_BOTTOM:v=d;p=h-n;C="-height";break;case e.Consts.POPUP_DIRECTION_RIGHT:p=h;v=d-n;w="-width";break;case e.Consts.POPUP_DIRECTION_LEFT:p=h;v=d+o+n;break}}}return{basePosition:c,position:{right:v,left:u,top:f,bottom:p,right_offset:w,top_offset:g,bottom_offset:C,left_offset:m}}},_notificationFirst:function(e,t){var i,s="";if(e){i=null}else{if(t.position==null){i={right:"20",bottom:"20"};s="right.bottom"}else{var a=t.position;var n=parseFloat(a.top);var r=parseFloat(a.bottom);var o=parseFloat(a.left);var l=parseFloat(a.right);var h=!isNaN(n);var _=!isNaN(l);var d=!isNaN(r);var c=!isNaN(o);if(!c&&!_){l=20;_=true}if(!h&&!d){r=20;d=true}if(_){o=NaN;c=false}if(d){n=NaN;h=false}if(_){if(h){s="right.top"}else{s="right.bottom"}}else{if(h){s="left.top"}else{s="left.bottom"}}if(isNaN(n)){n=""}if(isNaN(r)){r=""}if(isNaN(o)){o=""}if(isNaN(l)){l=""}i={top:n,left:o,right:l,bottom:r}}}return{basePosition:s,position:i}},notification:function(e){if(e===false){var s=arguments[1];if(s instanceof F){s.close()}else{var a=U._openedNotificationList.toList();a.each(function(e){e.close()})}return}if(i.isString(e)){e={content:e}}var n=i.extend({},e);n.titlebar_visible=n.titlebar_visible===true;var r=n.center===true;var o=G.__getOpenConfig(n);o.center=r;o.modal=false;var l=U.__getLastNotification(n,r);var h;if(l){h=U._notificationLast(l,r,n)}else{h=U._notificationFirst(r,n)}n._notification_position=h.position;delete n.position;var _=U._getNotification();var d=_.getView();if(r){t.addClass(d,"z-center")}else{t.removeClass(d,"z-center")}if(h.basePosition){t.setAttr(d,"z-notification-position",h.basePosition)}else{t.removeAttr(d,"z-notification-position")}_.removeProperty("close_after");_.removeProperty("type");_.set(n);_.open(o);U._openedNotificationList.add(_);return _},__getLastNotification:function(e,t){var i=l(e.appendTo)||document.body;var s=".z-notification";if(t){s=".z-notification.z-center"}var a=h(s,i);var n=a.length;if(n>0){return a[n-1]}return null},_getNotification:function(){if(U._notificationPool.size()>0){return U._notificationPool.removeAt(0)}var e=new F;e.__onCloseUtil_=function(){U._notificationPool.add(e);U._openedNotificationList.remove(e)};return e}};e.Tooltip=function(){e.Tooltip.superClass.constructor.apply(this,arguments);this.__addViewClass("z-tooltip");this._setTitlebarVisible(this.get("titlebar_visible"));this._setToolbarVisible(this.get("toolbar_visible"))};e.extend(e.Tooltip,e.Window,{___zdefaults_:{titlebar_visible:false,toolbar_visible:false,close_on_click:false,resizable:false},__onOpen:function(){this.__setViewCSS("opacity","0");i.callLater(function(){this.__setViewCSS("opacity","")},60,this)},__getTooltipConfig:function(e,t){var i=e[t];if(i!=null){return i}return null},updateTooltip:function(e){if(!i.isObject(e)){return}var t=0,s=0,a,n;var r=e.x_align;var o=e.y_align;if(r!=null){a=r.trim().toLocaleLowerCase()}else{a="center"}if(o!=null){n=o.trim().toLocaleLowerCase()}else{n="top"}var l=e.x_gap;var h=e.y_gap;if(i.isNumeric(l)){t=parseFloat(l)}if(i.isNumeric(h)){s=parseFloat(h)}var _=e.point;var d=this.getView();var c=d.offsetWidth;var u=d.offsetHeight;var f=this.getView().parentNode;var p,v;var g=_.x;var C=_.y;switch(a){case"left":p=g-c;break;case"right":p=g;break;default:p=g-c/2;break}switch(n){case"top":v=C-u;break;case"bottom":v=C;break;default:v=C-u/2;break}p+=t;v+=s;i.callLater(function(){this.__setViewCSS_Obj({left:p+"px",top:v+"px",right:"",bottom:""})},100,this)}});var G={window:function(t){if(t===false){var s=arguments[1];if(s instanceof e.Window){s.close()}else{G.__getSysWindow().close()}return}var a=i.extend({},t);a.titlebar_visible=a.titlebar_visible!==false;if(!a.hasOwnProperty("toolbar_visible")){a.toolbar_visible=false;if(a.hasOwnProperty("toolbar_actions")){var n=a.toolbar_actions;if(n.length>0){a.toolbar_visible=true}}}var r=a.system!==false;var o=a.new_on_system_used===true;var l=G.__getOpenConfig(a);var h;if(r){h=G.__getSysWindow(o);if(o&&h.isOpen()){h=new e.Window;G.__setWindowMethods(h,a)}else{G.__resetWindowConfig(h,a);if(!a.hasOwnProperty("center")){if(a.size!==h.get("size")){l.center=true}}}}else{h=new e.Window;G.__setWindowMethods(h,a)}h.set(a);h.open(l);return h},loading:function(t){if(t===false){var s=arguments[1];if(s instanceof e.LoadingWindow){s.close()}else{G.__closeSysLoading()}return}if(i.isString(t)){t={label:t}}var a=i.extend({},t);var n=G.__getOpenConfig(a,undefined,true);n.center=true;var r=a.label||"";var o;var l=a.system!==false;var h=a.new_on_system_used===true;if(l){o=G.__getSysLoadingWindow();if(h&&o.isOpen()){o=G._getLoadingWindow()}}else{o=G._getLoadingWindow()}o.setLoadingLabel(r);o.open(n);return o},__closeSysLoading:function(){G.__getSysLoadingWindow().close()},alert:function(e){if(i.isString(e)){e={content:e}}var t=i.extend({},e);t.toolbar_actions=["ok"];return G.__popupBox(t)},confirm:function(e){if(i.isString(e)){e={content:e}}var t=i.extend({},e);t.toolbar_actions=["ok","cancel"];return G.__popupBox(t)},notification:U.notification,tooltip:function(s,a,n){if(arguments.length===1&&arguments[0]===false){G.__getSysTooltipWindow().close();return}if(s==null||a==null){return}if(i.isString(a)&&!a.trim()){return}var r=i.extend({},n);r.titlebar_visible=r.titlebar_visible===true;r.toolbar_visible=false;var l=G.__getOpenConfig(r);l.center=false;l.modal=false;var h,_;var d=e._iu_.isMouseEvent(a)||e._iu_.isTouchEvent(a);if(!d&&(i.isObject(a)&&a.x!=null&&a.y!=null)){h=a.x;_=a.y}else{var c;if(d){c=e.coord.getPageOffset(a)}else if(i.isString(a)||t.isElement(a)){c=G.__getElementTooltipPoint(a,r)}if(c){h=c.x;_=c.y}else{return}}var u={x_gap:r.x_gap,y_gap:r.y_gap,x_align:r.x_align,y_align:r.y_align,point:{x:h,y:_}};delete r.x_gap;delete r.y_gap;delete r.x_align;delete r.y_align;var f=G.__getSysTooltipWindow();var p=f.get("css");if(p){var v={};o(p,function(e,t){v[e]=""});f.set("css",v);f.removeProperty("css")}f.set("content",s);f.set(r);f.open(l);f.updateTooltip(u);return f},_loadingPool:new e.List,_getLoadingWindow:function(){if(G._loadingPool.size()>0){return G._loadingPool.removeAt(0)}var t=new e.LoadingWindow;t.__onCloseUtil_=function(){G._loadingPool.add(t)};return t},__getSysLoadingWindow:function(){if(!G.__sysLoadingWindow){G.__sysLoadingWindow=new e.LoadingWindow}return G.__sysLoadingWindow},__getSysTooltipWindow:function(){if(!G.__sysTooltipWindow){G.__sysTooltipWindow=new e.Tooltip}return G.__sysTooltipWindow},__getSysWindow:function(){if(!G.__sysWindow){G.__sysWindow=new e.Window}return G.__sysWindow},__popupBox:function(t){t.titlebar_visible=t.titlebar_visible!==false;t.toolbar_visible=t.toolbar_visible!==false;t.actions=["close"];var i=t.system!==false;var s=t.new_on_system_used===true;var a;var n=t.center!==false;var r=t.modal!==false;var o=G.__getOpenConfig(t);o.center=n;o.modal=r;if(i){a=G.__getSysPopupBox();if(s&&a.isOpen()){a=new e.PopupBox;G.__setWindowMethods(a,t)}else{G.__resetWindowConfig(a,t);if(!t.hasOwnProperty("center")){if(t.size!==a.get("size")){o.center=true}}}}else{a=new e.PopupBox;G.__setWindowMethods(a,t)}a.set(t);a.open(o);return a},__getSysPopupBox:function(){if(!G.__sysPopupBox){G.__sysPopupBox=new W}return G.__sysPopupBox},__getOpenConfig:function(e,t,i){var s={};if(e.hasOwnProperty("appendTo")){s.appendTo=e.appendTo}if(e.hasOwnProperty("center")){s.center=e.center}else{s.center=t}if(e.hasOwnProperty("modal")){s.modal=e.modal}else{s.modal=i}delete e.appendTo;delete e.center;delete e.modal;delete e.system;delete e.new_on_system_used;return s},__resetWindowConfig:function(e,t){
    t.title=t.title||"";var i=e.get("css");if(i){var s={};o(i,function(e,t){s[e]=""});e.set("css",s);e.removeProperty("css")}t.size=t.size||"";t.actions=t.actions||["close"];t.toolbar_actions=t.toolbar_actions||[];if(!t.hasOwnProperty("state")){var a=e.get("state");if(a==="minimized"){if(t.actions.indexOf("minimize")===-1){t.state=""}}else if(a==="maximized"){if(t.actions.indexOf("maximize")===-1){t.state=""}}}G.__setWindowMethods(e,t)},__setWindowMethods:function(e,t){var i=["onCustom","onMaximize","onMinimize","onClose","onOK","onCancel","onApply","beforeClose","beforeOpen","onOpen"];o(i,function(i){e[i]=t[i]||null;delete t[i]})},__getElementTooltipPoint:function(t,i){var s=l(t);if(s){var a=e.coord.getPageOffset(s);var n=s.offsetWidth;var r=s.offsetHeight;var o,h;var _=i.x_align;var d=i.y_align;if(_!=null){o=_}else{o="center"}if(d!=null){h=d}else{h="top"}var c,u;var f=a.x;var p=a.y;switch(o){case"left":c=f;break;case"right":c=f+n;break;default:c=f+n/2;break}switch(h){case"top":u=p;break;case"bottom":u=p+r;break;default:u=p+r/2;break}return{x:c,y:u}}return null}};e.ListView=function(){this._initCheck();e.ListView.superClass.constructor.apply(this,arguments);this.__addViewClasses("z-list-base z-list");t.addClass(this.viewUL,"z-group");this.setInteractors([new j(this)])};e.extend(e.ListView,B,{___zdefaults_:{item_element_order:["check","icon","label","info","remove"],icon_visible:true,clear_select_on_check:true,clear_check_on_select:true,check_visible:false,remove_visible:false,change_select_on_click:false,change_check_on_click:false,keyboard_selectable:false},afterSetProperty:function(t,i,s){e.ListView.superClass.afterSetProperty.apply(this,arguments);if("keyboard_selectable"===t){this.updateInteractors()}},beforeRemove:function(e){return true},__isCheckVisible_:function(e){if(!this.get("check_visible")){return false}if(this.containsData(e)===false){return false}if(this.isCheckVisible(e)===false){return false}return true},_onSelectChange:function(){e.ListView.superClass._onSelectChange.apply(this,arguments);if(this.get("clear_check_on_select")!==false){if(this.__isCheckChanging!==true){this.__isSelectChange=true;this.clearCheck();this.__isSelectChange=false}}},_onDataRemove:function(t){e.ListView.superClass._onDataRemove.apply(this,arguments);if(this.isChecked(t)){this.__justUnCheck(t)}},_onDataClear:function(){e.ListView.superClass._onDataClear.apply(this,arguments);this.__justClearCheck()},_onSetProvider:function(){e.ListView.superClass._onSetProvider.apply(this,arguments);this.__justClearCheck()},getExt:function(e,t,i){return null},getRendererClass:function(t){return e.ListViewRenderer}});i.extendClassPrototype(e.ListView,b);i.extendClassPrototype(e.ListView,k);e.ListViewRenderer=function(){this._itemDiv=a.create("div");this._itemElementsMap={};e.ListViewRenderer.superClass.constructor.apply(this,arguments);t.setCSS(this._itemDiv,"position","relative");t.addClass(this._itemDiv,"z-in");this.addToRenderer(this._itemDiv)};e.extend(e.ListViewRenderer,A,{__getRenderContainer_:function(){return this._itemDiv},validateViewProperty:function(t,i){this._oldViewRemoveVisiblee=this.viewRemoveVisible;e.ListViewRenderer.superClass.validateViewProperty.apply(this,arguments);this.viewItemOrder=t.get("item_element_order");this.viewIconVisible=t.get("icon_visible");this.viewRemoveVisible=t.get("remove_visible")},validateDataProperty:function(t,s){this._oldDataCheckable=this.dataCheckable;this._oldDataChecked=this.dataChecked;this._oldDataCheckVisible=this.dataCheckVisible;e.ListViewRenderer.superClass.validateDataProperty.apply(this,arguments);var a=s.get("info");if(a!=null){a+=""}this.dataInfo=i.isNonBlankString(a)?a:null;this.dataCheckVisible=t.__isCheckVisible_(s);if(this.dataCheckVisible){this.dataChecked=t.isChecked(s);this.dataCheckable=t.isCheckable(s)}var n=t.getExt(s,this.dataHover);if(this.dataExt!==n){this._oldDataExt=this.dataExt;this.dataExt=n}else{this._oldDataExt=null}},validateRenderer:function(){e.ListViewRenderer.superClass.validateRenderer.apply(this,arguments);if(this.dataInfo){this.__addItemElement_("info",this.getDInfoSpan());if(this.dataInfo!==this._dinfoSpan.innerHTML){this._dinfoSpan.innerHTML=this.dataInfo}}else{this.__removeItemElement_("info",this._dinfoSpan)}if(this.dataLabel){this.__addItemElement_("label",this.getDLabelSpan());if(this.dataLabel!==this._dlabelSpan.innerHTML){this._dlabelSpan.innerHTML=this.dataLabel}}else{this.__removeItemElement_("label",this._dlabelSpan)}if(this.viewIconVisible&&this.dataIcon){this.__addItemElement_("icon",this.getDIconImg());if(this.dataIcon!==this._diconImg.src){this._diconImg.src=this.dataIcon}}else{this.__removeItemElement_("icon",this._diconImg)}if(this.dataCheckVisible){this.__addItemElement_("check",this.getDCheckSpan());this.__updateCheckValue()}else{this.__removeItemElement_("check",this._dcheckSpan)}if(this.viewRemoveVisible){this.__addItemElement_("remove",this.getDRemoveSpan());if(this._oldDataHover!==this.dataHover){if(this.dataHover){t.setClass(this._removeIcon,"z-icon z-widget-sprite z-ws-close")}else{t.setClass(this._removeIcon,"z-icon z-widget-sprite z-ws-delete")}}}else{this.__removeItemElement_("remove",this._dremoveSpan)}if(this._oldViewRemoveVisiblee!==this.viewRemoveVisible){if(this.viewRemoveVisible){this.__addRenderClass("z-item-with-remove")}else{this.__removeRenderClass("z-item-with-remove")}}if(this._oldDataExt){t.remove(this._oldDataExt)}if(this.dataExt){if(this._itemDiv.lastElementChild!==this.dataExt){t.remove(this.dataExt);this._itemDiv.appendChild(this.dataExt)}}},__updateCheckValue:function(){if(this._oldDataCheckVisible!==this.dataCheckVisible||this._oldDataChecked!==this.dataChecked||this._oldDataCheckable!==this.dataCheckable){if(this.dataChecked){if(this.dataCheckable){t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-checked")}else{t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-checked-disabled")}}else{if(this.dataCheckable){t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox")}else{t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-disabled")}}}},_updateState:function(t){e.ListViewRenderer.superClass._updateState.apply(this,arguments);if(this._oldDataCheckVisible!==this.dataCheckVisible||this._oldDataChecked!==this.dataChecked){var i=this._oldDataCheckVisible&&this._oldDataChecked;var s=false;var a=false;if(this.dataCheckVisible){if(this.dataChecked){if(!i){s=true}}else{a=true}}else{a=true}a=i&&a;if(s){g.addCheckedState(this.renderer)}else if(a){g.removeCheckedState(this.renderer)}}},getDCheckSpan:function(){if(!this._dcheckSpan){this._dcheckSpan=a.create("span");this._dcheckSpan.dtype="check"}return this._dcheckSpan},getDIconImg:function(){if(!this._diconImg){this._diconImg=a.create("img","z-icon");t.setAttr(this._diconImg,"draggable","false");this._diconImg.dtype="icon"}return this._diconImg},getDLabelSpan:function(){if(!this._dlabelSpan){this._dlabelSpan=a.create("span","z-label");this._dlabelSpan.dtype="label"}return this._dlabelSpan},getDInfoSpan:function(){if(!this._dinfoSpan){this._dinfoSpan=a.create("span","z-info");this._dinfoSpan.dtype="info"}return this._dinfoSpan},getDRemoveSpan:function(){if(!this._dremoveSpan){this._dremoveSpan=a.create("span","z-remove");this._removeIcon=a.create("span","z-icon z-widget-sprite z-ws-delete");this._removeIcon.dtype="remove";this._dremoveSpan.appendChild(this._removeIcon);this._dremoveSpan.dtype="remove"}return this._dremoveSpan},__addItemElement_:function(e,t){var i=this.viewItemOrder;var s=this._itemElementsMap;var a=null;for(var n=i.length-1;n>=0;n--){var r=i[n];if(r===e){if(t.parentNode){if(t.nextSibling!==a){this._itemDiv.insertBefore(t,a)}}else{this._itemDiv.insertBefore(t,a);s[r]=t}return}else{if(s[r]){a=s[r]}}}},__removeItemElement_:function(e,t){if(t&&t.parentNode){t.parentNode.removeChild(t);this._itemElementsMap[e]=null}}});var j=function(){j.superClass.constructor.apply(this,arguments)};e.extend(j,I,{});var K=function(){this.__initExpand();K.superClass.constructor.apply(this,arguments)};e.extend(K,e.ListView,{});i.extendClassPrototype(K,P);i.extendClassPrototype(K,T);i.extendClassPrototype(K,L);var Y=function(){Y.superClass.constructor.apply(this,arguments)};e.extend(Y,K,{___zdefaults_:{item_element_order:["expand","check","icon","label","info","remove"],expand_visible:true},__isVisible_:function(e){var t=Y.superClass.__isVisible_.apply(this,arguments);if(t){t=this.__isHVisible_(e)}return t},__onDataRenderPositionChange:function(e){},_onDataIndexChange:function(e,t){Y.superClass._onDataIndexChange.apply(this,arguments);this._onHDataIndexChange(e,t)},_onDataChange:function(e,t){Y.superClass._onDataChange.apply(this,arguments);if(t.property==="parent"){this._onHDataChange(e,t);var i=t.newValue;var s=t.oldValue;this.__updateParentCheck(e,i,s);this.__invalidateDataAndAscendant(e)}},_onDataRemove:function(e){this.__updateParentCheck(e,null,e.get("parent"));Y.superClass._onDataRemove.apply(this,arguments);this.__invalidateDataAndAscendant(e)},_onDataAdd:function(e){Y.superClass._onDataAdd.apply(this,arguments);this.__updateParentCheck(e,e.get("parent"));this.__invalidateDataAndAscendant(e);this._onHDataAdd(e)},__check:function(e){Y.superClass.__check.apply(this,arguments);this.__checkChildren(e);this.__checkParent(e)},__unCheck:function(e){Y.superClass.__unCheck.apply(this,arguments);this.__unCheckChildren(e);this.__unCheckParent(e)}});var Z=function(){Z.superClass.constructor.apply(this,arguments)};e.extend(Z,e.ListViewRenderer,{validateViewProperty:function(e,t){this._oldViewExpandVisible=this.viewExpandVisible;Z.superClass.validateViewProperty.apply(this,arguments);this.viewExpandVisible=e.get("expand_visible")!==false},validateDataProperty:function(e,t){this._oldDataHasChildChecked=this.dataHasChildChecked;this._oldDataLevel=this.dataLevel;this._oldDataIsLeaf=this.dataIsLeaf;this._oldDataExpanded=this.dataExpanded;Z.superClass.validateDataProperty.apply(this,arguments);this.dataIsLeaf=e.isLeaf(t);if(!this.dataIsLeaf){this.dataExpanded=e.isExpanded(t);if(this.dataCheckVisible&&!this.dataChecked){this.dataHasChildChecked=e.hasChildrenChecked(t)}}this.dataLevel=e.getLevel(t,e.__getRootData())},validateRenderer:function(){Z.superClass.validateRenderer.apply(this,arguments);if(this.viewExpandVisible===true&&!this.dataIsLeaf){this.__addItemElement_("expand",this.getDExpandSpan());this.__updateExpandValue()}else{this.__removeItemElement_("expand",this._dexpandSpan)}if(this._oldDataIsLeaf!==this.dataIsLeaf){if(this.dataIsLeaf){t.removeClass(this.renderer,"z-expandable");t.addClass(this.renderer,"z-leaf")}else{t.removeClass(this.renderer,"z-leaf");t.addClass(this.renderer,"z-expandable")}}},__updateExpandValue:function(){if(this._oldViewExpandVisible!==this.viewExpandVisible||this._oldDataIsLeaf!==this.dataIsLeaf||this._oldDataExpanded!==this.dataExpanded){if(this.dataExpanded){t.setClass(this._dexpandSpan,"z-expand z-widget-sprite z-ws-minus")}else{t.setClass(this._dexpandSpan,"z-expand z-widget-sprite z-ws-plus")}}},__updateCheckValue:function(){if(this._oldDataCheckVisible!==this.dataCheckVisible||this._oldDataChecked!==this.dataChecked||this._oldDataCheckable!==this.dataCheckable||this._oldDataHasChildChecked!==this.dataHasChildChecked){if(this.dataChecked){if(this.dataCheckable){t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-checked")}else{t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-checked-disabled")}}else{if(this.dataHasChildChecked){if(this.dataCheckable){t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-indeterminate")}else{t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-indeterminate-disabled")}}else{if(this.dataCheckable){t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox")}else{t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-disabled")}}}}},getDExpandSpan:function(){if(!this._dexpandSpan){this._dexpandSpan=a.create("span");this._dexpandSpan.dtype="expand"}return this._dexpandSpan}});var J={drag_and_drop:true};e.Tree=function(){e.Tree.superClass.constructor.apply(this,arguments);this.__removeViewClass("z-list");this.__addViewClass("z-tree");this.setInteractors(new q(this))};e.extend(e.Tree,Y,{___zdefaults_:{level_offset:22,drag_and_drop:false,click_expand:false,dbl_click_expand:true},afterSetProperty:function(t,i,s){e.Tree.superClass.afterSetProperty.apply(this,arguments);if(J.hasOwnProperty(t)){this.updateInteractors()}},__onDataRenderPositionChange:function(e){if(e.hasChildren()){this.hEachDataByRoot(e,function(e){var t=this.getRenderer(e);if(t){this.__addRenderer(e,t)}this.invalidateData(e)},this)}},__getLastRenderElement:function(t,i){var s=new e.List;this.hEachDataByRoot(i,function(e){if(e===t){return false}s.add(e)},this);var a=null;s.each(function(e){var t=this.__getAppendedRendererElement(e);if(t){a=t;return false}},this,true);if(a===null&&i){return this.__getAppendedRendererElement(i)}return a},getRendererClass:function(){return e.TreeRenderer},onDragEnd:function(e,t,i,s,a){if(i&&i!==s){i.removeData(e)}},onDrop:function(e,t,i,s,a){if(s!==i){s.addData(e);if(i&&i.hEachDataByRoot){i.hEachDataByRoot(e,function(e){s.addData(e)},this)}}if(a==="child"){e.set("parent",t);this.expand(t,true)}else{var n=i===s;var r=this.getProvider()._getDataIndex(t);var o=t.get("parent");var l;if(n&&o===e.get("parent")){l=this.getProvider()._getDataIndex(e);if(l<r){r=Math.max(0,r-1)}}e.set("parent",o);if(a==="before"){this.getProvider().moveTo(e,r)}else if(a==="after"){this.getProvider().moveTo(e,r+1)}if(o){this.expand(o,true)}}var h=this.getRenderElement(e);if(h){d.scrollTo(h,this.view)}return true}});e.TreeRenderer=function(){e.TreeRenderer.superClass.constructor.apply(this,arguments);this.__setRenderCSS("display","none")};e.extend(e.TreeRenderer,Z,{validateViewProperty:function(t,i){e.TreeRenderer.superClass.validateViewProperty.apply(this,arguments);this.viewLevelOffset=t.get("level_offset")},validateDataProperty:function(t,i){e.TreeRenderer.superClass.validateDataProperty.apply(this,arguments);var s="";if(this.dataLevel>0){s=this.dataLevel*this.viewLevelOffset;if(this.dataIsLeaf&&this.viewExpandVisible){s+=this.viewLevelOffset}if(s>0){s+=2}if(s!==0){s+="px"}else{s=""}}this.__dataGapChange=false;if(this.__dataGap!==s){this.__dataGap=s;this.__dataGapChange=true}},__setIndents:function(){var e=this.dataLevel;if(this.dataIsLeaf){e=this.dataLevel+1}if(this.count<1&&!this._indentSpan){return}if(!this._indentSpan){this._indentSpan=a.create("span");this._itemDiv.insertBefore(this._indentSpan,this._itemDiv.firstChild)}var t=this._indentSpan.children;var i=t.length;if(i<e){for(var s=i;s<e;s++){this._indentSpan.appendChild(a.create("span","z-expand z-indent"))}}else if(i>e){e=Math.max(e,0);for(var n=i-1;n>=e;n--){this._indentSpan.removeChild(t[n])}}},validateRenderer:function(){e.TreeRenderer.superClass.validateRenderer.apply(this,arguments);if(this.__dataGapChange){t.setCSS(this._itemDiv,"padding-left",this.__dataGap)}}});var q=function(){q.superClass.constructor.apply(this,arguments);this.__dragContent=a.create("span","z-label")};e.extend(q,j,{update:function(){q.superClass.update.apply(this,arguments);var e=this.view;var t=e.get("drag_and_drop")===true;if(this.dragAndDrop!==t){this.dragAndDrop=t;var i=this.view.getView();if(t){this.view.__addViewClass("z-user-select-none");D.enableDrag(i,this.start_drag,this);D.enableDrop(i,this.drag_hover,this)}else{this.view.__removeViewClass("z-user-select-none");D.disableDrag(i,this.start_drag,this);D.disableDrop(i,this.drag_hover,this)}}},start_drag:function(e){var t=s.getTarget(e);if(u.isExpandSpan(t)){return}var i=this.view.getDataAt(t);if(i&&this.view.__isDraggable(i)){i=this.view.getDragData(i);if(i){this.__dragContent.innerHTML=this.view.getLabel(i);this.view.onDragStart(i);return{drag:{data:i,onDragEnd:this.handle_drag_end,view:this.view,drag_end_context:this},drag_content:this.__dragContent}}}return null},handle_drag_end:function(e,t){var i=e.data;var s=t.data;var a=t.position;var n=e.view;var r=t.view;this.view.onDragEnd(i,s,n,r,a)},drag_hover:function(t,i){var s=this.view.getDataAt(t);if(s){var a=this.view.getRenderer(s);var n=a.getRenderElement();var r=e.coord.getBoundingClientRect(n);var o=e.coord.getWindowOffset(t).y;var l;if(o<=r.y+6){l="before"}else if(o>=r.y+r.height-6){l="after"}else{l="child"}var h=i.data;var _=i.view;if(this.view.__isDroppable(h,s,_,this.view,l)){var d=a.__getRenderContainer_();if(l==="before"){m.addDropHint(d,{bottom:"",top:"1px"})}else if(l==="after"){m.addDropHint(d,{bottom:"-2px",top:""})}else{m.removeDropHint()}var c;if(l==="before"){c="z-widget-sprite z-ws-insert-top"}else if(l==="after"){c="z-widget-sprite z-ws-insert-bottom"}else{c="z-widget-sprite z-ws-add"}this.view.onDragHover(h,s,_,this.view,l);return{drop:{data:s,view:this.view,position:l,onDrop:this.handle_drop,drop_context:this},cls:c}}m.removeDropHint()}return null},handle_drop:function(e,t){var i=e.data;var s=t.data;var a=t.position;var n=e.view;var r=t.view;m.removeDropHint();this.view.onDrop(i,s,n,r,a)},handle_click:function(e){var t=s.getTarget(e);var i=this.view.getDataAt(t);if(!this._isDataEnabled(i)){return}if(u.isExpandSpan(t)){this.view.toggleExpand(i);this.view.__onDataClick(i)}else{if(this.view.get("click_expand")===true){this.view.toggleExpand(i)}q.superClass.handle_click.apply(this,arguments)}},handle_dblclick:function(e){var t=s.getTarget(e);var i=this.view.getDataAt(t);if(!this._isDataEnabled(i)){return}if(u.isExpandSpan(t)){this.view.__onDataDblClick(i)}else{q.superClass.handle_dblclick.apply(this,arguments);if(!u.isCheckBoxSpan(t)){if(this.view.get("click_expand")!==true&&this.view.get("dbl_click_expand")===true){this.view.toggleExpand(i)}}}}});var Q=function(){this.__initContentInterface();Q.superClass.constructor.apply(this,arguments)};e.extend(Q,e.ListView,{});i.extendClassPrototype(Q,y);e.TabStrip=function(){this._contentDiv=a.create("div","z-content");e.TabStrip.superClass.constructor.apply(this,arguments);this.__removeViewClass("z-list");this.__addViewClass("z-tabstrip");this.addToView(this._contentDiv)};e.extend(e.TabStrip,Q,{___zdefaults_:{position:e.Consts.POSITION_TOP,select_on_hover:false,auto_select:true,content_visible:true,wrap:true},__onHover:function(t,i){e.TabStrip.superClass.__onHover.apply(this,arguments);if(i&&this.get("select_on_hover")===true&&t!==this.getLastSelect()){this.setSelect(t)}},_onSetProvider:function(t){this.__updateCurrentData=true;e.TabStrip.superClass._onSetProvider.apply(this,arguments);this.clearDataContent();this.__autoSelectFirst()},_onProviderChange:function(t){var i=t.type;var s=t.data;if(i==="remove"){this.removeDataContent(s);if(this.__currentDataID===s.id()){this.__autoSelectNext(t.info.index)}}else if(i==="clear"){this.clearDataContent()}else if(i==="add"){if(this.__isEnabled_(s)&&this.__isAutoSelect()){this.setSelect(s)}}e.TabStrip.superClass._onProviderChange.apply(this,arguments)},_onSelectChange:function(){this.__updateCurrentData=true;e.TabStrip.superClass._onSelectChange.apply(this,arguments)},_onDataChange:function(t,i){if(i.property==="content"){this.removeDataContent(t);if(this.getLastSelect()===t){this.__updateCurrentData=true}}e.TabStrip.superClass._onDataChange.apply(this,arguments)},afterSetProperty:function(t,i,s){if(t==="position"){this.__updatePosition(i)}else if(t==="wrap"){this.__updateWrap(i)}else if(t==="auto_select"){if(i!==false&&this.getProvider()&&!this.getLastSelect()){this.__autoSelectFirst()}}else if(t==="content_visible"){this.__updateContentVisible(i)}e.TabStrip.superClass.afterSetProperty.apply(this,arguments)},__isAutoSelect:function(){return this.get("auto_select")!==false},__autoSelectFirst:function(){if(!this.__isAutoSelect()){return}var e=this.getDataList(false);e.each(function(e){if(this.__isEnabled_(e)){this.setSelect(e);return false}},this)},__autoSelectNext:function(e){if(!this.__isAutoSelect()){return}var t=this.getDataList(false);var i=t.size();if(i>0){var s,a;for(var n=e;n<i;n++){a=t.get(n);if(this.__isEnabled_(a)){s=a;break}}if(s==null){for(var r=e-1;r>=0;r--){a=t.get(n);if(this.__isEnabled_(a)){s=a;break}}}if(s){this.setSelect(s)}}},validate:function(){e.TabStrip.superClass.validate.apply(this,arguments);this.__updateTSView();if(this.__updateCurrentData===true){this.__updateCurrentData=false;this.__setCurrentData(this.getLastSelect())}},__updatePosition:function(t){this.__removeViewClass("z-tabstrip-left");this.__removeViewClass("z-tabstrip-right");this.__removeViewClass("z-tabstrip-bottom");if(t===e.Consts.POSITION_LEFT){this.__addViewClass("z-tabstrip-left")}else if(t===e.Consts.POSITION_RIGHT){this.__addViewClass("z-tabstrip-right")}else if(t===e.Consts.POSITION_BOTTOM){this.__addViewClass("z-tabstrip-bottom")}},__updateWrap:function(e){if(e){t.removeClass(this.viewUL,"z-tabstrip-nowrap")}else{t.addClass(this.viewUL,"z-tabstrip-nowrap")}},__updateContentVisible:function(e){if(e===false){t.setCSS(this._contentDiv,"display","none")}else{t.setCSS(this._contentDiv,"display","")}this.__updateCurrentData=true},__updateTSView:function(){var i=this.get("position");var s=e.coord.getBoundingClientRect(this.viewUL,true);var a=s.width;var n=s.height;if(i===e.Consts.POSITION_LEFT){t.setCSS_Obj(this._contentDiv,{left:a+"px","min-height":n-1+"px","min-width":"",right:"",top:"",bottom:""})}else if(i===e.Consts.POSITION_RIGHT){t.setCSS_Obj(this._contentDiv,{right:a+"px","min-height":n-1+"px","min-width":"",left:"",top:"",bottom:""})}else if(i===e.Consts.POSITION_BOTTOM){t.setCSS_Obj(this._contentDiv,{bottom:n+"px","min-width":a+"px","min-height":"",top:"",left:"",right:""})}else{t.setCSS_Obj(this._contentDiv,{top:n+"px","min-width":a-1+"px","min-height":"",bottom:"",left:"",right:""})}},__setCurrentData:function(e){if(this.get("content_visible")===false){return}this.__currentDataID=null;if(e){var t=e.id();this.__currentDataID=t;this.setCurrentDataContent(e)}else{this.hideAllContent()}},getRendererClass:function(){return e.TabStripRenderer},getContentContainer:function(){return this._contentDiv}});e.TabStripRenderer=function(){this._loadingSpan=a.create("span","z-loading");e.TabStripRenderer.superClass.constructor.apply(this,arguments);this.__getRenderContainer_().appendChild(this._loadingSpan)};e.extend(e.TabStripRenderer,e.ListViewRenderer,{});e.Menu=function(){e.Menu.superClass.constructor.apply(this,arguments);this.__removeViewClass("z-list");this.__addViewClasses("z-menu");this.__setViewCSS_Obj({width:"",height:"",overflow:"visible"});this.setInteractors([new X(this)])};e.extend(e.Menu,Y,{___zdefaults_:{direction:e.Consts.POPUP_DIRECTION_RIGHT_BOTTOM,menu_bar_direction:e.Consts.POPUP_DIRECTION_BOTTOM_RIGHT,item_element_order:["check","icon","label","info","expand"],keyboard_selectable:e.Consts.KEYBOARD_SELECTABLE_PRESELECT,show_on_hover:false,close_on_click:true,close_on_check:false,selectable:false,menu_bar:false},afterSetProperty:function(t,i,s){if(t==="menu_bar"){this.__updateMenuBar(i)}e.Menu.superClass.afterSetProperty.apply(this,arguments)},isCloseOnClick:function(e){return this.get("close_on_click")===true},__updateMenuBar:function(e){if(e===true){this.__addViewClass("z-menu-bar");this.__removeViewClass("z-popup")}else{this.__addViewClass("z-popup");this.__removeViewClass("z-menu-bar")}},__isMenuBarData:function(e){if(this.get("menu_bar")===true){if(e.get("parent")==this.__getRootData()){return true}}return false},__onHover:function(t,i){e.Menu.superClass.__onHover.apply(this,arguments);if(i===true){if(this.__isMenuBarData(t)){if(this.get("show_on_hover")!==true&&!this.__hasExpand()){return}}this.__handleMenuExpand(t)}},__handleMenuExpand:function(e){this.setPreSelectData(null);this.collapseAll();this._expandDataAndAscendant(e)},_onExpand:function(){e.Menu.superClass._onExpand.apply(this,arguments);this.__updateInteractors()},_onCollapse:function(){e.Menu.superClass._onCollapse.apply(this,arguments);this.__updateInteractors()},__updateInteractors:function(){if(this.__updateInteractorsFlag===true){return}this.__updateInteractorsFlag=true;i.callRAFLater(function(){this.updateInteractors();this.__updateInteractorsFlag=false},this)},__hasExpand:function(){var e=false;o(this._getExpandMap(),function(t,i){if(i===true){e=true;return false}});return e},_expandDataAndAscendant:function(e){if(!this.isLeaf(e)){this.expand(e)}var t=e.get("parent");var i=this.__getRootData();while(t){this.expand(t);if(t==i){break}t=t.get("parent")}},getRendererContainer:function(t){var i=t.get("parent");if(i){return this.__getSubMenuContainer(i)}return e.Menu.superClass.getRendererContainer.apply(this,arguments)},__getSubMenuContainer:function(e){var t=this.getRenderer(e);if(t){return t.getSubMenuContainer()}return null},isOpen:function(){return this.__isOpend===true},open:function(e){if(this.get("menu_bar")===true){return}var s=e||{};var a=document.body;if(a==null){return}if(f._viewBeforeOpen(this)===false){return}this.collapseAll();this.setHoverData(null);this.setPreSelectData(null);v.setZIndex(this.view,l(s.zIndexElement)||document.body,"menu");t.setCSS(this.view,"opacity",0);a.appendChild(this.view);this.validate();i.callLater(function(){this.__setViewCSS("opacity","");f._viewOnOpen(this);this.updateInteractors()},60,this)},__beforeOpen:function(){},__onOpen:function(){},__beforeClose:function(){},__onClose:function(){},close:function(){if(this.get("menu_bar")===true){return}if(f._viewBeforeClose(this)===false){return}t.remove(this.view);f._viewOnClose(this);this.updateInteractors()},updateMenu:function(t,s){if(!i.isObject(t)){return}var a=t.position;if(!a){var n=t.point;var r=this.getView();var o=r.offsetWidth;var l=r.offsetHeight;var h=n.x;var _=n.y;var d=e.coord.getWindowBounds();var c=d.x;var u=d.y;var f=d.width;var p=d.height;var v=_<=u+p/2;var g=h<=c+f/2;var C="",m="",w="",S="";if(s!==false){if(v){m=_;if(g){C=h}else{if(h+o>c+f){if(h-o>=c){w=h+o}else{C=h}}else{C=h}}}else{if(g){C=h;if(_+l>u+p){if(_-l>=u){S=_}else{m=_}}else{m=_}}else{if(h+o>c+f){if(h-o>=c){w=h+o}else{C=h}}else{C=h}if(_+l>u+p){if(_-l>=u){S=_}else{m=_}}else{m=_}}}C=C!==""?C+"px":C;m=m!==""?m+"px":m;w=w!==""?w+"px":w;S=S!==""?S+"px":S}else{C=h+"px";m=_+"px"}a={left:C,top:m,right:w,bottom:S}}this.__setViewCSS_Obj(a)},__hideAllSubMenu:function(){this.eachVisibleData(function(e){var t=this.getRenderer(e);if(t){t.hideSubMenu()}},this)},getRendererClass:function(){return e.MenuRenderer},getDataAt:function(e){if(e){var i=this.__getEventTarget(e);if(t.isElement(i)){if(t.hasClass(i,"z-popup")){return null}var s=i.getAttribute("__z_did_");while(!s){i=i.parentNode;if(i&&i.getAttribute){if(t.hasClass(i,"z-popup")){break}s=i.getAttribute("__z_did_")}else{break}}if(s){return this.getDataByID(s)}}}return null},__isHitData:function(t){return e.Menu.superClass.getDataAt.apply(this,arguments)!=null}});e.MenuRenderer=function(){e.MenuRenderer.superClass.constructor.apply(this,arguments)};e.extend(e.MenuRenderer,Z,{validateViewProperty:function(t,i){e.MenuRenderer.superClass.validateViewProperty.apply(this,arguments);this.viewMenuDirection=t.get("direction");this.viewMenuBarDirection=t.get("menu_bar_direction");this.viewMenuBar=t.get("menu_bar")===true;if(this.viewMenuBar){this.dataMenuBarItem=i.get("parent")==t.__getRootData()}else{this.dataMenuBarItem=false}},_updateState:function(t){e.MenuRenderer.superClass._updateState.apply(this,arguments);if(!this.dataHover){if(this.dataExpanded){g.addHoverState(this.renderer);return}g.removeHoverState(this.renderer)}},validateRenderer:function(i,s){e.MenuRenderer.superClass.validateRenderer.apply(this,arguments);if(!this.dataIsLeaf&&this.dataExpanded){this.showSubMenu()}else{this.hideSubMenu()}if(this._dexpandSpan&&this._dexpandSpan.parentNode){if(this.dataMenuBarItem){t.setClass(this._dexpandSpan,"z-expand z-widget-sprite z-ws-i-arrow-s")}else{t.setClass(this._dexpandSpan,"z-expand z-widget-sprite z-ws-i-arrow-e")}}},getSubMenuContainer:function(){if(!this._subMenuUL){this._childrenDiv=a.create("div","z-popup");t.setCSS(this._childrenDiv,"display","none");this._subMenuUL=a.create("ul","z-group");this._childrenDiv.appendChild(this._subMenuUL);this.addToRenderer(this._childrenDiv)}return this._subMenuUL},hideSubMenu:function(){if(this._childrenDiv){t.setCSS(this._childrenDiv,"display","none")}},showSubMenu:function(){if(this._childrenDiv){var i=this.renderer.offsetWidth+"px";var s=this.renderer.offsetHeight+"px";var a=this.dataMenuBarItem?this.viewMenuBarDirection:this.viewMenuDirection;var n="",r="",o="",l="";switch(a){case e.Consts.POPUP_DIRECTION_TOP_LEFT:o=s;l="0px";break;case e.Consts.POPUP_DIRECTION_TOP_RIGHT:o=s;r="0px";break;case e.Consts.POPUP_DIRECTION_BOTTOM_LEFT:n=s;l="0px";break;case e.Consts.POPUP_DIRECTION_LEFT_TOP:l=i;o="0px";break;case e.Consts.POPUP_DIRECTION_LEFT_BOTTOM:n="0px";l=i;break;case e.Consts.POPUP_DIRECTION_RIGHT_TOP:r=i;o="0px";break;case e.Consts.POPUP_DIRECTION_RIGHT_BOTTOM:n="0px";r=i;break;default:n=s;r="0px";break}t.setCSS_Obj(this._childrenDiv,{top:n,right:l,bottom:o,left:r,display:""})}}});var X=function(){X.superClass.constructor.apply(this,arguments)};e.extend(X,j,{update:function(){X.superClass.update.apply(this,arguments);var e=this.view;this.isMenuBar=e.get("menu_bar")===true;var t=e.__hasExpand();this.isMenuOpen=e.isOpen();if(t||this.isMenuOpen){e.getView().focus();if(this._hasExpandListener!==true){this.addWindowListener("mousedown");if(this.__keyboard_selectable!==true){this.addViewListener("keydown")}this._hasExpandListener=true}}else{if(this._hasExpandListener===true){this.removeWindowListener("mousedown");if(this.__keyboard_selectable!==true){this.removeViewListener("keydown")}this._hasExpandListener=false}}},handle_window_mousedown:function(e){if(!this.view.__isHitData(e)){if(this.isMenuOpen){this.view.close()}this.view.setPreSelectData(null);this.view.collapseAll()}},handle_click:function(e){var t=s.getTarget(e);var i=this.view;var a=i.getDataAt(t);if(!this._isDataEnabled(a)){return}if(u.isRemoveSpan(t)){if(i.beforeRemove(a)!==false){i.removeData(a)}}else if(u.isCheckBoxSpan(t)){this._toggleCheck(a)}else{var n=i.__isCheckVisible_(a);if(n&&i.get("change_check_on_click")===true){this._toggleCheck(a)}else{if(i.__isSelectable_(a)){this.__handleSelect(a,e.ctrlKey)}}if(this.__hoverable!==true){i.__handleMenuExpand(a)}else{if(i.__isMenuBarData(a)){if(i.get("show_on_hover")!==true){i.expand(a)}}}if(!e.ctrlKey){if(i.isLeaf(a)&&i.isCloseOnClick(a)){if(this.isMenuOpen){i.close()}i.collapseAll()}}}i.__onDataClick(a,e)},handle_keydown:function(e){if(this.__keyboard_selectable!==true){return}var t=e.keyCode;if(t===27){this.__handleKeyESC();e.preventDefault()}else if(t===13){this.__handleKeyEnter(e);e.preventDefault()}else if(t===40){this.__handleKeyDownUp(false);e.preventDefault()}else if(t===39){this.__handleKeyRight();e.preventDefault()}else if(t===38){this.__handleKeyDownUp(true);e.preventDefault()}else if(t===37){this.__handleKeyLeft();e.preventDefault()}},__handleKeyESC:function(){var e=this._getCurrentData();if(e){var t=this.view;if(t.isExpanded(e)){t.collapse(e);if(this.isMenuBar&&t.__isMenuBarData(e)){t.setPreSelectData(null)}}else{var i=e.get("parent");if(i){t.collapse(i,true);if(this.isMenuBar&&t.__isMenuBarData(i)){t.setPreSelectData(null)}else{t.setPreSelectData(i)}}else{if(!this.isMenuBar&&this.isMenuOpen){t.close()}}}}},__handleKeyEnter:function(e){var t=this.view;var i=t.getPreSelectData();if(i){if(!this._isDataEnabled(i)){return}if(t.isLeaf(i)){if(t.__isSelectable_(i)){this.__handleSelect(i,e.ctrlKey)}if(t.isCloseOnClick(i)){if(this.isMenuOpen){t.close()}t.collapseAll()}t.__onDataClick(i,e)}else{t.collapseAll();t._expandDataAndAscendant(i)}}},__handleKeyLeft:function(){var e=this._getCurrentData();if(e){var t=this.view;var i;if(t.isExpanded(e)){t.collapse(e);if(this.isMenuBar&&t.__isMenuBarData(e)){i=this.getPrevSelectableData(e);if(!i){i=this._getFirstVisibleChild(t,null,true)}}}else{var s=e.get("parent");if(s){t.collapse(s,true);t.setPreSelectData(s);if(this.isMenuBar&&t.__isMenuBarData(s)){
    i=this.getPrevSelectableData(s);if(!i){i=this._getFirstVisibleChild(t,null,true)}}}}if(i){t.setPreSelectData(i);t.setHoverData(null);t.expand(i)}}},__handleKeyRight:function(){var e=this._getCurrentData();if(e){var t=this.view;var i=t.isExpanded(e);t.collapseAll();var s;if(this.isMenuBar){if(t.__isMenuBarData(e)){s=this.getNextSelectableData(e);if(!s){s=this._getFirstVisibleChild(t,null)}}else{t._expandDataAndAscendant(e);if(i){s=this.getNextSelectableData(e)}}}else{t._expandDataAndAscendant(e);if(i){s=this.getNextSelectableData(e)}}if(s){t.setPreSelectData(s);t.setHoverData(null);t.expand(s);this.__handleSelectNext(s)}}},__handleKeyDownUp:function(e){var t=this._getCurrentData();var i;if(t){if(e){i=this.getPrevSelectableData(t)}else{i=this.getNextSelectableData(t)}}else{i=this._getFirstData()}if(i==null){if(this.isMenuOpen){i=this._getFirstVisibleChild(this.view,null,e)}}this.__handleSelectNext(i)},__handleSelectNext:function(t){if(t){var i=this.view;i.setHoverData(null);if(this.__viewKeyboardSelectable===e.Consts.KEYBOARD_SELECTABLE_SELECT){i.setSelect(t)}else{i.setPreSelectData(t)}var s=i.getRenderElement(t);d.scrollTo(s,i.getView())}},_getFirstData:function(){var e=this.view;var t;var i=this.__getLastExpandData();if(i){t=this._getFirstVisibleChild(e,i)}return t},getNextSelectableData:function(e){var t=this.view;if(t.isExpanded(e)){return this._getFirstVisibleChild(t,e)}return X.superClass.getNextSelectableData.apply(this,arguments)},getPrevSelectableData:function(e){var t=this.view;if(t.isExpanded(e)){return this._getFirstVisibleChild(t,e,true)}return X.superClass.getPrevSelectableData.apply(this,arguments)},_getFirstVisibleChild:function(e,t,i){var s;var a;if(t){a=t.getChildren(false)}else{a=e.getRootList(false)}if(a){a.each(function(t){if(e.__isVisible_(t)&&e.__isEnabled_(t)){s=t;return false}},this,i)}return s},__getLastExpandData:function(){var t=this.view;var i=new e.List;o(t._getExpandMap(),function(e,s){if(s===true){i.add(t.getDataById(e))}});var s;i.each(function(e){var i=e.getChildren(false);var a=false;i.each(function(e){if(t.__isVisible_(e)){if(t.isExpanded(e)){a=true;return false}}});if(a===false){s=e;return false}});return s}});var $={__getSysPopupMenu:function(){if(!$.__sysPopupMenu){$.__sysPopupMenu=new e.Menu}return $.__sysPopupMenu},popupMenu:function(s,a,n){if(arguments.length===1&&arguments[0]===false){$.__getSysPopupMenu().close();return}if(a==null){return}if(i.isString(a)&&!a.trim()){return}var r=i.isProvider(s);if(!r&&!i.isList(s)&&!i.isArray(s)){return}var l=i.extend({},n);var h={zIndexElement:l.zIndexElement};var _;var d,c;var u=e._iu_.isMouseEvent(a)||e._iu_.isTouchEvent(a);if(!u&&(i.isObject(a)&&a.x!=null&&a.y!=null)){d=a.x;c=a.y}else{var f;if(u){f=e.coord.getPageOffset(a);d=f.x;c=f.y}else if(i.isString(a)||t.isElement(a)){_=true;f=$.__getElementMenuPosition(a,l)}if(f==null){return}}var p=$.__getSysPopupMenu();$.__resetMenuConfig(p,l);var v={};o(l,function(e,t){if(i.isFunction(t)){v[e]=t}});o(v,function(e,t){delete l[e]});p.set(l);o(v,function(e,t){p[e]=t});if(r){p.setProvider(s)}else{p.setProvider(new Provider(s))}p.open(h);var g;if(_){g={position:f}}else{g={point:{x:d,y:c}}}p.updateMenu(g,!_);return p},__getElementMenuPosition:function(t,i){var s=l(t);if(s){var a=e.coord.getPageOffset(s);var n=a.x;var r=a.y;var o=s.offsetWidth;var h=s.offsetHeight;var _=i.direction||e.Consts.POPUP_DIRECTION_BOTTOM_RIGHT;var d="",c="",u="",f="";switch(_){case e.Consts.POPUP_DIRECTION_TOP_LEFT:u=r;f=n+o;break;case e.Consts.POPUP_DIRECTION_TOP_RIGHT:u=r;c=n;break;case e.Consts.POPUP_DIRECTION_BOTTOM_LEFT:d=r+h;f=n+o;break;case e.Consts.POPUP_DIRECTION_LEFT_TOP:f=n;u=r+h;break;case e.Consts.POPUP_DIRECTION_LEFT_BOTTOM:d=r;f=n;break;case e.Consts.POPUP_DIRECTION_RIGHT_TOP:c=n;u=r+h;break;case e.Consts.POPUP_DIRECTION_RIGHT_BOTTOM:d=r;c=n;break;default:d=r+h;c=n;break}c=c!==""?c+"px":c;d=d!==""?d+"px":d;f=f!==""?f+"px":f;u=u!==""?u+"px":u;return{top:d,right:f,bottom:u,left:c,display:""}}return null},__resetMenuConfig:function(e,t){var i=e.get("css");if(i){var s={};o(i,function(e,t){s[e]=""});e.set("css",s);e.removeProperty("css")}var a=["onDataClick","beforeOpen","onOpen","beforeClose","onClose"];o(a,function(i){e[i]=t[i]||null;delete t[i]})}};var ee=function(e){this._dateID=w.__getDateKey(e);ee.superClass.constructor.apply(this,[{date:e}])};e.extend(ee,e.Data,{id:function(){return this._dateID}});var te=function(){te.superClass.constructor.apply(this,arguments)};e.extend(te,e.SelectProvider,{setDate:function(t){this.clear();if(!i.isList(t)){t=new e.List(t)}if(t.size()===0){return}t.each(function(e){this.__addDateSelection(new ee(e))},this);this.dispatchProviderChangeEvent("set",t)},__addDateSelection:function(e){this._dataList.add(e);this._dataMap[e.id()]=e},addDate:function(e){if(this._containsDate(e)){return}var t=new ee(e);this.add(t)},removeDate:function(e){if(this._containsDate(e)){this.remove(this._getDateData(e))}},clearDate:function(){this.clear()},_getDateData:function(e){var t=w.__getDateKey(e);return this.getByID(t)},_containsDate:function(e){var t=w.__getDateKey(e);return this.getByID(t)!=null},isDateSelected:function(e){return this._containsDate(e)},getDateSelection:function(){var t=this.getDataList(false);var i=new e.List;t.each(function(e){i.add(e.get("date"))});return i},getDateLastSelect:function(){var e=this.getLastSelect();if(e){return e.get("date")}return null}});e.Calendar=function(){var s=e._iu_._parseDataViewArguments(arguments);var a=s.props;var n=s.provider;var r;if(i.isObject(a)){r=a.select_date;delete a.select_date}this.__today=new Date;this.__calendarCreateElements_();this._dateSelectProvider=new te;e.Calendar.superClass.constructor.apply(this,[n,a]);this._dateSelectProvider.addProviderChangeListener(this._handleDateSelectChange,this);t.remove(this.viewUL);this.__removeViewClass("z-list");this.__addViewClass("z-calendar");this.addToView(this._headerDiv);this.addToView(this._contentDiv);this.addToView(this._footerDiv);this._initCalendarData();if(r){a.select_date=r;this._dateSelectProvider.setDate(r)}this.__inited=true;var o=this.get("current_date");if(!o){this.set("current_date",this._dateSelectProvider.getDateLastSelect()||this.__today)}var l=this.get("current_mode");if(!l){this.set("current_mode",this.get("mode")||"month")}this.__updatePreSelectDateOnToUP();this.__updateTodayText();this.__setViewCSS_Obj({height:"",width:"",overflow:"hidden"});this.setInteractors(new se(this))};e.extend(e.Calendar,e.ListView,{___zdefaults_:{local:null,start_date:new Date(1900,0,1),end_date:new Date(2099,11,31),_views:new e.List(["century","decade","year","month"]),mode:"month"},_setPreSelectDate:function(e){var t;if(e){var i=e.get("date");if(i){t=i}}this._preSelectDate=t;this.invalidateView()},_getPreSelectDate:function(){return this._preSelectDate},_isPreSelectDate:function(e){if(e&&this._preSelectDate){var t=e.get("date");if(t){var i=this.get("current_mode");var s=w.getYear(t);var a=w.getMonth(t);var n=w.getDay(t);var r=w.getYear(this._preSelectDate);var o=w.getMonth(this._preSelectDate);var l=w.getDay(this._preSelectDate);switch(i){case"month":return n===l;case"year":return a===o;case"decade":return s===r}return w.__isSame(t,this._preSelectDate,this.get("current_mode"))}}return false},_isSelectedDate:function(e){var t=e.get("date");var i=false;if(t){var s=this.getDateSelectProvider().getDateSelection();var a=this.get("current_mode");s.each(function(e){if(w.__isSame(t,e,a)){i=true;return false}},this)}return i},__isEnabled_:function(t){if(this.__isWeek(t)){return false}var i=t.get("date");if(i){var s=this.get("start_date");var a=this.get("end_date");if(!w.__isInRange(i,s,a)){return false}}return e.Calendar.superClass.__isEnabled_.apply(this,arguments)},__isSelectable_:function(t){if(this.__isWeek(t)){return false}var i=this.get("mode");var s=t.get("_dtype");var a=this.__getUpModeCDay(s);if(a!==i){return false}return e.Calendar.superClass.__isSelectable_.apply(this,arguments)},getLabel:function(t){var i=t.get("_dtype");var s=t.get("date");if(s){var a=this.get("start_date");var n=this.get("end_date");if(!w.__isInRange(s,a,n)){return""}}if(i==="day"){return w.getDay(s)}else if(i==="year"){return w.getYear(s)}else if(i==="decade"){var r=w.getYear(s);return r+"-<br>"+(r+9)}else{return e.Calendar.superClass.getLabel.apply(this,arguments)}},afterSetProperty:function(t,s,a){e.Calendar.superClass.afterSetProperty.apply(this,arguments);if(this.__inited===true){if(t==="current_mode"){var n=this.__getModeIndex(s);var r=this.__getModeIndex(this.get("mode"));if(n>r){return}this.__updateCurrentModeView(s);var o=this.__getModeIndex(a);this.__modeToDownFlag=n>o;if(this.__modeToDownFlag===false){this.__updatePreSelectDateOnToUP()}}else if(t==="current_date"){i.callRAFLater(this.__updatePreSelectDate,this);this.__updateCurrentViewDate()}else if(t==="mode"){this.__updateTodayText();var l=this.get("current_mode");if(l){var h=this.__getModeIndex(s);var _=this.__getModeIndex(l);if(_>h){this.set("current_mode",s)}}else{this.set("current_mode",s)}}else if(t==="start_date"){this.__updatePrevNextState()}else if(t==="end_date"){this.__updatePrevNextState()}}},__updatePreSelectDate:function(){if(this.__modeToDownFlag===true){this.__modeToDownFlag=false;this.__updatePreSelectDateOnToDown()}else{this.__updatePreSelectDateOnToLeftRight()}},__updatePreSelectDateOnToUP:function(){var e=this._preSelectDate;if(e==null){var t=this._dateSelectProvider.getDateLastSelect();if(t){e=t}else{e=this.get("current_date")}this._preSelectDate=e;this.invalidateView()}},__updatePreSelectDateOnToDown:function(){var e=this.get("current_date");if(e==null){return}var t=this._preSelectDate;if(t==null){var i=this._dateSelectProvider.getDateLastSelect();if(i){t=i}else{t=e}}var s=this.get("current_mode");var a=w.getYear(t);var n=w.getMonth(t);var r=w.getDay(t);var o=w.getYear(e);var l=w.getMonth(e);var h=w.getDay(e);var _=w.getMonthDays(e);var d,c;var u=Math.min(r,_);switch(s){case"decade":d=w.getDecadeStart(e)+a-w.getDecadeStart(t);c=n;break;case"year":d=o;c=n;break;case"month":d=o;c=l;break}if(d!=null){this._preSelectDate=new Date(d,c,u)}else{this._preSelectDate=null}this.invalidateView()},__updatePreSelectDateOnToLeftRight:function(){var e=this.get("current_date");if(e==null){return}var t=this._preSelectDate;if(t==null){var i=this._dateSelectProvider.getDateLastSelect();if(i){t=i}else{t=e}}var s=this.get("current_mode");var a=w.getYear(t);var n=w.getMonth(t);var r=w.getDay(t);var o=w.getYear(e);var l=w.getMonth(e);var h=w.getDay(e);var _=w.getMonthDays(e);var d,c;var u=Math.min(r,_);switch(s){case"month":d=o;c=l;break;case"year":d=o;c=n;break;case"decade":d=w.getDecadeStart(e)+a-w.getDecadeStart(t);c=n;break;case"century":d=w.getCenturyStart(e)+a-w.getCenturyStart(t);c=n;break}if(d!=null){this._preSelectDate=new Date(d,c,u)}else{this._preSelectDate=null}this.invalidateView()},__updateCurrentViewDate:function(){this.__updateCurrentDateData();this.__updatePrevNextState();this.__updateCurrentText();this.invalidateView()},__updateCurrentModeView:function(){var e=this.get("current_mode");o(this.__dateViewMap,function(t,i){if(e===t){a.show(i)}else{a.hide(i)}});this.__updateCurrentText();this.__updatePrevNextState();this.invalidateView()},__updateCurrentDateData:function(){var t=this.get("current_date");var i=w.getYear(t);var s=w.getMonth(t);var a=w.getMonthFirstDayWeek(t);var n=w.getMonthDays(t);var r=w.getPrevMonthDays(t);var o=w.getDecadeStart(t);var l=w.getCenturyStart(t);var h=this.get("local");var _=e.i18n.getLabel("calendar.firstDay",h);var d=a-_;if(d<0){d+=7}if(d==0){d+=7}this._dayList.each(function(e){e.removeProperty("_prev");e.removeProperty("_next")});var c=0,u=0;var f;for(u=0;u<d;u++){f=this._dayList.get(c);f.set("_prev",true);f.set("date",new Date(i,s-1,r-d+1+u));c++}for(u=0;u<n;u++){f=this._dayList.get(c);f.set("date",new Date(i,s,1+u));c++}for(u=n+d;u<42;u++){f=this._dayList.get(c);f.set("_next",true);f.set("date",new Date(i,s+1,u-+(n+d)+1));c++}for(u=0;u<12;u++){f=this._monthList.get(u);f.set("date",new Date(i,u,1))}for(u=0;u<12;u++){f=this._yearList.get(u);f.set("date",new Date(o+u,0,1))}for(u=0;u<12;u++){f=this._decadeList.get(u);f.set("date",new Date(l+u*10,0,1))}},__updatePrevNextState:function(){var e=this.get("current_date");var t=this.get("current_mode");if(!(e&&t)){return}var i=this.get("start_date");var s=this.get("end_date");var a,n;switch(t){case"month":a=w.getPrevMonthDay(e);n=w.getNextMonthDay(e);break;case"year":a=w.getPrevYearDay(e);n=w.getNextYearDay(e);break;case"decade":a=w.getPrevDecadeDay(e);n=w.getNextDecadeDay(e);break;case"century":a=w.getPrevCenturyDay(e);n=w.getNextCenturyDay(e);break}this.___prevActionEnable=false;this.___nextActionEnable=false;if(w.__isBefore(a,i)){g.addDisabledState(this._prevAction)}else{this.___prevActionEnable=true;g.removeDisabledState(this._prevAction)}if(w.__isAfter(n,s)){g.addDisabledState(this._nextAction)}else{this.___nextActionEnable=true;g.removeDisabledState(this._nextAction)}},__updateCurrentText:function(){var t=this.get("current_mode");var i=this.get("current_date");var s=w.getYear(i);var a;switch(t){case"month":var n=w.getMonth(i);var r=e.i18n.getLabel("calendar.months",this.get("local")).names;a=r[n]+" "+s;break;case"year":a=s;break;case"decade":var o=w.getDecadeStart(i)+1;a=o+"-"+(o+9);break;case"century":var l=w.getCenturyStart(i)+10;a=l+"-"+(l+99);break}this._currentSpan.innerHTML=a},__updateTodayText:function(){this._todayAction.innerHTML=this._getDateLabel(this.__today)},_getDateLabel:function(t){var i=this.get("mode");var s=w.getYear(t);var a=w.getMonth(t);var n=e.i18n.getLabel("calendar.months",this.get("local")).names;var r="";switch(i){case"month":var o=w.getDay(t);if(o<10){o="0"+o}r=n[a]+" "+o+",  "+s;break;case"year":r=n[a]+" "+s;break;case"decade":r=s;break;case"century":var l=parseInt(s/10)*10;r=l+"-"+(l+9);break}return r},__calendarCreateElements_:function(){this._headerDiv=a.create("div","z-header");this._prevAction=d.createAction(this.toPrev,this,"z-widget-sprite z-ws-i-arrow-w2");this._nextAction=d.createAction(this.toNext,this,"z-widget-sprite z-ws-i-arrow-e2");this._currentSpan=a.create("span","z-current");g.addHoverListener(this._currentSpan);s.onclick(this._currentSpan,this.toUP,this);this._headerDiv.appendChild(this._prevAction);this._headerDiv.appendChild(this._currentSpan);this._headerDiv.appendChild(this._nextAction);this._footerDiv=a.create("div","z-footer");this._todayAction=d.createAction(this.toToday,this);this._footerDiv.appendChild(this._todayAction);this._contentDiv=a.create("div","z-content");this._monthUL=a.create("ul");this._weekUL=a.create("ul");this._monthDiv=a.create("div");this._yearUL=a.create("ul");this._decadeUL=a.create("ul");this._centuryUL=a.create("ul");this._monthDiv.appendChild(this._weekUL);this._monthDiv.appendChild(this._monthUL);this._contentDiv.appendChild(this._monthDiv);this._contentDiv.appendChild(this._yearUL);this._contentDiv.appendChild(this._decadeUL);this._contentDiv.appendChild(this._centuryUL);this.__dateContainerMap={week:this._weekUL,day:this._monthUL,month:this._yearUL,year:this._decadeUL,decade:this._centuryUL};this.__dateViewMap={month:this._monthDiv,year:this._yearUL,decade:this._decadeUL,century:this._centuryUL}},_initCalendarData:function(){var t=0;this._weekList=new e.List;this._dayList=new e.List;this._monthList=new e.List;this._yearList=new e.List;this._decadeList=new e.List;var i=this.get("local");var s=e.i18n.getLabel("calendar.weeks",i).abbr;var a=e.i18n.getLabel("calendar.firstDay",i);for(t=a;t<7;t++){this._weekList.add(new e.Data({_dtype:"week",name:s[t]}))}for(t=0;t<a;t++){this._weekList.add(new e.Data({_dtype:"week",name:s[t]}))}for(t=0;t<42;t++){this._dayList.add(new e.Data({_dtype:"day"}))}var n=e.i18n.getLabel("calendar.months",i).abbr;for(t=0;t<12;t++){this._monthList.add(new e.Data({_dtype:"month",name:n[t]}))}for(t=0;t<12;t++){this._yearList.add(new e.Data({_dtype:"year"}))}this._yearList.getFirst().set("_prev",true);this._yearList.getLast().set("_next",true);for(t=0;t<12;t++){this._decadeList.add(new e.Data({_dtype:"decade"}))}this._decadeList.getFirst().set("_prev",true);this._decadeList.getLast().set("_next",true);var r=new e.Provider;r.add(this._weekList);r.add(this._dayList);r.add(this._monthList);r.add(this._yearList);r.add(this._decadeList);this.setProvider(r)},getRendererContainer:function(e){var t=e.get("_dtype");return this.__dateContainerMap[t]},getRendererClass:function(){return ie},_getDateData:function(e){var t=this.get("current_mode");var i;switch(t){case"month":i=this._dayList;break;case"year":i=this._monthList;break;case"decade":i=this._yearList;break;case"century":i=this._decadeList;break}var s;i.each(function(i){var a=i.get("date");if(w.__isSame(a,e,t)){s=i;return false}});return s},getDateSelectProvider:function(){return this._dateSelectProvider},_handleDateSelectChange:function(e){this.__callBatchDateSelectChange()},__callBatchDateSelectChange:function(){if(this.__batchDateSelectChangeFlag===true){return}this.__batchDateSelectChangeFlag=true;i.callLater(this.__handleBatchDateSelectChange,60,this)},__handleBatchDateSelectChange:function(){this.__batchDateSelectChangeFlag=false;this._onDateChange();this.onDateChange()},setSelectDate:function(e){this._dateSelectProvider.setDate(e)},getSelectDate:function(){var t=this.get("selectable");if(t===e.Consts.SELECTABLE_MULTIPLE){return this._dateSelectProvider.getDateSelection()}else{return this._dateSelectProvider.getDateLastSelect()}},_onDateChange:function(){this._setPreSelectDate(null);var e=this.getDateSelectProvider().getDateLastSelect();if(e){var t=this._getDateData(e);if(t){if(!this.isCurrentData(t)){this.set("current_date",e)}}}this.invalidateView()},onDateChange:function(){},__getUpMode:function(e){var t=e||this.get("current_mode");var i=this.get("_views");var s=this.__getModeIndex(t);if(s>0){return i.get(s-1)}return null},__getUpModeCDay:function(e){if(e==="day"){return"month"}return this.__getUpMode(e)},__getDownMode:function(e){var t=e||this.get("current_mode");var i=this.get("_views");var s=this.__getModeIndex(t);if(s<i.size()-1){return i.get(s+1)}return null},__getDownModeCDay:function(e){if(e==="month"){return"month"}return this.__getDownMode(e)},toPrev:function(){if(this.___prevActionEnable!==true){return}var e=this.get("current_mode");var t=this.get("current_date");var i;switch(e){case"month":i=w.getPrevMonthDay(t);break;case"year":i=w.getPrevYearDay(t);break;case"decade":i=w.getPrevDecadeDay(t);break;case"century":i=w.getPrevCenturyDay(t);break}this.set("current_date",i)},toNext:function(){if(this.___nextActionEnable!==true){return}var e=this.get("current_mode");var t=this.get("current_date");var i;switch(e){case"month":i=w.getNextMonthDay(t);break;case"year":i=w.getNextYearDay(t);break;case"decade":i=w.getNextDecadeDay(t);break;case"century":i=w.getNextCenturyDay(t);break}this.set("current_date",i)},toUP:function(){var e=this.__getUpMode();if(e){this.set("current_mode",e)}},toDown:function(){var e=this.__getDownMode();if(e){this.set("current_mode",e)}},toToday:function(){this.set("current_date",this.__today)},isCurrentData:function(e){return e.get("_prev")!==true&&e.get("_next")!==true},__isDay:function(e){return e.get("_dtype")==="day"},__isWeek:function(e){return e.get("_dtype")==="week"},__isMonth:function(e){return e.get("_dtype")==="month"},__isYear:function(e){return e.get("_dtype")==="year"},__isDecade:function(e){return e.get("_dtype")==="decade"},__getModeIndex:function(e){var t=this.get("_views");return t.indexOf(e)}});var ie=function(){ie.superClass.constructor.apply(this,arguments);this.dataDType=this.data.get("_dtype");this.__addRenderClass("z-calendar-"+this.dataDType)};e.extend(ie,e.ListViewRenderer,{validateDataProperty:function(e,t){this._oldDataLast=this.dataLast===true;this._oldDataNext=this.dataNext===true;this._oldIsInOther=this.isInOther===true;ie.superClass.validateDataProperty.apply(this,arguments);this.dataLast=t.get("_prev")===true;this.dataNext=t.get("_next")===true;this.isInOther=this.dataLast||this.dataNext;if(!e.__isSelectable_(t)||this.isInOther){this.dataSelected=false}else{this.dataSelected=e._isSelectedDate(t)}if(this.dataSelected||this.isInOther){this.dataPreSelect=false}else{this.dataPreSelect=e._isPreSelectDate(t)}},validateRenderer:function(){ie.superClass.validateRenderer.apply(this,arguments);if(this._oldIsInOther!==this.isInOther){if(this.isInOther){this.__addRenderClass("z-other")}else{this.__removeRenderClass("z-other")}}if(this.dataLast!==this._oldDataLast){if(this.dataLast){this.__addRenderClass("z-prev")}else{this.__removeRenderClass("z-prev")}}if(this.dataNext!==this._oldDataNext){if(this.dataNext){this.__addRenderClass("z-next")}else{this.__removeRenderClass("z-next")}}}});var se=function(){se.superClass.constructor.apply(this,arguments)};e.extend(se,j,{handle_click:function(e){var t=s.getTarget(e);var i=this.view;if(this.__keyboard_selectable===true){this.view.getView().focus()}var a=i.getDataAt(t);if(!this._isDataEnabled(a)){return}if(i.__isSelectable_(a)){se.superClass.handle_click.apply(this,arguments);return}this.__toDownModeView(a);i.__onDataClick(a,e)},__handleSelect:function(t,i){var s=this.view;var a=s.get("selectable");var n=s.get("change_select_on_click")===true;var r=t.get("date");if(r){var o=s.getDateSelectProvider();if(a===e.Consts.SELECTABLE_SINGLE){if(!o.isDateSelected(r)){o.setDate(r)}else if(i||n){o.removeDate(r)}}else if(a===e.Consts.SELECTABLE_MULTIPLE){if(i||n){if(o.isDateSelected(r)){o.removeDate(r)}else{o.addDate(r)}}else{if(!o.isDateSelected(r)){o.setDate(r)}}}}},__toDownModeView:function(e){var t=e.get("_dtype");if(t){var i=this.view;var s=i.get("mode");var a=i.__getModeIndex(t);if(a!=-1){var n=i.__getModeIndex(s);if(a<=n){i.set("current_mode",t);var r=i.get("current_date");var o=e.get("date");var l=new Date(w.getYear(o),w.getMonth(o),w.getDay(r));i.set("current_date",l)}}}},handle_keydown:function(e){if(this.__keyboard_selectable!==true){return}var t=e.keyCode;if(t===13){this.__handleKeyEnter(e);e.preventDefault()}else if(t===40){this.__handleKeyDownUp(false);e.preventDefault()}else if(t===39){this.__handleKeyLeftRight(false);e.preventDefault()}else if(t===38){this.__handleKeyDownUp(true);e.preventDefault()}else if(t===37){this.__handleKeyLeftRight(true);e.preventDefault()}},__handleKeyEnter:function(e){var t=this.view;var i=t._getPreSelectDate();if(i){var s=t._getDateData(i);if(s){if(!this._isDataEnabled(s)){return}if(t.__isSelectable_(s)){this.__handleSelect(s,e.ctrlKey);return}this.__toDownModeView(s)}}},__handleKeyDownUp:function(e){var t=this._getCurrentData();if(t){var i=t.get("date");if(i){var s=this.view;var a=s.get("current_mode");var n=4;if(a=="month"){n=7}var r=this.__getNextNDate(i,n,e);s.set("current_date",r);var o=s._getDateData(r);this.__handleSelectNext(o)}}},_getCurrentData:function(){var e=this.view._getPreSelectDate()||this.view.getDateSelectProvider().getDateLastSelect();if(e){return this.view._getDateData(e)}return data},__getNextNDate:function(e,t,i){var s=this.view.get("current_mode");var a;var n=w.getYear(e);var r=w.getMonth(e);var o=w.getDay(e);if(i){t*=-1}switch(s){case"month":a=new Date(n,r,o+t);break;case"year":a=new Date(n,r+t,o);break;case"decade":a=new Date(n+t,r,o);break;case"century":a=new Date(n+t*100,r,o);break}return a},__handleKeyLeftRight:function(e){var t=this._getCurrentData();if(t){var i=t.get("date");if(i){var s=this.view;var a=this.__getNextNDate(i,1,e);s.set("current_date",a);var n=s._getDateData(a);this.__handleSelectNext(n)}}},__handleSelectNext:function(t){if(t){var i=this.view;i.setHoverData(null);if(this.__viewKeyboardSelectable===e.Consts.KEYBOARD_SELECTABLE_SELECT){i.setSelect(t)}else{i._setPreSelectDate(t)}}}});var ae=function(){ae.superClass.constructor.apply(this,arguments);this.__removeViewClass("z-list");this.__addViewClass("z-dropdown-multi");this.__setViewCSS_Obj({height:"auto",width:"100%",overflow:"hidden"})};e.extend(ae,e.ListView,{___zdefaults_:{icon_visible:true,check_visible:false,remove_visible:true,selectable:"none"}});var ne={_initDropDown:function(){this._dropDownView=a.create("div","z-widget z-dropdown");this._dropDownSpan=a.create("span","z-select");this._dropDownArrowSpan=a.create("span","z-icon z-widget-sprite");this._input=a.create("input","z-input");t.setAttr(this._input,"readonly",true);this._popupDiv=a.create("div","z-popup z-dropdown-popup");this._dropDownSpan.appendChild(this._dropDownArrowSpan);this._dropDownView.appendChild(this._input);this._dropDownView.appendChild(this._dropDownSpan)},_updateInput:function(e){if(e===true){t.removeAttr(this._input,"readonly")}else{t.setAttr(this._input,"readonly",true)}},_updatePlaceholder:function(e){if(!this.__isMulti()){t.setAttr(this._input,"placeholder",e)}},_updateMulti:function(){if(this.__isMulti()){t.addClass(this._dropDownView,"z-multiselect");t.setCSS(this._dropDownSpan,"display","none");t.setCSS(this._dropDownView,"padding-right","0");t.setAttr(this._input,"size",Math.max(1,this._input.value.length));t.removeAttr(this._input,"placeholder");var i=this._getDropDownMulti();i.clearData();if(this.getProvider()){var s=this.getValueData();if(s){i.add(s)}}for(var a=0;a<10;a++){i.addData(new e.Data({name:"hhh-"+a}))}i.validate();this._dropDownView.insertBefore(i.getView(),this._input)}else{t.removeAttr(this.input,"size");t.removeClass(this._dropDownView,"z-multiselect");t.setCSS(this._dropDownSpan,"display","");t.setCSS(this._dropDownView,"padding-right","");var n=this.get("placeholder");if(n){t.setAttr(this._input,"placeholder",n)}if(this._dropDownMulti){t.remove(this._dropDownMulti.getView())}}},_getDropDownMulti:function(){if(!this._dropDownMulti){var e=this;this._dropDownMulti=new ae({_onDataRemove:function(t){ae.prototype._onDataRemove.apply(this,arguments);if(e.__isCheckType()){e.unCheck(t)}else{e.removeSelect(t)}}})}return this._dropDownMulti},__isMulti:function(){return this.__isCheckType()||this.get("selectable")===e.Consts.SELECTABLE_MULTIPLE},__isCheckType:function(){return this.get("check_visible")===true},setValue:function(t){if(t){var i=new e.List;var s=this.__isMulti();var a=this.get("value_field");var n=new e.List(t);n.each(function(e){var t=this.findData(a,e);if(t){i.add(t);if(!s){return false}}},this)}this.setValueData(i)},getValue:function(){var e=this.getValueData();if(e){var t=this.get("value_field");if(this.__isMulti()){var i=[];e.each(function(e){i.push(e.get(t))});return i}else{return e.get(t)}}return null},setValueData:function(t){if(t){if(this.__isCheckType()){this.clearCheck();new e.List(t).each(function(e){this.check(e)},this)}else{this.setSelect(t)}}else{if(this.__isCheckType()){this.clearCheck()}else{this.clearSelect()}}},getValueData:function(){if(this.__isMulti()){if(this.__isCheckType()){return this.getCheckedList()}return this.getSelection()}return this.getLastSelect()},__onDropDownValueChange:function(e){if(e===true){if(!this.__isCheckType()){return}}else{if(this.__isCheckType()){return}}if(!this.__isMulti()){this.close()}var t=this.getValueData();var i=this.getValue();this._onValueChange(i,t);this.onValueChange(i,t)},_onValueChange:function(e,t){var i="";var s=this.__isMulti();if(t){if(s){var a=this._getDropDownMulti();a.clearData();a.add(t)}else{i=this.getLabel(t)}}else{if(s){this._getDropDownMulti().clearData()}}this._input.value=i},onValueChange:function(e,t){},getPopupContent:function(){return this.view},isOpen:function(){return this.__isOpend===true},__beforeOpen:function(){this.invalidateView()},__onOpen:function(){this.validate()},__beforeClose:function(){},__onClose:function(){},open:function(){if(this.isOpen()){return}var e=this._dropDownView.parentNode;if(e==null){return}var s=this.getPopupContent();if(s){if(f._viewBeforeOpen(this)===false){return}v.setZIndex(this._popupDiv,e,"dropdown");t.setCSS(this._popupDiv,"opacity",0);if(!s.parentNode){this._popupDiv.appendChild(s)}var a;if(this.get("popup_width")){var n=this.get("popup_width");if(i.isNumeric(n)){a=n+"px"}else{a=n}}else{var r=this._dropDownView.offsetWidth;a=r+"px"}t.setCSS(this._popupDiv,"width",a);document.body.appendChild(this._popupDiv);i.callLater(function(){this._updateDropDownArrow();f.setPopupPosition(this._dropDownView,this._popupDiv,this.get("direction"));t.setCSS(this._popupDiv,"opacity");f._viewOnOpen(this);this.updateInteractors()},60,this)}},close:function(){if(f._viewBeforeClose(this)===false){return}this._updateDropDownArrow();t.remove(this._popupDiv);f._viewOnClose(this);this.updateInteractors();this.setHoverData(null)},appendTo:function(e){e=l(e);if(e){e.appendChild(this.getDropDownView());i.callLater(this.update,this)}},__isPrototypeVisible:function(e){if(this.containsData(e)==false){return false}if(this.isVisible(e)==false){return false}return true},__isInputVisible:function(t){if(this._inputFilterLabel){var i=this.getLabel(t);var s=this.get("filter");if(s===e.Consts.STRING_FILTER_STARTSWITH){return i.startsWith(this._inputFilterLabel)!=-1}else if(s===e.Consts.STRING_FILTER_ENDSWITH){return i.endsWith(this._inputFilterLabel)!=-1}else{return i.indexOf(this._inputFilterLabel)!=-1}return false}return true},_getMathchData:function(e){return this.__getMatchData(e)},__getMatchData:function(t){var i,s;var a=this.get("filter");this.eachData(function(n){if(this.__isPrototypeVisible(n)){var r=this.getLabel(n);if(r===t){i=n;return false}if(!s){if(a===e.Consts.STRING_FILTER_STARTSWITH){if(r.startsWith(t)!=-1){s=n}}else if(a===e.Consts.STRING_FILTER_ENDSWITH){if(r.endsWith(t)!=-1){s=n}}else{if(r.indexOf(t)!=-1){s=n}}}}},this);if(i){return i}return s},__getHMatchData:function(t){var i,s;var a=this.get("filter");this.hEachData(function(n){if(this.__isPrototypeVisible(n)){var r=this.getLabel(n);if(r===t){i=n;return false}if(!s){if(a===e.Consts.STRING_FILTER_CONTAINS){if(r.indexOf(t)!=-1){s=n}}else if(a===e.Consts.STRING_FILTER_STARTSWITH){if(r.startsWith(t)!=-1){s=n}}else if(a===e.Consts.STRING_FILTER_ENDSWITH){if(r.endsWith(t)!=-1){s=n}}}}},this);if(i){return i}return s},__onDropDownSelectChange:function(e){if(this.__isCheckType()){if(e===true){this.__updateSelectValue()}}else{if(e!==true){this.__updateSelectValue()}}},__updateSelectValue:function(){var e=this.getDropDownSelection();this._onValueChange(e);this.onValueChange(e);if(!this.__isMulti()){this.close()}},getDropDownSelection:function(){if(this.__isMulti()){if(this.__isCheckType()){return this.getCheckedList()}return this.getSelection()}return this.getLastSelect()},_updateDropDownArrow:function(){var i=this.get("direction");var s=this._dropDownArrowSpan;if(i===e.Consts.POPUP_DIRECTION_LEFT_TOP||i===e.Consts.POPUP_DIRECTION_RIGHT_TOP||i===e.Consts.POPUP_DIRECTION_TOP_LEFT||i===e.Consts.POPUP_DIRECTION_TOP_RIGHT){if(this.isOpen()){t.removeClass(s,"z-ws-i-arrow-n");t.addClass(s,"z-ws-i-arrow-s")}else{t.removeClass(s,"z-ws-i-arrow-s");t.addClass(s,"z-ws-i-arrow-n")}}else{if(this.isOpen()){t.removeClass(s,"z-ws-i-arrow-s");t.addClass(s,"z-ws-i-arrow-n")}else{t.removeClass(s,"z-ws-i-arrow-n");t.addClass(s,"z-ws-i-arrow-s")}}},getDropDownView:function(){return this._dropDownView},_getPopupDiv:function(){return this._popupDiv}};var re={input:false,disabled:false,popup_resize:false,filter:e.Consts.STRING_FILTER_CONTAINS,case_sensitive:false,direction:e.Consts.POPUP_DIRECTION_BOTTOM_RIGHT,value_field:"name","expand-on-open":true};var oe=function(){this.__dropDownViewListenerMap={};oe.superClass.constructor.apply(this,arguments);this.dropDownView=this.view.getDropDownView();this.input=this.view._input;s.on(this.input,"input",this.handle_input,this);s.on(this.input,"keydown",this.handle_input_keydown,this)};e.extend(oe,e.IViewInteractor,{handle_input_keydown:function(e){if(e.keyCode===13){var t=this.view.getPreSelectData();if(t){if(this.view.__isCheckType()){this.view.check(t)}else{this.view.setSelect(t)}}}},handle_input:function(){var s=this.view;if(s.__isMulti()){i.callLater(function(){t.setAttr(this.input,"size",Math.max(1,this.input.value.length))},100,this)}var a=this.input.value;if(this._lastInputValue===a){return}var n=false;if(this._lastInputValue){
    n=this._lastInputValue.indexOf(a)!=-1}this._lastInputValue=a;if(n){return}s._inputFilterLabel=a;var r=s._getMathchData(a);if(r){var o=s.getLabel(r);var l=s.get("filter");var h=0;if(l===e.Consts.STRING_FILTER_CONTAINS){h=o.indexOf(a)}else if(l===e.Consts.STRING_FILTER_STARTSWITH){h=o.startsWith(a)}else if(l===e.Consts.STRING_FILTER_ENDSWITH){h=o.endsWith(a)}this.input.value=o.substring(h);d.setSelectionRange(this.input,a.length,o.length);s.setPreSelectData(r);s.setHoverData(r);s.invalidateView();s.open();s.validate();f.setPopupPosition(s._dropDownView,s._popupDiv,s.get("direction"))}else{s.setPreSelectData(null);if(d.isTextSelected(this.input)){d.setSelectionRange(this.input,a.length,0)}s.close()}console.log("input")},addDropDownViewListener:function(e){if(!this.__dropDownViewListenerMap.hasOwnProperty(e)){this.__dropDownViewListenerMap[e]=true;s.on(this.dropDownView,e,this["handle_dropdown_"+e],this)}},removeDropDownViewListener:function(e){if(this.__dropDownViewListenerMap.hasOwnProperty(e)){delete this.__dropDownViewListenerMap[e];DomEventManager.removeListener(this.dropDownView,e,this["handle_dropdown_"+e],this)}},add:function(){oe.superClass.add.apply(this,arguments);var e=this.getDropDownViewEventTypes();o(e,function(e){this.addDropDownViewListener(e)},this)},remove:function(){oe.superClass.add.apply(this,arguments);i._eachObject(this.__dropDownViewListenerMap,function(e){this.removeDropDownViewListener(e)},this);this.__dropDownViewListenerMap={}},update:function(){oe.superClass.update.apply(this,arguments);if(this.view.isOpen()){if(this.__hasWindowMouseDownEvent!==true){this.__hasWindowMouseDownEvent=true;i.callLater(function(){this.addWindowListener("mousedown")},100,this)}}else{if(this.__hasWindowMouseDownEvent===true){this.removeWindowListener("mousedown");this.__hasWindowMouseDownEvent=false}}},getDropDownViewEventTypes:function(){return["mousedown","mouseenter","mouseleave"]},handle_dropdown_mouseenter:function(e){t.addClass(this.dropDownView,"z-state-hover")},handle_dropdown_mouseleave:function(e){t.removeClass(this.dropDownView,"z-state-hover")},handle_dropdown_mousedown:function(e){if(e.which!==1){return}var t=this.view;if(t.get("disabled")===true){return}var i=t.get("input")===true;if(i){if(s.isTargetOn(t._dropDownSpan,e)){this.view.open()}else{this.input.focus()}}else{this.view.open()}},handle_window_mousedown:function(e){if(!s.isTargetOn(this.view._getPopupDiv(),e)){this.view.close()}}});var le=function(){this._initDropDown();le.superClass.constructor.apply(this,arguments);this._updateDropDownArrow();this.setInteractors([new oe(this),new j(this)])};e.extend(le,e.ListView,{___zdefaults_:i.extend({},re),afterSetProperty:function(e,t,i){le.superClass.afterSetProperty.apply(this,arguments);if(e==="direction"){this._updateDropDownArrow()}else if(e==="input"){this._updateInput(t)}else if(e==="placeholder"){this._updatePlaceholder(t)}else if(e==="selectable"||e==="check_visible"){this._updateMulti()}},_onSelectChange:function(){le.superClass._onSelectChange.apply(this,arguments);this.__onDropDownValueChange()},_onCheckChange:function(){le.superClass._onCheckChange.apply(this,arguments);this.__onDropDownValueChange(true)}});i.extendClassPrototype(le,ne);e.DropDownList=function(){e.DropDownList.superClass.constructor.apply(this,arguments)};e.extend(e.DropDownList,le,{});var he=function(){this._initDropDown();he.superClass.constructor.apply(this,arguments);this._updateDropDownArrow();this.setInteractors([new oe(this),new q(this)])};e.extend(he,e.Tree,{___zdefaults_:i.extend({"expand-on-open":true},re),afterSetProperty:function(e,t,i){le.superClass.afterSetProperty.apply(this,arguments);if(e==="direction"){this._updateDropDownArrow()}},_onBatchSelectChange:function(){le.superClass._onBatchSelectChange.apply(this,arguments);this.__onDropDownValueChange()},_onCheckChange:function(){le.superClass._onCheckChange.apply(this,arguments);this.__onDropDownValueChange(true)}});i.extendClassPrototype(he,ne);e.DropDownTree=function(){e.DropDownTree.superClass.constructor.apply(this,arguments)};e.extend(e.DropDownTree,he,{__onOpen:function(){e.DropDownTree.superClass.__onOpen.apply(this,arguments);if(this.get("expand-on-open")!==false){this.expandAll()}}});var _e=function(){this._initDropDown();_e.superClass.constructor.apply(this,arguments);this._updateDropDownArrow();this.setInteractors([new oe(this),new se(this)])};e.extend(_e,e.Calendar,{___zdefaults_:i.extend({},re,{popup_width:"auto"}),afterSetProperty:function(e,t,i){_e.superClass.afterSetProperty.apply(this,arguments);if(e==="direction"){this._updateDropDownArrow()}},_onDateChange:function(e,t){_e.superClass._onDateChange.apply(this,arguments);this.__onDropDownSelectChange()}});i.extendClassPrototype(_e,ne);e.DatePicker=function(){e.DatePicker.superClass.constructor.apply(this,arguments)};e.extend(e.DatePicker,_e,{__isCheckType:function(){return false},getDropDownSelection:function(){return this.getSelectDate()},_onValueChange:function(e){var t="";if(e){if(this.__isMulti()){}else{t=this._getDateLabel(e)}}this._input.value=t}});var de=function(){this.tbody=a.create("tbody");this.__columns=new e.List;this.__hasColumns=false;de.superClass.constructor.apply(this,arguments);this._table.appendChild(this.tbody);this.__setViewCSS_Obj({height:"",width:"",overflow:"","box-sizing":""})};e.extend(de,M,{___zdefaults_:{validate_not_in_dom:true},getRendererClass:function(){return ce},getRendererRootContainer:function(){return this.tbody},getRendererContainer:function(){return this.tbody},isCheckColumn:function(e){return false},setColumns:function(e){this.__columns=e;this.__hasColumns=this.__columns.size()>0;this.updateColGroup();this.invalidateView()},hasColumns:function(){return this.__hasColumns},getColumns:function(){return this.__columns},updateColGroup:function(){t.empty(this._tableColGroup);var e=0;if(this.__hasColumns){this.__columns.each(function(i){var s=a.create("col");var n=parseFloat(i.get("width"));if(n>0){e+=n;t.setCSS(s,"width",n+"px")}this._tableColGroup.appendChild(s)},this)}this.__colGroupWidth=e},__disable:function(){this.setProvider(new e.Provider);this.removeFromParent()},__enable:function(e,t,i){this.setProvider(e);if(i===true){d.insertFirst(t,this.getView())}else{t.appendChild(this.getView())}this.update()},_hasColumnClientSorted:function(){},_getClientSortColumns:function(){},_getSortDataList:function(){},getColumnSortOrder:function(){},__addRenderer:function(e,t){if(!this._hasColumnClientSorted()){return de.superClass.__addRenderer.apply(this,arguments)}var i=t.getRenderElement();if(i){var s=this._getSortDataList();var a=s.size();var n=s.indexOf(s);var r;for(var o=n+1;o<a;o++){var l=s.get(o);var h=this.__getAppendedRendererElement(l);if(h){r=h;break}}if(r){r.parentNode.insertBefore(i,r)}else{return de.superClass.__addRenderer.apply(this,arguments)}}},__getAppendedRendererElement:function(e){var t=this.getRenderer(e);if(t){var i=t.getRenderElement();if(i.parentNode){return i}}return null},__addRenderByOrder:function(e,t){this.__grc(e).appendChild(t.getRenderElement())},__reorderRender:function(){t.empty(this.getRendererRootContainer());var e=this._getSortDataList();e.each(function(e){var t=this.getRenderer(e);if(t){this.__addRenderByOrder(e,t)}},this)},__initAllRenderer:function(){if(!this._hasColumnClientSorted()){return de.superClass.__initAllRenderer.apply(this,arguments)}var e=this._getSortDataList();e.each(function(e){var t=this.createRenderer(e);if(t){this.__rendererMap[e.id()]=t;this.__addRenderByOrder(e,t)}},this)},__getCellValue:function(e,t){}});var ce=function(){ce.superClass.constructor.apply(this,arguments)};e.extend(ce,R,{validate:function(){this.columns=this.view.getColumns();if(this.columns.size()>0){ce.superClass.validate.apply(this,arguments)}},validateDataProperty:function(e,t){this._oldDataCheckable=this.dataCheckable;this._oldDataChecked=this.dataChecked;this._oldDataCheckVisible=this.dataCheckVisible;ce.superClass.validateDataProperty.apply(this,arguments);this.dataCheckVisible=e.__isCheckVisible_(t);if(this.dataCheckVisible){this.dataChecked=e.isChecked(t);this.dataCheckable=e.isCheckable(t)}},validateRenderer:function(e,i){ce.superClass.validateRenderer.apply(this,arguments);this.__setRenderCSS("height","");t.empty(this.renderer);if(this.columns){this.columns.each(function(t){var s=a.create("td");if(t.render){t.render(s,i,t,e,this.renderer)}else{var n=e.__getCellValue(i,t,e,s,this.renderer);if(n!=null){De.render(s,e,i,t,n)}}this.addToRenderer(s)},this)}},_updateState:function(){ce.superClass._updateState.apply(this,arguments);if(this._oldDataCheckVisible!==this.dataCheckVisible||this._oldDataChecked!==this.dataChecked){var e=this._oldDataCheckVisible&&this._oldDataChecked;var t=false;var i=false;if(this.dataCheckVisible){if(this.dataChecked){if(!e){t=true}}else{i=true}}else{i=true}i=e&&i;if(t){g.addCheckedState(this.renderer)}else if(i){g.removeCheckedState(this.renderer)}}}});var ue=function(){this.__initHover();this.__initPreSelect();this._initCheck();ue.superClass.constructor.apply(this,arguments)};e.extend(ue,e.IDataView,{_onSelectChange:function(){e.ListView.superClass._onSelectChange.apply(this,arguments);if(this.get("clear_check_on_select")!==false){if(this.__isCheckChanging!==true){this.__isSelectChange=true;this.clearCheck();this.__isSelectChange=false}}},_onDataRemove:function(e){ue.superClass._onDataRemove.apply(this,arguments);this.__removeHover(e,false);this.__removePreSelect(e,false);if(this.isChecked(e)){this.__justUnCheck(e)}},_onDataClear:function(){ue.superClass._onDataClear.apply(this,arguments);this.__clearHover(false);this.__clearPreSelect(false);this.__justClearCheck()},_onSetProvider:function(){ue.superClass._onSetProvider.apply(this,arguments);this.__clearHover(false);this.__clearPreSelect(false);this.__justClearCheck()},_onBatchSelectChange:function(){var e=ue.superClass._onBatchSelectChange;if(e){e.apply(this,arguments)}this.setPreSelectData(null)},__isCheckVisible_:function(e){if(!this.get("check_visible")){return false}if(this.containsData(e)===false){return false}if(this.isCheckVisible(e)===false){return false}return true}});i.extendClassPrototype(ue,x);i.extendClassPrototype(ue,z);i.extendClassPrototype(ue,b);var fe=function(){this.__scrollBarWidth=d.getScrollBarWidth();this.__syncRowHeightDataMap={};this.lockTBody=this.__createTBody();this.scrollTBody=this.__createTBody();this._lockTBodyView=this.lockTBody.getView();this._scrollTBodyView=this.scrollTBody.getView();this._expander=a.create("div","z-expander");fe.superClass.constructor.apply(this,arguments);this.__addViewClass("z-body");if(this.get("scrollable")===true){this.__addWheelHandler()}this.setInteractors([new pe(this)]);this.__addViewClass("z-widget")};e.extend(fe,ue,{___zdefaults_:{scrollable:true,user_select:true,hoverable:true,selectable:e.Consts.SELECTABLE_SINGLE},setProvider:function(e){fe.superClass.setProvider.apply(this,arguments);if(this.__hasScrollColumn===true){this.scrollTBody.setProvider(e)}if(this.__hasLockColumn===true){this.lockTBody.setProvider(e)}},getDataAt:function(e){if(this.__hasScrollColumn){return this.scrollTBody.getDataAt(e)}if(this.__hasLockColumn){return this.lockTBody.getDataAt(e)}return null},afterSetProperty:function(e,t,i){fe.superClass.afterSetProperty.apply(this,arguments);if(e==="scrollable"){if(t===true){this.__addWheelHandler()}else{this.__removeWheelHandler()}}else if("user_select"===e){if(t===true){this.__addViewClass("z-user-select-none")}else{this.__removeViewClass("z-user-select-none")}}},__createTBody:function(e){var t=this;var s={__validateData:function(e){de.prototype.__validateData.apply(this,arguments);t.__syncRowHeightDataMap[e.id()]=true;t.__needSyncRowHeight=true},validate:function(){t.__needSyncRowHeight=false;de.prototype.validate.apply(this,arguments);if(t.__needSyncRowHeight===true){t.syncTBodies();t.__syncRowHeightDataMap={}}}};var a=["_hasColumnClientSorted","_getClientSortColumns","getColumnSortOrder","_getSortDataList","__isVisible_","__getCellValue","isHover","isPreSelect","isDisabled","__isCheckVisible_","isCheckColumn","isCheckVisible","isChecked","isCheckable"];o(a,function(e){s[e]=function(){return t[e].apply(t,arguments)}});return new de(i.extend(s,e))},isColumnLocked:function(e){return e.get("locked")===true},_hasColumnClientSorted:function(){return false},_getClientSortColumns:function(){},getColumnSortOrder:function(e){},_getSortDataList:function(){if(!this._sortDataList){this._sortDataList=Se.getSortDataList(this,this._getClientSortColumns())}return this._sortDataList},_getDataIndex:function(e){var t=this._getSortDataList();return t.indexOf(e)},__getCellValue:function(e,t){return this.getCellValue(e,t)},getCellValue:function(e,t){var i=t.get("field");if(i){return e.get(i)||""}return""},_onModelChange:function(){this._sortDataList=null;fe.superClass._onModelChange.apply(this,arguments)},_onViewChange:function(){this._sortDataList=null;fe.superClass._onViewChange.apply(this,arguments)},_onColumnSortChange:function(){this._sortDataList=null;this.__invalidateTBodyView();if(this.__hasLockColumn){this.lockTBody.__reorderRender()}if(this.__hasScrollColumn){this.scrollTBody.__reorderRender()}},__invalidateTBodyView:function(){this.invalidateView();this.lockTBody.invalidateView();this.scrollTBody.invalidateView()},_onSelectChange:function(){fe.superClass._onSelectChange.apply(this,arguments);if(this.get("clear_check_on_select")!==false){if(this.__isCheckChanging!==true){this.__isSelectChange=true;this.clearCheck();this.__isSelectChange=false}}},__onCheck:function(e){fe.superClass.__onCheck.apply(this,arguments);if(this.__hasLockColumn){this.lockTBody.invalidateData(e)}if(this.__hasScrollColumn){this.scrollTBody.invalidateData(e)}},__onUnCheck:function(e){fe.superClass.__onUnCheck.apply(this,arguments);if(this.__hasLockColumn){this.lockTBody.invalidateData(e)}if(this.__hasScrollColumn){this.scrollTBody.invalidateData(e)}},isCheckColumn:function(e){return false},setColumns:function(t){this.__columns=t;var i=new e.List;var s=new e.List;this.__columns.each(function(e){if(this.isColumnLocked(e)){i.add(e)}else{s.add(e)}},this);this.lockTBody.setColumns(i);this.scrollTBody.setColumns(s);this.__hasLockColumn=this.lockTBody.hasColumns();this.__hasScrollColumn=this.scrollTBody.hasColumns();this.__updateTBodiesByColumn();this._updateSyncScrollListener()},__updateTBodiesByColumn:function(){if(this.__hasLockColumn==false){this.lockTBody.__disable()}else{this.lockTBody.__enable(this.getProvider(),this.getView(),true)}if(this.__hasScrollColumn==false){this.scrollTBody.__disable()}else{this.scrollTBody.__enable(this.getProvider(),this.getView())}if(this.__hasLockColumn==false||this.__hasScrollColumn==false){this.lockTBody.__removeViewClass("z-locked");this.scrollTBody.__removeViewClass("z-scrollable")}else{this.lockTBody.__addViewClass("z-locked");this.scrollTBody.__addViewClass("z-scrollable")}this.updateTBodiesSize()},__addWheelHandler:function(){if(this.__addWheelHandlerFlag!==true){s.on(this._lockTBodyView,"wheel",this.__handleTBodyWheel,this);s.on(this._scrollTBodyView,"wheel",this.__handleTBodyWheel,this);this.__addWheelHandlerFlag=true}},__removeWheelHandler:function(){if(this.__addWheelHandlerFlag===true){this.__addWheelHandlerFlag=false;s.off(this._lockTBodyView,"wheel",this.__handleTBodyWheel,this);s.off(this._scrollTBodyView,"wheel",this.__handleTBodyWheel,this)}},__handleTBodyWheel:function(t){t.preventDefault();var i=e._iu_.isWheelDown(t);var s=26*(i?1:-1);if(this.__hasScrollColumn){this._scrollTBodyView.scrollTop+=s;return}if(this.__hasLockColumn){this._lockTBodyView.scrollTop+=s}},__addSyncTBodiesScrollListener:function(){if(this.__hasSyncTBodiesScrollListener!==true){s.on(this._scrollTBodyView,"scroll",this._handleSyncTBodiesScrollChange,this);this.__hasSyncTBodiesScrollListener=true}},__removeSyncTBodiesScrollListener:function(){if(this.__hasSyncTBodiesScrollListener===true){this.__hasSyncTBodiesScrollListener=false;s.off(this._scrollTBodyView,"scroll",this._handleSyncTBodiesScrollChange,this)}},_handleSyncTBodiesScrollChange:function(e){this._lockTBodyView.scrollTop=this._scrollTBodyView.scrollTop},__addLockSyncTHeaderScrollListener:function(){if(this.__hasLockSyncTHeaderScrollListener!==true){this.__hasLockSyncTHeaderScrollListener=true;this._lockTBodyViewLastScrollLeft=null;s.on(this._lockTBodyView,"scroll",this._handleSyncTHeaderScrollChange,this)}},__removeLockSyncTHeaderScrollListener:function(){if(this.__hasLockSyncTHeaderScrollListener===true){this.__hasLockSyncTHeaderScrollListener=false;s.off(this._lockTBodyView,"scroll",this._handleSyncTHeaderScrollChange,this)}},__addScrollSyncTHeaderScrollListener:function(){if(this.__hasScrollSyncTHeaderScrollListener!==true){this.__hasScrollSyncTHeaderScrollListener=true;this._scrollTBodyViewLastScrollLeft=null;s.on(this._scrollTBodyView,"scroll",this._handleSyncTHeaderScrollChange,this)}},__removeScrollSyncTHeaderScrollListener:function(){if(this.__hasScrollSyncTHeaderScrollListener===true){this.__hasScrollSyncTHeaderScrollListener=false;s.off(this._scrollTBodyView,"scroll",this._handleSyncTHeaderScrollChange,this)}},_handleSyncTHeaderScrollChange:function(e){var t;if(this.__hasLockSyncTHeaderScrollListener){t=this._lockTBodyView.scrollLeft;if(this._lockTBodyViewLastScrollLeft===t){return}this._lockTBodyViewLastScrollLeft=t}if(this.__hasScrollSyncTHeaderScrollListener){t=this._scrollTBodyView.scrollLeft;if(this._scrollTBodyViewLastScrollLeft===t){return}this._scrollTBodyViewLastScrollLeft=t}if(this._onBodyScrollChange){this._onBodyScrollChange(e)}},_onBodyScrollChange:function(e){},_updateSyncScrollListener:function(){if(this.__hasLockColumn&&this.__hasScrollColumn){this.__addSyncTBodiesScrollListener();this.__addScrollSyncTHeaderScrollListener();this.__removeLockSyncTHeaderScrollListener();return}this.__removeSyncTBodiesScrollListener();if(this.__hasLockColumn){this.__addLockSyncTHeaderScrollListener()}else{this.__removeLockSyncTHeaderScrollListener()}if(this.__hasScrollColumn){this.__addScrollSyncTHeaderScrollListener()}else{this.__removeScrollSyncTHeaderScrollListener()}},syncTBodies:function(){if(this.__hasLockColumn&&this.__hasScrollColumn){this.__syncExpanderAndRowHeight()}else if(this.__hasLockColumn||this.__hasScrollColumn){this.callBatch("__syncExpanderFlag",this.__syncExpander,this)}},__syncExpanderAndRowHeight:function(){this.__syncRowHeight();this.callBatch("__syncExpanderFlag",this.__syncExpander,this)},__syncExpander:function(){if(this.__hasVisibleData()){if(this._expander.parentNode){t.remove(this._expander);t.setCSS(this._expander,"width","")}}else{if(this.__hasScrollColumn){t.setCSS(this._expander,"width",this.scrollTBody.__colGroupWidth+"px");this._scrollTBodyView.appendChild(this._expander);return}if(this.__hasLockColumn){t.setCSS(this._expander,"width",this.lockTBody.__colGroupWidth+"px");this._lockTBodyView.appendChild(this._expander)}}},__syncRowHeight:function(){var e=0;this.eachVisibleData(function(i){if(this.__syncRowHeightDataMap.hasOwnProperty(i.id())){var s=this.lockTBody.getRenderElement(i);var a=this.scrollTBody.getRenderElement(i);if(s&&a){e++;var n=s.clientHeight;var r=a.clientHeight;if(r>n){t.setCSS(s,"height",r+"px")}else if(r<n){t.setCSS(a,"height",n+"px")}}}},this);console.log(e)},__hasVisibleData:function(){var e=false;this.eachData(function(t){if(this.__isVisible_(t)){e=true;return false}},this);return e},updateTBodiesSize:function(){this.callBatch("__updateTBodiesSize",this._updateTBodiesSize,this)},_updateTBodiesSize:function(){var e=0;if(this.__hasLockColumn&&this.__hasScrollColumn){this.lockTBody.__setViewCSS("overflow","hidden");this.lockTBody.__setViewCSS("width",this.lockTBody.__colGroupWidth+"px");e=Math.max(this.getView().clientWidth-this._lockTBodyView.offsetWidth-2,0);this.scrollTBody.__setViewCSS("width",e+"px");this.__updateTBodiesHeight(e);return}this.__updateTBodiesHeight(e);if(this.__hasLockColumn){this.lockTBody.__setViewCSS_Obj({overflow:"",width:""})}if(this.__hasScrollColumn){this.scrollTBody.__setViewCSS("width","")}},__updateTBodiesHeight:function(e){if(this.__isScrollable()){var t=this.getView().clientHeight;if(this.__hasScrollColumn){this.scrollTBody.__setViewCSS("height",t+"px")}if(this.__hasLockColumn&&this.__hasScrollColumn){if(this.scrollTBody.__colGroupWidth>e-this.__scrollBarWidth){this.lockTBody.__setViewCSS("height",t-this.__scrollBarWidth+"px")}else{this.lockTBody.__setViewCSS("height",t+"px")}}else{if(this.__hasLockColumn){this.lockTBody.__setViewCSS("height",t+"px")}}}else{if(this.__hasLockColumn){this.lockTBody.__setViewCSS("height","")}if(this.__hasScrollColumn){this.scrollTBody.__setViewCSS("height","")}}},__isScrollable:function(){return this.get("scrollable")!==false},__onHover:function(e,t){if(this.__hasLockColumn){this.lockTBody.invalidateData(e)}if(this.__hasScrollColumn){this.scrollTBody.invalidateData(e)}},__onPreSelect:function(e,t){if(this.__hasLockColumn){this.lockTBody.invalidateData(e)}if(this.__hasScrollColumn){this.scrollTBody.invalidateData(e)}}});var pe=function(){pe.superClass.constructor.apply(this,arguments)};e.extend(pe,I,{});var ve=function(){ve.superClass.constructor.apply(this,arguments)};e.extend(ve,M,{});i.extendClassPrototype(ve,P);i.extendClassPrototype(ve,b);var ge=function(){this.thead=a.create("thead");this.__trList=new e.List;ge.superClass.constructor.apply(this,arguments);this._table.appendChild(this.thead);this.__setViewCSS_Obj({height:"",width:"",overflow:"","box-sizing":""})};e.extend(ge,ve,{___zdefaults_:{validate_not_in_dom:true},hasColumns:function(){return _.hasLeafChildren(this)},__isVisible_:function(e){var t=ge.superClass.__isVisible_.apply(this,arguments);if(t===false){return t}if(this.__isLeafChildrenVisible(e)){return t}return false},__isLeafChildrenVisible:function(e){var t=this.isLeaf(e);if(!t){var i=_.getLeafChildren(this,e).size();if(i===0){return false}}return true},getRendererClass:function(){return Ce},getRendererRootContainer:function(){return this.thead},getRendererContainer:function(e){var t=this.getLevel(e,this.__getRootData());return this.__trList.get(t)},_onModelChange:function(e){if(!e){this.__rebuildRow()}this.__updateColGroup();ge.superClass._onModelChange.apply(this,arguments)},__initAllRenderer:function(){this.__rebuildRow();ge.superClass.__initAllRenderer.apply(this,arguments)},__rebuildRow:function(){var e=this.__calcRowCount();t.empty(this.thead);this.__trList.clear();for(var i=0;i<e;i++){var s=a.create("tr");this.thead.appendChild(s);this.__trList.add(s)}this.__rowCount=e;this.eachData(function(e){var t=this.getRenderer(e);if(t){this.__addRenderer(e,t)}},this)},__calcRowCount:function(){var e=0;var t=this.__getRootData();this.eachData(function(i){e=Math.max(e,this.getLevel(i,t))},this);return e+1},__updateColGroup:function(){t.empty(this._tableColGroup);var e=0;this.hEachData(function(i){if(this.__isVisible_(i)&&this.isLeaf(i)){var s=a.create("col");var n=parseFloat(i.get("width"));if(n>0){e+=n;t.setCSS(s,"width",n+"px")}this._tableColGroup.appendChild(s)}},this);this.__colGroupWidth=e}});var Ce=function(){this.renderer=a.create("th");this._itemDiv=a.create("div","z-in");this._itemElementsMap={};Ce.superClass.constructor.apply(this,arguments);this.addToRenderer(this._itemDiv)};e.extend(Ce,e.ElementRenderer,{validateViewProperty:function(e){Ce.superClass.validateViewProperty.apply(this,arguments);this.viewRowCount=e.__rowCount;this.viewItemOrder=["check","icon","label","sort","info","menu"]},validateDataProperty:function(e,t){this._oldDataSortable=this.dataSortable;this._oldDataSortOrder=this._dataSortOrder;this._oldDataMenu=this.dataMenu;this._oldDataIsLeaf=this.dataIsLeaf;this._oldIsCheckColumn=this._isCheckColumn;this._oldIsCheckColumnSelect=this._isCheckColumnSelect;Ce.superClass.validateDataProperty.apply(this,arguments);this._isCheckColumn=e.isCheckColumn(t);if(this._isCheckColumn){this._isCheckColumnSelect=e._isCheckColumnSelect()}this.dataSortable=e.isColumnSortable(t);if(this.dataSortable===true){this._dataSortOrder=e.getColumnSortOrder(t)}else{this._dataSortOrder=null}this.dataIsLeaf=e.isLeaf(t);this.rowSpan=0;this.colSpan=0;this.dataMenu=false;if(this.dataIsLeaf){this.dataLevel=e.getLevel(t,e.__getRootData());this.rowSpan=this.viewRowCount-this.dataLevel;this.dataMenu=e.isColumnMenuVisible(t)}else{this.colSpan=_.getLeafChildren(e,t).size()}},validateRenderer:function(e,i){Ce.superClass.validateRenderer.apply(this,arguments);this.__setRenderCSS("height","");if(this._oldDataIsLeaf!==this.dataIsLeaf){if(this.dataIsLeaf){t.addClass(this.renderer,"z-leaf")}else{t.removeClass(this.renderer,"z-leaf")}}this._updateRowColSpan();if(this.dataLabel){this.__addItemElement_("label",this.getDLabelSpan());if(this.dataLabel!==this._dlabelSpan.innerHTML){this._dlabelSpan.innerHTML=this.dataLabel}}else{this.__removeItemElement_("label",this._dlabelSpan)}if(this._oldDataSortable!==this.dataSortable){if(this.dataSortable){t.addClass(this.renderer,"z-sortable")}else{t.removeClass(this.renderer,"z-sortable")}}if(this._oldDataSortOrder!=this._dataSortOrder){if(this._dataSortOrder==="asc"){this.__addItemElement_("sort",this.getDSortSpan());t.setClass(this._dsortSpan,"z-sort z-widget-sprite z-ws-i-arrow-n")}else if(this._dataSortOrder==="desc"){this.__addItemElement_("sort",this.getDSortSpan());t.setClass(this._dsortSpan,"z-sort z-widget-sprite z-ws-i-arrow-s")}else{this.__removeItemElement_("sort",this._dsortSpan)}}if(this._oldDataMenu!==this.dataMenu){if(this.dataMenu){this.__addItemElement_("menu",this.getDMenuSpan())}else{this.__removeItemElement_("menu",this._dmenuSpan)}}if(this._oldIsCheckColumn!==this._isCheckColumn){if(this._isCheckColumn){this.__addItemElement_("check",this.getDCheckSpan());this.__addRenderClass("z-check-column")}else{this.__removeItemElement_("check",this._dcheckSpan);this.__removeRenderClass("z-check-column")}}if(this._isCheckColumn){this.__updateCheckValue()}},__updateCheckValue:function(){if(this._oldIsCheckColumnSelect!==this._isCheckColumnSelect){if(this._isCheckColumnSelect){t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox-checked")}else{t.setClass(this._dcheckSpan,"z-check-icon z-widget-sprite z-ws-checkbox")}}},_updateRowColSpan:function(){if(this.rowSpan===0){t.removeAttr(this.renderer,"rowspan")}else{t.setAttr(this.renderer,"rowspan",this.rowSpan)}if(this.colSpan===0){t.removeAttr(this.renderer,"colspan")}else{t.setAttr(this.renderer,"colspan",this.colSpan)}},getDCheckSpan:function(){if(!this._dcheckSpan){this._dcheckSpan=a.create("span");this._dcheckSpan.dtype="check"}return this._dcheckSpan},getDLabelSpan:function(){if(!this._dlabelSpan){this._dlabelSpan=a.create("span","z-label");this._dlabelSpan.dtype="label"}return this._dlabelSpan},getDSortSpan:function(){if(!this._dsortSpan){this._dsortSpan=a.create("span","z-sort");this._dsortSpan.dtype="sort"}return this._dsortSpan},getDMenuSpan:function(){if(!this._dmenuSpan){this._dmenuSpan=a.create("span","z-menu z-widget-sprite z-ws-i-arrowhead-s");this._dmenuSpan.dtype="menu"}return this._dmenuSpan},__addItemElement_:function(e,t){var i=this.viewItemOrder;var s=this._itemElementsMap;var a=null;for(var n=i.length-1;n>=0;n--){var r=i[n];if(r===e){if(t.parentNode){if(t.nextSibling!==a){this._itemDiv.insertBefore(t,a)}}else{this._itemDiv.insertBefore(t,a);s[r]=t}return}else{if(s[r]){a=s[r]}}}},__removeItemElement_:function(e,t){if(t&&t.parentNode){t.parentNode.removeChild(t);this._itemElementsMap[e]=null}}});var me=function(){this.__scrollBarWidth=d.getScrollBarWidth();this.__columnSortOrderMap={};this.__columnSortList=new e.List;var t=this;this.lockTHeader=this.__createTHeader({__isVisible_:function(e){if(!t.isColumnLocked(e)){return false}if(!this.__isLeafChildrenVisible(e)){return false}return t.__isVisible_(e)}});this.scrollTHeader=this.__createTHeader({__isVisible_:function(e){if(t.isColumnLocked(e)){return false}if(!this.__isLeafChildrenVisible(e)){return false}return t.__isVisible_(e)}});this._lockTHeaderView=this.lockTHeader.getView();this._scrollTHeaderView=this.scrollTHeader.getView();me.superClass.constructor.apply(this,arguments);this.__addViewClass("z-header");this.lockTHeader.__addViewClass("z-locked");this.scrollTHeader.__addViewClass("z-scrollable");var i=this.getView();this.lockTHeader.appendTo(i);this.scrollTHeader.appendTo(i);this.__setViewCSS("padding-right",this.__scrollBarWidth+"px");this.setInteractors([new we(this)])};e.extend(me,e.IDataView,{afterSetProperty:function(e,t,i){me.superClass.afterSetProperty.apply(this,arguments);if(e==="check_column_select"){if(this.__hasLockColumn){this.lockTHeader.invalidateView()}else if(this.__hasScrollColumn){this.scrollTHeader.invalidateView()}this.__onCheckColumnSelect(t)}},__onCheckColumnSelect:function(e){},__createTHeader:function(e){var t=this;var s={validate:function(){ge.prototype.validate.apply(this,arguments);t.syncTHeaders()}};var a=["isColumnSortable","isColumnMultipleSortable","isColumnMenuVisible","getColumnSortOrder","isCheckColumn","_isCheckColumnSelect"];o(a,function(e){s[e]=function(){return t[e].apply(t,arguments)}});return new ge(i.extend(s,e))},_isCheckColumnSelect:function(){return this.get("check_column_select")===true},isCheckColumn:function(e){return false},isColumnLocked:function(e){return e.get("locked")===true},isColumnSortable:function(e){return e.get("sortable")===true},isColumnMultipleSortable:function(e){return false},isColumnMenuVisible:function(e){if(this.get("column_menu")!==true){return false}return e.get("menu")!==false},onColumnMenuSelect:function(e,t,i,s){},isColumnVisible:function(e){},_showColumn:function(e){},_showAllColumn:function(){},_hideColumn:function(e){},__getVisibleColumnCount:function(){},isClientSortColumn:function(e){return false},_getClientSortColumns:function(){var e=this.__columnSortList.filter(function(e){if(this.isClientSortColumn(e)){return true}},this);return e},_hasColumnClientSorted:function(){var e=false;this.__columnSortList.each(function(t){if(this.isClientSortColumn(t)){e=true;return false}},this);return e},_hasColumnSorted:function(){return this.__columnSortList.size()>0},getColumnSortOrder:function(e){return this.__getColumnSortOrder(e)},__getColumnSortOrder:function(e){return this.__columnSortOrderMap[e.id()]},_onDataRemove:function(e){this.__sortColumn(e,false);me.superClass._onDataRemove.apply(this,arguments)},clearColumnSort:function(){this.__clearColumnSort()},__clearColumnSort:function(){if(this.__columnSortList.size()>0){this.__columnSortOrderMap={};this.__columnSortList.clear();this.__invalidateTHeadView()}},__sortColumn:function(e,t,i){var s=e.id();if(t){if(this.__columnSortOrderMap[s]===t){return}if(i!==true){if(this.__columnSortList.size()>0){this.__columnSortOrderMap={};this.__columnSortList.clear()}}else{if(this.__columnSortOrderMap.hasOwnProperty(s)){this.__columnSortList.remove(e)}}this.__columnSortOrderMap[s]=t;this.__columnSortList.add(e)}else{if(this.__columnSortOrderMap.hasOwnProperty(s)){delete this.__columnSortOrderMap[s];this.__columnSortList.remove(e)}else{return}}this.__callDBMethod("onColumnSortChange",[e,t,i]);this.__invalidateTHeadView()},__invalidateTHeadView:function(){this.invalidateView();if(this.__hasLockColumn){this.lockTHeader.invalidateView()}if(this.__hasScrollColumn){this.scrollTHeader.invalidateView()}},_onColumnSortChange:function(e,t,i){},onColumnSortChange:function(e,t,i){},getSortColumns:function(){return this.__columnSortList},getDataAt:function(e){if(this.__hasScrollColumn){return this.scrollTHeader.getDataAt(e)}if(this.__hasLockColumn){return this.lockTHeader.getDataAt(e)}return null},_getColumnMenuItems:function(t){var i=new e.Provider;var s=this.getColumnMenuItems(t);if(s){i.add(s)}return i},getColumnMenuItems:function(e){},hEachLeafData:function(e,t){this.hEachData(function(i){if(this.__isVisible_(i)&&this.__isHLeaf(i)){if(e.apply(t,[i])===false){return false}}},this)},__isHLeaf:function(e){if(!e.hasChildren()){return true}var t=e.getChildren(false);var i=t.size();for(var s=0;s<i;s++){var a=t.get(s);

    if(this.containsData(a)){return false}}return true},isLeaf:function(e){if(!e.hasChildren()){return true}var t=e.getChildren(false);var i=t.size();for(var s=0;s<i;s++){var a=t.get(s);if(this.__isLeafVisible(a)){return false}}return true},__isLeafVisible:function(e){if(this.containsData(e)==false){return false}return this.isVisible(e)!==false},_scroll:function(e){if(this.__hasScrollColumn){this._scrollTHeaderView.scrollLeft=e;this._lockTHeaderView.scrollLeft=0;return}if(this.__hasLockColumn){this._lockTHeaderView.scrollLeft=e}},syncTHeaders:function(){this.__hasLockColumn=this.lockTHeader.hasColumns();this.__hasScrollColumn=this.scrollTHeader.hasColumns();this.callBatch("__syncTHeadersFlag",this.__syncHeaders,this);this.updateHeadersSize()},__syncHeaders:function(){var e=this.getView();if(!this.__hasLockColumn){this.lockTHeader.removeFromParent()}else{d.insertFirst(e,this._lockTHeaderView)}if(!this.__hasScrollColumn){this.scrollTHeader.removeFromParent()}else{e.appendChild(this._scrollTHeaderView)}if(this.__hasLockColumn&&this.__hasScrollColumn){t.setCSS(this._scrollTHeaderView,"border-right-width","");t.setCSS(this._lockTHeaderView,"border-right-width","")}else{t.setCSS(this._lockTHeaderView,"border-right-width",0);t.setCSS(this._scrollTHeaderView,"border-right-width",0)}},updateHeadersSize:function(){this.callBatch("__updateHeadersSizeFlag",this.__updateHeadersSize,this)},__updateHeadersSize:function(){if(this.__hasLockColumn&&this.__hasScrollColumn){this.lockTHeader.__setViewCSS("width",this.lockTHeader.__colGroupWidth+"px");var e=Math.max(this.getView().clientWidth-this._lockTHeaderView.offsetWidth-this.__scrollBarWidth-2,0);this.scrollTHeader.__setViewCSS("width",e+"px");this.__syncRowHeight()}else{this.lockTHeader.__setViewCSS("width","");this.scrollTHeader.__setViewCSS("width","")}},__syncRowHeight:function(){var i=this._lockTHeaderView.offsetHeight;var s=this._scrollTHeaderView.offsetHeight;if(i>0&&s>0){var a=Math.abs(s-i);var n;var r=new e.List;if(s>i){n=this.lockTHeader}else{n=this.scrollTHeader}n.hEachData(function(e){if(n.__isVisible_(e)&&n.isLeaf(e)){var t=n.getRenderElement(e);if(t){r.add({renderer:t,height:t.clientHeight+a+"px"})}}});r.each(function(e){t.setCSS(e.renderer,"height",e.height)})}},setProvider:function(e){me.superClass.setProvider.apply(this,arguments);this.lockTHeader.appendTo(this.view);this.scrollTHeader.appendTo(this.view);this.lockTHeader.setProvider(e);this.scrollTHeader.setProvider(e)}});var we=function(){we.superClass.constructor.apply(this,arguments)};e.extend(we,e.IViewInteractor,{getViewEventTypes:function(){return["click"]},_toggleCheck:function(e){var t=this.view;t.set("check_column_select",!t.get("check_column_select"))},handle_click:function(t){var i=s.getTarget(t);var a=this.view;var n=a.getDataAt(i);if(!this._isDataEnabled(n)){return}if(u.isCheckBoxSpan(i)){this._toggleCheck(n)}else if(u.isMenuSpan(i)){var r=a._getColumnMenuItems(n);if(r.size()<=0){return}var o=false;var l=e.widgets.popupMenu(r,i,{check_visible:true,clear_check_on_select:false,change_check_on_click:true,onCheckChange:function(t,i){e.Menu.prototype.onCheckChange.apply(this,arguments);if(o===true&&t.hasChildren()===false){var s=t.get("column_data");this.invalidateView();if(!i&&a.__getVisibleColumnCount()<=1){return}a.onColumnMenuSelect(s,t,true,i);this.invalidateView()}},isCheckable:function(e){if(this.isChecked(e)){if(a.__getVisibleColumnCount()<=1){return false}}return true},onDataClick:function(e){if(this.isLeaf(e)){a.onColumnMenuSelect(n,e)}},isCheckVisible:function(e){if(e.get("check")===true){return true}return false}});if(l){r.each(function(e){if(e.get("column")===true&&e.get("check")===true&&e.hasChildren()===false){var t=e.get("column_data");if(a.isColumnVisible(t)){l.check(e)}}});o=true}}else if(a.isColumnSortable(n)){var h=a.getColumnSortOrder(n);var _=Se.__getNextSortOrder(h);var d=a.isColumnMultipleSortable(n);a.__sortColumn(n,_,d&&t.ctrlKey)}a.__onDataClick(n,t)}});var Se={parseColumns:function(t){if(t){var s;var a=false;if(i.isArray(t)){s=new e.List(t)}else if(i.isProvider(t)){s=t.getDataList(false);a=true}else if(i.isList(t)){s=t}else if(i.isObject(t)){s=new e.List([t])}if(s){if(!a){if(i.isData(s.get(0))){a=true}if(!a){var n=new e.List;s.each(function(e){Se._createColumn(n,e)});s=n}}return s}}return new e.List},_createColumn:function(t,i,s){var a=i.columns;delete i.columns;var n=new e.Data(i);if(s){n.set("parent",s)}t.add(n);if(a){var r=new e.List(a);r.each(function(e){Se._createColumn(t,e,n)});i.columns=a}},_getColumnMenuItems:function(t){var i=new e.List;var s=new e.Data({column:true,name:e.i18n.getLabel("grid.column_menu.columns")});i.add(new e.Data({column:true,action:"show_all",name:e.i18n.getLabel("grid.column_menu.columns_show_all"),parent:s}));var a={};i.add(s);t.hEachData(function(n){var r=n.clone({parent:false},{column:true,check:true,column_data:n});if(t.isCheckColumn(n)){r.set("name",e.i18n.getLabel("grid.column_menu.columns_check_column")||"")}a[n.id()]=r;var o=n.get("parent");var l;if(o){l=a[o.id()]}else{l=s}r.set("parent",l);i.add(r)});return i},__getNextSortOrder:function(e){if(e==="asc"){return"desc"}else if(e==="desc"){return null}else{return"asc"}},getSortDataList:function(t,s){var a;if(s&&s.size()>0){var n=new e.List;s.each(function(e){var s=e.get("sort_compare");var a=t.getColumnSortOrder(e);if(i.isFunction(s)){n.add({order:a,compare:s})}else{n.add({order:a,compare:Se.__createCompareFunction(t,e)})}});var r=n.size();var o=function(e,t){var i;for(var s=0;s<r;s++){var a=n.get(s);var o=a.compare;var l=a.order;if(l==="desc"){i=-o(e,t)}else{i=o(e,t)}if(i!==0){return i}}return i};a=t.getDataList();a.sort(o)}else{a=t.getDataList(false)}return a},__createCompareFunction:function(e,t){return function(i,s){var a=e.__getCellValue(i,t);var n=e.__getCellValue(s,t);if(a>n){return 1}if(a<n){return-1}return 0}}};var De={render:function(e,i,s,a,n){var r=a.get("value_type");if(i.isCheckColumn(a)){De._createCheckBox(n,e,true);t.addClass(e,"z-check-column");e.dtype="check"}else if(r==="boolean"){De._createCheckBox(n,e)}else if(r==="img"){De._createImg(n,e)}else if(r==="color"){t.setCSS(e,"background-color",n);t.setCSS(e,"color","#FFFFFF");e.innerHTML=n}else{e.innerHTML=n}},_createCheckBox:function(e,i,s){var n=a.create("span");if(s===true){n.dtype="check"}if(e===true){t.setClass(n,"z-boolean z-check-icon z-widget-sprite z-ws-checkbox-checked")}else{t.setClass(n,"z-boolean z-check-icon z-widget-sprite z-ws-checkbox")}return De.__appendChild(n,i)},_createImg:function(i,s){var a=e.dom.create("img","z-img");t.setAttr(a,"src",i);return De.__appendChild(a,s)},_createColorDiv:function(i,s){var a=e.dom.create("div","z-color");t.setCSS(a,"background-color",i);if(i){t.setCSS(a,"color","#FFFFFF");a.innerHTML=i}return De.__appendChild(a,s)},__appendChild:function(e,t){if(t){t.appendChild(e)}return e}};var be={user_select:true,hoverable:true,selectable:true,scrollable:true,check_visible:true};e.Grid=function(){this.__hiddenColumns={};this.__lockedColumns={};var i=this;this.headerView=this._createTHeaderView();this.bodyView=this._createTBodyView();e.Grid.superClass.constructor.apply(this,arguments);var s=this.getView();this.headerView.appendTo(s);this.bodyView.appendTo(s);this.__addViewClass("z-widget");this.__addViewClass("z-grid");t.setAttr(s,"tabindex","0");this.set("auto_resize",true)};e.extend(e.Grid,e.IDataView,{___zdefaults_:{user_select:true,hoverable:true,selectable:e.Consts.SELECTABLE_SINGLE,scrollable:true,striped:false,pageable:true,sort_mode:"multiple",header_visible:true,editable:false,edit_mode:""},invalidateView:function(){e.Grid.superClass.invalidateView.apply(this,arguments);this.headerView.__invalidateTHeadView();this.bodyView.__invalidateTBodyView()},afterSetProperty:function(t,i,s){e.Grid.superClass.afterSetProperty.apply(this,arguments);if(t==="index_visible"||t==="check_visible"){this.__updateColumns()}else if(t==="columns"){this.__setColumns(i,true)}else if(t==="header_visible"){this.__setHeaderVisible(i)}else if(t==="striped"){if(i===true){this.__addViewClass("z-striped")}else{this.__removeViewClass("z-striped")}}if(be.hasOwnProperty(t)){this.bodyView.set(t,i)}},__setHeaderVisible:function(e){if(e===false){this.headerView.__setViewCSS("display","none")}else{this.headerView.__setViewCSS("display","block")}},_createTHeaderView:function(){var e=this;var t={isVisible:function(t){return e.isColumnVisible(t)}};var i=["isColumnSortable","isColumnMultipleSortable","isClientSortColumn","onColumnSortChange","_onColumnSortChange","isColumnLocked","isColumnMenuVisible","getColumnMenuItems","onColumnMenuSelect","isColumnVisible","_showColumn","_hideColumn","__getVisibleColumnCount","isCheckColumn","__onCheckColumnSelect"];o(i,function(i){t[i]=function(){return e[i].apply(e,arguments)}});return new me(t)},isColumnSortable:function(e){return e.get("sortable")===true},isColumnMultipleSortable:function(e){if(this.get("sort_mode")==="multiple"){return true}return false},isColumnMenuVisible:function(e){if(this.get("column_menu")!==true){return false}if(this.isCheckColumn(e)||this.isIndexColumn(e)){return false}return e.get("menu")!==false},isClientSortColumn:function(e){return e.get("sort_type")!=="server"},getColumnSortOrder:function(e){return this.headerView.__getColumnSortOrder(e)},clearColumnSort:function(){return this.headerView.__clearColumnSort()},_hasColumnClientSorted:function(){return this.headerView._hasColumnClientSorted()},_getClientSortColumns:function(){return this.headerView._getClientSortColumns()},getSortColumns:function(){return this.headerView.getSortColumns()},_onColumnSortChange:function(e,t){if(e.get("sort_type")!=="server"){this.bodyView._onColumnSortChange(e,t)}},onColumnSortChange:function(e,t){},getColumnMenuItems:function(t){var i=new e.List;if(this.isColumnSortable(t)){i.add(new e.Data({action:"sort_asc",column_data:t,name:e.i18n.getLabel("grid.column_menu.sort_asc")}));i.add(new e.Data({action:"sort_desc",column_data:t,name:e.i18n.getLabel("grid.column_menu.sort_desc")}))}var s=Se._getColumnMenuItems(this.headerView);i.addAll(s);if(this.isColumnLocked(t)){i.add(new e.Data({action:"unlock",column_data:t,name:e.i18n.getLabel("grid.column_menu.unlock")}))}else{i.add(new e.Data({action:"lock",column_data:t,name:e.i18n.getLabel("grid.column_menu.lock")}))}return i},onColumnMenuSelect:function(e,t,i,s){if(i===true){if(s){this._showColumn(e)}else{this._hideColumn(e)}return}var a=t.get("action");if(a){switch(a){case"sort_asc":this.headerView.__sortColumn(e,"asc",this.isColumnMultipleSortable(e));break;case"sort_desc":this.headerView.__sortColumn(e,"desc",this.isColumnMultipleSortable(e));break;case"lock":this._addLockedColumn(e);break;case"unlock":this._removeLockedColumn(e);break;case"show_all":this._showAllColumn();break}}},isColumnLocked:function(e){return this.__lockedColumns[e.id()]===true},_addLockedColumn:function(e){var t=e.id();if(!this.__lockedColumns.hasOwnProperty(t)){this.__lockedColumns[t]=true;this.__updateColumns()}},_removeLockedColumn:function(e){var t=e.id();if(this.__lockedColumns.hasOwnProperty(t)){delete this.__lockedColumns[t];this.__updateColumns()}},_clearLockedColumn:function(){if(i.isNonEmptyObject(this.__lockedColumns)){this.__lockedColumns={};this.__updateColumns()}},__getVisibleColumnCount:function(){var e=0;this.headerView.hEachLeafData(function(t){if(this.isColumnVisible(t)){e++}},this);return e},isColumnVisible:function(e){return this.__hiddenColumns[e.id()]!==true},_showColumn:function(e){var t=e.id();if(this.__hiddenColumns.hasOwnProperty(t)){delete this.__hiddenColumns[t];this.__updateColumns()}},_showAllColumn:function(){if(i.isNonEmptyObject(this.__hiddenColumns)){this.__hiddenColumns={};this.__updateColumns()}},_hideColumn:function(e){var t=e.id();if(!this.__hiddenColumns.hasOwnProperty(t)){this.__hiddenColumns[e.id()]=true;this.__updateColumns()}},_hideAllColumn:function(){var e=this.headerView.getDataList()},isCheckVisible:function(){return true},__onCheckColumnSelect:function(e){if(e){this.bodyView.checkAll()}else{this.bodyView.clearCheck()}},isCheckColumn:function(e){return e===this.__checkColumn},isIndexColumn:function(e){return e===this.__indexColumn},_getIndexColumn:function(){if(this.__indexColumn==null){this.__indexColumn=new e.Data({name:"#",width:40,locked:true})}return this.__indexColumn},_getCheckColumn:function(){if(this.__checkColumn==null){this.__checkColumn=new e.Data({width:60,locked:true,sortable:true})}return this.__checkColumn},__updateColumns:function(){var e=this.headerView.getDataList();if(this.__indexColumn){e.remove(this.__indexColumn)}if(this.__checkColumn){e.remove(this.__checkColumn)}this.__setColumns(e)},__setColumns:function(t,s){var a=Se.parseColumns(t);var n=false;if(s===true){this.__hiddenColumns={};this.__lockedColumns={};a.each(function(e){if(e.get("hidden")==true){this.__hiddenColumns[e.id()]=true}if(e.get("locked")===true){n=true;this.__lockedColumns[e.id()]=true}},this)}else if(i.isNonEmptyObject(this.__lockedColumns)){n=true}if(this.get("index_visible")===true){a.add(this._getIndexColumn(),0)}if(this.get("check_visible")===true){a.add(this._getCheckColumn(),0)}if(n){this.__lockedColumns[this._getIndexColumn().id()]=true;this.__lockedColumns[this._getCheckColumn().id()]=true}this.headerView.setProvider(new e.Provider(a));if(s===true){this.headerView.clearColumnSort();a.each(function(e){var t=e.get("sort_order");if(t==="asc"||t==="desc"){this.headerView.__sortColumn(e,t,this.isColumnMultipleSortable(e))}},this)}var r=new e.List;var o=new e.List;this.headerView.hEachLeafData(function(e){if(this.isColumnLocked(e)){r.add(e)}else{o.add(e)}},this);r.addAll(o);this.bodyView.setColumns(r)},_createTBodyView:function(){var e=this;var t={};var i=["_hasColumnClientSorted","_getClientSortColumns","getColumnSortOrder","__isVisible_","__getCellValue","isColumnLocked","isCheckVisible","isCheckColumn","onCheckChange","_onBodyScrollChange"];o(i,function(i){t[i]=function(){return e[i].apply(e,arguments)}});return new fe(t)},__getCellValue:function(e,t){if(t===this.__checkColumn){return this.bodyView.isChecked(e)}else if(t===this.__indexColumn){return this.bodyView._getDataIndex(e)}return this.getCellValue(e,t)},getCellValue:function(e,t){var i=t.get("field");if(i){var s=e.get(i);if(s==null){return""}return s}return""},_onBodyScrollChange:function(t){var i=e.event.getTarget(t);var s=i.scrollLeft;this.headerView._scroll(s)},onViewSizeChange:function(t){e.Grid.superClass.onViewSizeChange.apply(this,arguments);if(this.__isScrollable()){var i=this.getView().parentNode;var s=i.clientHeight-this.headerView.getView().offsetHeight;var n=parseFloat(a.css(i,"padding-top"))+parseFloat(a.css(i,"padding-bottom"));if(a.css(i,"box-sizing")==="border-box"){n+=parseFloat(a.css(i,"border-top"))+parseFloat(a.css(i,"border-bottom"))}s-=n;this.bodyView.__setViewCSS("height",s+"px")}else{this.bodyView.__setViewCSS("height","")}this.headerView.updateHeadersSize(t);this.bodyView.updateTBodiesSize(t)},__isScrollable:function(){return this.get("scrollable")!==false},setProvider:function(t){e.Grid.superClass.setProvider.apply(this,arguments);this.bodyView.setProvider(t)}});e.Pagination=function(){this.__pageSize=0;this._infoSpan=a.create("span","z-info");this._pageSizeSelect=a.create("select","z-page-size");this._refreshAction=d.createAction(this.__handleRefresh,this,"z-refresh z-widget-sprite z-ws-refresh");e.Pagination.superClass.constructor.apply(this,arguments);this.addToView(this._pageSizeSelect);this.addToView(this._refreshAction);this.addToView(this._infoSpan);this.__addViewClass("z-pagination");this.__initPager();this.__updatePagerData_();this.__setViewCSS_Obj({height:"",width:"",overflow:"hidden","box-sizing":""})};e.extend(e.Pagination,e.ListView,{___zdefaults_:{page_sizes:[10,20,50,100],page_change_on_count_initialize:true,start_from_1:false,refresh_visible:true,page_size:20,page_size_selectable:true,page_info_visible:true,user_select:false,max_visible_page_number:6},isDisabled:function(e){var t=e.get("page");if(t!=null){if(t<0){return true}if(t>this.__getPageNumber_()-1){return true}return false}return true},__initPager:function(){this.__updatePageSizes();s.onchange(this._pageSizeSelect,this.__handlePageSizeChange,this)},__handlePageSizeChange:function(){var e=t.getValue(this._pageSizeSelect);this.set("page_size",e)},__handleRefresh:function(){this.__onPageChange_(true)},__getPageSizeList:function(){var t=this.get("page_sizes");var i;if(t){i=new e.List(t)}else{i=new e.List}if(i.length==0){i.add(20)}return i},__updatePageSizes:function(){t.empty(this._pageSizeSelect);var e=this.__getPageSizeList();var i=this.get("page_size")+"";var s=false;e.each(function(e){var t=e+"";if(t===i){s=true}var a=d.createSelectOption(t);this._pageSizeSelect.appendChild(a)},this);if(s){t.setValue(this._pageSizeSelect,i)}else{t.setValue(this._pageSizeSelect,e.get(0)+"")}},afterSetProperty:function(t,i,s){if(t==="page_index"){this.__updatePageIndex()}else if(t==="page_size"){this.__updatePageSize()}else if(t==="count"){this.__updateCount(s)}else if(t==="page_sizes"){this.__updatePageSizes()}else if(t==="page_size_selectable"){if(i===true){a.show(this._pageSizeSelect)}else{a.hide(this._pageSizeSelect)}}else if(t==="page_info_visible"){if(i===true){a.show(this._infoSpan)}else{a.hide(this._infoSpan)}}else if(t==="refresh_visible"){if(i===true){a.show(this._refreshAction)}else{a.hide(this._refreshAction)}}e.Pagination.superClass.afterSetProperty.apply(this,arguments)},__getPageNumber_:function(){return this._pageNumber||0},__getCount_:function(){return this.get("count")||0},__getPageIndex_:function(){return this.get("page_index")||0},_onViewChange:function(){e.Pagination.superClass._onViewChange.apply(this,arguments);this.__updatePagerData_()},_onSelectChange:function(){e.Pagination.superClass._onSelectChange.apply(this,arguments);var t=this.getLastSelect();if(t){this.set("page_index",t.get("page"))}if(this.__isUpdatePagerData!==true){this.__updatePagerData_()}},__updatePagerData_:function(){this.callBatch("__updatePagerDataFlag",this.__updatePagerData,this)},__updateCount:function(e){var t=e==null;if(t){this.__updateCount=this.__updateCount_}this._noFirePageChangeEventOnCountInitialize=t&&this.get("page_change_on_count_initialize")===false;if(this.__updatePageNumber()){if(this._noFirePageChangeEventOnCountInitialize){this._noFirePageChangeEventOnCountInitialize=false;return}this._noFirePageChangeEventOnCountInitialize=false;this.__onPageChange()}},__updateCount_:function(){if(this.__updatePageNumber()){this.__onPageChange()}},__updatePageSize:function(){this.__updatePageNumber();this.__onPageChange()},__updatePageIndex:function(){if(this._noFirePageChangeEventOnCountInitialize===true){return}this.__onPageChange()},__updatePageNumber:function(){var e=this.__getCount_();var t=this.get("page_size");var i=0;if(e>0&&t>0){i=Math.ceil(e/t)}if(i!==this._pageNumber){var s=this.get("page_index");this._pageNumber=i;var a=Math.min(s||0,i-1);if(a!==s){this.set("page_index",a);return true}return false}},__updatePagerData:function(){var t=2;var i=this.__getPageIndex_();var s=this.__getPageNumber_();var a=this.get("max_visible_page_number");var n=new e.Provider;n.add(this.__createPagerData("&laquo;",i-1));var r=0;if(s<=a){t+=s;for(r=0;r<s;r++){n.add(this.__createPagerData(r+1,r))}}else{a=Math.max(a,4);t+=a+1;if(i<a-2){for(r=0;r<=a-2;r++){n.add(this.__createPagerData(r+1,r))}n.add(this.__createPagerData("..."));n.add(this.__createPagerData(s,s-1))}else if(i>s-(a-1)){n.add(this.__createPagerData(1,0));n.add(this.__createPagerData("..."));for(r=s-(a-1);r<s;r++){n.add(this.__createPagerData(r+1,r))}}else{n.add(this.__createPagerData(1,0));n.add(this.__createPagerData("..."));var o=a-3;var l=parseInt(o/2);var h=o-l-1;for(r=i-h;r<=i+l;r++){n.add(this.__createPagerData(r+1,r))}n.add(this.__createPagerData("..."));n.add(this.__createPagerData(s,s-1))}}n.add(this.__createPagerData("&raquo;",i+1));this.__isUpdatePagerData=true;this.setProvider(n);var _=n.find("page",i);if(_){this.setSelect(_)}this.__isUpdatePagerData=false;this.validate()},__createPagerData:function(t,i){return new e.Data({page:i,name:t})},validate:function(){e.Pagination.superClass.validate.apply(this,arguments);this._infoSpan.innerHTML=this.getPagerInfo(this.__getCount_(),this.get("page_size"),this.__getPageIndex_(),this.__getPageNumber_())},getPagerInfo:function(e,t,i,s){var a=0;var n=0;if(e>0){a=i*t+1;n=Math.min(e,(i+1)*t)}return a+"-"+n+" | "+e},__onPageChange:function(){this.callBatch("__onPageChangeFlag",this.__onPageChange_,this)},__onPageChange_:function(e){var t=this.__getPageIndex_();var i=this.__getCount_();if(i>0&&this.get("start_from_1")===true){t++}this.onPageChange(this.get("page_size"),t,i,this.__getPageNumber_(),e)},onPageChange:function(e,t,i,s,a){}});e.LayerView=function(){e.LayerView.superClass.constructor.apply(this,arguments);this.__removeViewClass("z-list");this.__addViewClasses("z-layer")};e.extend(e.LayerView,Y,{___zdefaults_:{expand_visible:false},getRendererContainer:function(e){if(e){var t=e.get("parent");if(t){return this.__getSubLayerContainer(t)}}return this.viewUL},__getSubLayerContainer:function(e){var t=this.getRenderer(e);if(t){return t.getSubLayerContainer()}return null},getRendererClass:function(){return e.LayerRenderer},isExpanded:function(){return true},validateDatas:function(){e.LayerView.superClass.validateDatas.apply(this,arguments);this.hEachData(function(e){var t=this.getRenderer(e);t.__setLayerHeight()},this)},getDataAt:function(e){if(e){var i=this.__getEventTarget(e);if(t.isElement(i)){if(t.hasClass(i,"z-children")){return null}var s=i.getAttribute("__z_did_");while(!s){i=i.parentNode;if(i&&i.getAttribute){if(t.hasClass(i,"z-children")){break}s=i.getAttribute("__z_did_")}else{break}}if(s){return this.getDataByID(s)}}}return null}});e.LayerRenderer=function(){e.LayerRenderer.superClass.constructor.apply(this,arguments)};e.extend(e.LayerRenderer,Z,{getSubLayerContainer:function(){if(!this._subLayerUL){this._childrenDiv=a.create("div","z-children");this._subLayerUL=a.create("ul","z-group");this._childrenDiv.appendChild(this._subLayerUL);this.addToRenderer(this._childrenDiv)}return this._subLayerUL},validateRenderer:function(){this.__setRenderCSS("height","");e.LayerRenderer.superClass.validateRenderer.apply(this,arguments)},__setLayerHeight:function(){var e=this.getRenderElement();if(e){var i=e.parentNode;if(i){this.__setChildHeight(i,e);if(this._subLayerUL&&a.children(this._subLayerUL).length>0){var s=this.__getContentHeight(e);var n=parseFloat(this._itemDiv.offsetHeight);t.setCSS(this._childrenDiv,"height",s-n+"px");this.__setChildHeight(this._childrenDiv,this._subLayerUL)}}}},__getContentHeight:function(e){var i=e.clientHeight;var s=parseFloat(t.getCSS(e,"padding-top"));var a=parseFloat(t.getCSS(e,"padding-bottom"));var n=parseFloat(t.getCSS(e,"border-top"));var r=parseFloat(t.getCSS(e,"border-bottom"));return i-s-a-n-r},__setChildHeight:function(e,i){var s=this.__getContentHeight(e);var a=parseFloat(t.getCSS(i,"padding-top"));var n=parseFloat(t.getCSS(i,"padding-bottom"));var r=parseFloat(t.getCSS(i,"margin-top"));var o=parseFloat(t.getCSS(i,"margin-bottom"));var l=parseFloat(t.getCSS(i,"border-top"));var h=parseFloat(t.getCSS(i,"border-bottom"));var _=s-a-n-r-o-l-h;if(i.offsetHeight<_){t.setCSS(i,"height",_+"px")}}});e.widgets={window:G.window,loading:G.loading,notification:G.notification,alert:G.alert,confirm:G.confirm,tooltip:G.tooltip,popupMenu:$.popupMenu,"interface":{ContentInterface:y}}})(z);